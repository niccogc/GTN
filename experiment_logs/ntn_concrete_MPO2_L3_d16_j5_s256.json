{
  "experiment_name": "ntn_concrete",
  "run_name": "MPO2_L3_d16_j5_s256",
  "config": {
    "output_site": 1,
    "init_strength": 0.01,
    "batch_size": 1024,
    "n_epochs": 15,
    "jitter_decay": 0.25,
    "adaptive_jitter": false,
    "patience": 4,
    "min_delta": 1e-06,
    "train_selection": true,
    "rank": 5,
    "seeds": [
      42,
      7,
      123,
      256,
      999
    ],
    "model": "MPO2",
    "L": 3,
    "bond_dim": 16,
    "jitter_start": 5.0
  },
  "hparams": {
    "seed": 256,
    "model": "MPO2",
    "dataset": "concrete",
    "n_parameters": 2304,
    "output_site": 1,
    "init_strength": 0.01,
    "batch_size": 1024,
    "n_epochs": 15,
    "jitter_decay": 0.25,
    "adaptive_jitter": false,
    "patience": 4,
    "min_delta": 1e-06,
    "train_selection": true,
    "rank": 5,
    "seeds": [
      42,
      7,
      123,
      256,
      999
    ],
    "L": 3,
    "bond_dim": 16,
    "jitter_start": 5.0
  },
  "metrics_log": [
    {
      "step": -1,
      "train_loss": 2879.192510373142,
      "train_quality": -9.211088086568878,
      "val_loss": 2347.005782871925,
      "val_quality": -7.138101740406983
    },
    {
      "step": 0,
      "train_loss": 996.8465747252174,
      "train_quality": -2.535327403999978,
      "val_loss": 947.2619700619625,
      "val_quality": -2.284574048961036,
      "reg_loss": 1135.3533022697343,
      "jitter": 5.0,
      "weight_norm_sq": 27.70134550890339
    }
  ],
  "summary": {
    "run_id": "MPO2-L3-d16-jit5-seed256",
    "seed": 256,
    "model": "MPO2",
    "grid_params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 16,
      "jitter_start": 5.0
    },
    "train_loss": null,
    "train_quality": null,
    "val_loss": null,
    "val_quality": null,
    "test_loss": null,
    "test_quality": null,
    "success": false,
    "singular": false,
    "error": "CUDA out of memory. Tried to allocate 32.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 28.25 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 14.30 GiB is allocated by PyTorch, and 1.03 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)",
    "traceback": "Traceback (most recent call last):\n  File \"/zhome/6b/e/212868/GTN/model/base/NTN.py\", line 485, in cholesky_solve_helper\n    x = lib.cholesky_solve(b, L)\n        ^^^^^^^^^^^^^^^^^^^^^^^^\ntorch.OutOfMemoryError: CUDA out of memory. Tried to allocate 32.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 28.25 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 14.30 GiB is allocated by PyTorch, and 1.03 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/zhome/6b/e/212868/GTN/experiments/run_grid_search.py\", line 272, in run_single_experiment\n    scores_train, scores_val = ntn.fit(\n                               ^^^^^^^^\n  File \"/zhome/6b/e/212868/GTN/model/base/NTN.py\", line 876, in fit\n    self.update_tn_node(\n  File \"/zhome/6b/e/212868/GTN/model/base/NTN.py\", line 755, in update_tn_node\n    delta_tensor = self._get_node_update(\n                   ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/zhome/6b/e/212868/GTN/model/base/NTN.py\", line 637, in _get_node_update\n    tensor_node_data = self.solve_linear_system(matrix_data, -gradient_vector)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/zhome/6b/e/212868/GTN/model/base/NTN.py\", line 539, in solve_linear_system\n    result_data = self.cholesky_solve_helper(matrix_data, vector_data, backend_name, lib)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/zhome/6b/e/212868/GTN/model/base/NTN.py\", line 489, in cholesky_solve_helper\n    lib.linalg.solve(matrix, b).squeeze(-1)\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^\ntorch.OutOfMemoryError: CUDA out of memory. Tried to allocate 32.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 28.25 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 14.30 GiB is allocated by PyTorch, and 1.03 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)\n"
  }
}