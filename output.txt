======================================================================
EXPERIMENT PLAN SUMMARY
======================================================================
Total experiments: 4
Grid combinations: 4
Seeds per combination: 1

Parameter Grid:
  model: ['MPO2', 'MPO2TypeI', 'MMPO2', 'MMPO2TypeI'] (n=4)
  L: [4] (n=1)
  bond_dim: [12] (n=1)
  jitter_start: [1.0] (n=1)

Fixed Parameters:
  batch_size: 512
  n_epochs: 20
  jitter_decay: 0.5
  adaptive_jitter: False
  patience: 10
  min_delta: 1e-05
  train_selection: False
  init_strength: 0.01

Example runs (first 5):
  1. MPO2-L4-d12-jit1-seed42
  2. MPO2TypeI-L4-d12-jit1-seed42
  3. MMPO2-L4-d12-jit1-seed42
  4. MMPO2TypeI-L4-d12-jit1-seed42

Loading dataset: abalone...
  Dataset: abalone
  Train: 2923 samples
  Val: 627 samples
  Test: 627 samples
  Features: 11 (+1 bias = 11)
  Task: regression
  Device: cuda


[3/4] Running: MMPO2-L4-d12-jit1-seed42
[PROFILE] env_0_MPS: 5.7ms | mem: 8.8->9.3MB | peak: 31.0MB
[PROFILE] forward_0_MPS: 0.5ms | mem: 9.3->9.3MB | peak: 9.3MB
[PROFILE] loss_derivs_0_MPS: 38.0ms | mem: 9.3->9.3MB | peak: 9.3MB
[PROFILE] grad_contract_0_MPS: 0.7ms | mem: 9.3->9.8MB | peak: 9.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9.8->9.8MB | peak: 9.8MB
[PROFILE] hess_contract_0_MPS: 0.6ms | mem: 9.8->10.0MB | peak: 11.0MB
[PROFILE] env_0_MPS: 0.9ms | mem: 9.4->10.0MB | peak: 31.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 10.0->10.0MB | peak: 10.0MB
[PROFILE] loss_derivs_0_MPS: 0.8ms | mem: 10.0->10.0MB | peak: 10.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 10.0->10.5MB | peak: 10.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 10.5->10.5MB | peak: 10.5MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 10.5->10.6MB | peak: 11.7MB
[PROFILE] env_0_MPS: 0.8ms | mem: 10.1->10.6MB | peak: 32.4MB
[PROFILE] forward_0_MPS: 0.2ms | mem: 10.6->10.6MB | peak: 10.6MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 10.6->10.6MB | peak: 10.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 10.6->11.1MB | peak: 11.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11.1->11.1MB | peak: 11.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 11.1->11.3MB | peak: 12.3MB
[PROFILE] env_0_MPS: 1.2ms | mem: 10.6->11.1MB | peak: 32.9MB
[PROFILE] forward_0_MPS: 1.9ms | mem: 11.1->11.1MB | peak: 11.1MB
[PROFILE] loss_derivs_0_MPS: 2.9ms | mem: 11.1->11.1MB | peak: 11.2MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 11.1->11.7MB | peak: 11.7MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 11.7->11.7MB | peak: 11.7MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 11.7->11.8MB | peak: 12.8MB
[PROFILE] env_0_MPS: 0.2ms | mem: 11.1->11.7MB | peak: 33.4MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 11.7->11.7MB | peak: 11.7MB
[PROFILE] loss_derivs_0_MPS: 0.4ms | mem: 11.7->11.7MB | peak: 11.7MB
[PROFILE] grad_contract_0_MPS: 0.4ms | mem: 11.7->12.2MB | peak: 12.2MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 12.2->12.2MB | peak: 12.2MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 12.2->12.3MB | peak: 13.3MB
[PROFILE] env_0_MPS: 0.1ms | mem: 11.7->12.0MB | peak: 27.9MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 12.0->12.0MB | peak: 12.0MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 12.0->12.0MB | peak: 12.0MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 12.0->12.4MB | peak: 12.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12.4->12.4MB | peak: 12.4MB
[PROFILE] hess_contract_0_MPS: 1.8ms | mem: 12.4->12.5MB | peak: 13.3MB
[PROFILE] compute_H_b_0_MPS: 104.3ms | mem: 8.8->11.9MB | peak: 13.3MB
[PROFILE] fuse_0_MPS: 0.4ms | mem: 11.9->11.9MB | peak: 11.9MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 11.9->11.9MB | peak: 11.9MB
[PROFILE] solve_0_MPS: 40.0ms | mem: 11.9->12.0MB | peak: 12.2MB
[PROFILE] env_1_MPS: 2.2ms | mem: 11.9->19.1MB | peak: 30.9MB
[PROFILE] forward_1_MPS: 0.5ms | mem: 19.1->19.1MB | peak: 19.1MB
[PROFILE] loss_derivs_1_MPS: 0.9ms | mem: 19.1->19.1MB | peak: 19.1MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 19.1->25.3MB | peak: 25.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 25.3->25.3MB | peak: 25.3MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 25.3->51.5MB | peak: 71.5MB
[PROFILE] env_1_MPS: 1.0ms | mem: 51.5->58.7MB | peak: 71.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 58.7->58.7MB | peak: 58.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 58.7->58.7MB | peak: 58.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 58.7->64.9MB | peak: 64.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 64.9->64.9MB | peak: 64.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 64.9->91.1MB | peak: 111.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 91.1->98.2MB | peak: 110.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 98.2->98.3MB | peak: 98.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 98.3->98.3MB | peak: 98.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 98.3->104.5MB | peak: 104.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 104.5->104.5MB | peak: 104.5MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 104.5->130.6MB | peak: 150.6MB
[PROFILE] env_1_MPS: 1.0ms | mem: 110.6->117.8MB | peak: 129.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 117.8->117.8MB | peak: 117.8MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 117.8->117.8MB | peak: 117.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 117.8->124.0MB | peak: 124.0MB
[PROFILE] hess_tn_build_1_MPS: 0.4ms | mem: 124.0->124.0MB | peak: 124.0MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 124.0->150.2MB | peak: 170.2MB
[PROFILE] env_1_MPS: 1.1ms | mem: 130.2->137.4MB | peak: 149.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 137.4->137.4MB | peak: 137.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 137.4->137.4MB | peak: 137.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 137.4->143.6MB | peak: 143.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 143.6->143.6MB | peak: 143.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 143.6->169.8MB | peak: 189.8MB
[PROFILE] env_1_MPS: 1.5ms | mem: 149.8->154.9MB | peak: 163.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 154.9->154.9MB | peak: 154.9MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 154.9->154.9MB | peak: 154.9MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 154.9->159.3MB | peak: 159.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 159.3->159.3MB | peak: 159.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 159.3->183.7MB | peak: 203.7MB
[PROFILE] compute_H_b_1_MPS: 38.5ms | mem: 11.9->143.7MB | peak: 203.7MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 143.7->143.7MB | peak: 143.7MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 143.7->143.7MB | peak: 143.7MB
[PROFILE] solve_1_MPS: 1.7ms | mem: 143.7->163.7MB | peak: 183.7MB
[PROFILE] env_2_MPS: 1.8ms | mem: 163.7->176.1MB | peak: 182.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 176.1->176.1MB | peak: 176.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 176.1->176.1MB | peak: 176.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 176.1->182.3MB | peak: 182.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 182.3->182.3MB | peak: 182.3MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 182.3->208.5MB | peak: 228.5MB
[PROFILE] env_2_MPS: 2.1ms | mem: 208.5->221.0MB | peak: 227.7MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 221.0->221.0MB | peak: 221.0MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 221.0->221.0MB | peak: 221.0MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 221.0->227.2MB | peak: 227.2MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 227.2->227.2MB | peak: 227.2MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 227.2->253.4MB | peak: 273.4MB
[PROFILE] env_2_MPS: 0.2ms | mem: 253.4->265.8MB | peak: 273.1MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 265.8->265.8MB | peak: 265.8MB
[PROFILE] loss_derivs_2_MPS: 0.4ms | mem: 265.8->265.9MB | peak: 265.9MB
[PROFILE] grad_contract_2_MPS: 2.0ms | mem: 265.9->272.1MB | peak: 272.1MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 272.1->272.1MB | peak: 272.1MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 272.1->298.2MB | peak: 318.2MB
[PROFILE] env_2_MPS: 0.2ms | mem: 278.2->290.7MB | peak: 297.9MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 290.7->290.7MB | peak: 290.7MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 290.7->290.7MB | peak: 290.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 290.7->296.9MB | peak: 296.9MB
[PROFILE] hess_tn_build_2_MPS: 0.6ms | mem: 296.9->296.9MB | peak: 296.9MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 296.9->323.1MB | peak: 343.1MB
[PROFILE] env_2_MPS: 0.8ms | mem: 303.1->315.5MB | peak: 322.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 315.5->315.5MB | peak: 315.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 315.5->315.5MB | peak: 315.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 315.5->321.7MB | peak: 321.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 321.7->321.7MB | peak: 321.7MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 321.7->347.9MB | peak: 367.9MB
[PROFILE] env_2_MPS: 1.6ms | mem: 327.9->336.8MB | peak: 341.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 336.8->336.8MB | peak: 336.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 336.8->336.8MB | peak: 336.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 336.8->341.2MB | peak: 341.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 341.2->341.2MB | peak: 341.2MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 341.2->365.6MB | peak: 385.6MB
[PROFILE] compute_H_b_2_MPS: 62.3ms | mem: 163.7->325.5MB | peak: 385.6MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 325.5->325.5MB | peak: 325.5MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 325.5->325.5MB | peak: 325.5MB
[PROFILE] solve_2_MPS: 1.7ms | mem: 325.6->345.6MB | peak: 365.6MB
[PROFILE] env_3_MPS: 1.6ms | mem: 345.6->348.6MB | peak: 365.6MB
[PROFILE] forward_3_MPS: 0.4ms | mem: 348.6->348.6MB | peak: 349.1MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 348.6->348.6MB | peak: 348.6MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 348.6->349.1MB | peak: 349.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 349.1->349.1MB | peak: 349.1MB
[PROFILE] hess_contract_3_MPS: 0.7ms | mem: 349.1->350.3MB | peak: 350.8MB
[PROFILE] env_3_MPS: 1.2ms | mem: 349.8->352.8MB | peak: 369.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 352.8->352.8MB | peak: 353.3MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 352.8->352.8MB | peak: 352.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 352.8->353.3MB | peak: 353.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 353.3->353.3MB | peak: 353.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 353.3->354.5MB | peak: 355.0MB
[PROFILE] env_3_MPS: 1.0ms | mem: 354.0->357.0MB | peak: 374.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 357.0->357.0MB | peak: 357.5MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 357.0->357.0MB | peak: 357.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 357.0->357.5MB | peak: 357.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 357.5->357.5MB | peak: 357.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 357.5->358.7MB | peak: 359.2MB
[PROFILE] env_3_MPS: 1.1ms | mem: 358.0->361.1MB | peak: 378.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 361.1->361.1MB | peak: 361.6MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 361.1->361.1MB | peak: 361.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 361.1->361.6MB | peak: 361.6MB
[PROFILE] hess_tn_build_3_MPS: 0.4ms | mem: 361.6->361.6MB | peak: 361.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 361.6->362.8MB | peak: 363.3MB
[PROFILE] env_3_MPS: 1.0ms | mem: 362.1->365.3MB | peak: 382.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 365.3->365.3MB | peak: 365.8MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 365.3->365.3MB | peak: 365.3MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 365.3->365.8MB | peak: 365.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 365.8->365.8MB | peak: 365.8MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 365.8->367.0MB | peak: 367.5MB
[PROFILE] env_3_MPS: 1.6ms | mem: 366.4->369.1MB | peak: 381.2MB
[PROFILE] forward_3_MPS: 0.4ms | mem: 369.1->369.1MB | peak: 369.5MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 369.1->369.1MB | peak: 369.2MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 369.1->369.5MB | peak: 369.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 369.5->369.5MB | peak: 369.5MB
[PROFILE] hess_contract_3_MPS: 1.0ms | mem: 369.5->370.4MB | peak: 370.7MB
[PROFILE] compute_H_b_3_MPS: 37.2ms | mem: 345.6->369.7MB | peak: 370.7MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 369.7->369.7MB | peak: 369.7MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 369.7->369.7MB | peak: 369.7MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 369.7->369.9MB | peak: 370.0MB
[PROFILE] env_2_MPS: 1.7ms | mem: 369.9->383.3MB | peak: 389.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 383.3->383.3MB | peak: 383.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 383.3->383.3MB | peak: 383.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 383.3->389.5MB | peak: 389.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 389.5->389.5MB | peak: 389.5MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 389.5->415.7MB | peak: 435.7MB
[PROFILE] env_2_MPS: 1.0ms | mem: 415.7->429.2MB | peak: 435.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 429.2->429.2MB | peak: 429.2MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 429.2->429.2MB | peak: 429.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 429.2->435.4MB | peak: 435.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 435.4->435.4MB | peak: 435.4MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 435.4->461.6MB | peak: 481.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 461.6->475.0MB | peak: 481.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 475.0->475.0MB | peak: 475.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 475.0->475.0MB | peak: 475.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 475.0->481.2MB | peak: 481.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 481.2->481.2MB | peak: 481.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 481.2->507.4MB | peak: 527.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 487.4->500.8MB | peak: 507.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 500.8->500.8MB | peak: 500.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 500.8->500.8MB | peak: 500.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 500.8->507.0MB | peak: 507.1MB
[PROFILE] hess_tn_build_2_MPS: 0.4ms | mem: 507.0->507.0MB | peak: 507.0MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 507.0->533.2MB | peak: 553.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 513.2->526.7MB | peak: 533.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 526.7->526.7MB | peak: 526.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 526.7->526.7MB | peak: 526.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 526.7->532.9MB | peak: 532.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 532.9->532.9MB | peak: 532.9MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 532.9->559.1MB | peak: 579.1MB
[PROFILE] env_2_MPS: 1.6ms | mem: 539.1->548.6MB | peak: 553.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 548.6->548.6MB | peak: 548.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 548.6->548.6MB | peak: 548.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 548.6->553.0MB | peak: 553.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 553.0->553.0MB | peak: 553.0MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 553.0->577.4MB | peak: 597.4MB
[PROFILE] compute_H_b_2_MPS: 37.1ms | mem: 369.9->537.4MB | peak: 597.4MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 537.4->537.4MB | peak: 537.4MB
[PROFILE] to_dense_2_MPS: 0.0ms | mem: 537.4->537.4MB | peak: 537.4MB
[PROFILE] solve_2_MPS: 1.9ms | mem: 537.4->557.4MB | peak: 577.4MB
[PROFILE] env_1_MPS: 0.2ms | mem: 557.4->570.7MB | peak: 576.9MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 570.7->570.8MB | peak: 570.8MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 570.8->570.8MB | peak: 570.8MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 570.8->577.0MB | peak: 577.0MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 577.0->577.0MB | peak: 577.0MB
[PROFILE] hess_contract_1_MPS: 0.3ms | mem: 577.0->603.1MB | peak: 623.1MB
[PROFILE] env_1_MPS: 0.2ms | mem: 603.1->617.0MB | peak: 623.2MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 617.0->617.0MB | peak: 617.0MB
[PROFILE] loss_derivs_1_MPS: 0.4ms | mem: 617.0->617.0MB | peak: 617.0MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 617.0->623.2MB | peak: 623.2MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 623.2->623.2MB | peak: 623.2MB
[PROFILE] hess_contract_1_MPS: 0.3ms | mem: 623.2->649.4MB | peak: 669.4MB
[PROFILE] env_1_MPS: 0.2ms | mem: 649.4->663.2MB | peak: 669.4MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 663.2->663.2MB | peak: 663.2MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 663.2->663.2MB | peak: 663.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 663.2->669.4MB | peak: 669.5MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 669.4->669.4MB | peak: 669.4MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 669.4->695.6MB | peak: 715.6MB
[PROFILE] env_1_MPS: 1.0ms | mem: 675.6->689.0MB | peak: 695.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 689.0->689.0MB | peak: 689.0MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 689.0->689.0MB | peak: 689.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 689.0->695.2MB | peak: 695.2MB
[PROFILE] hess_tn_build_1_MPS: 0.5ms | mem: 695.2->695.2MB | peak: 695.2MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 695.2->721.4MB | peak: 741.4MB
[PROFILE] env_1_MPS: 1.2ms | mem: 701.3->715.2MB | peak: 721.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 715.2->715.2MB | peak: 715.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 715.2->715.2MB | peak: 715.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 715.2->721.4MB | peak: 721.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 721.4->721.4MB | peak: 721.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 721.4->747.6MB | peak: 767.6MB
[PROFILE] env_1_MPS: 1.5ms | mem: 727.6->737.4MB | peak: 741.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 737.4->737.4MB | peak: 737.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 737.4->737.4MB | peak: 737.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 737.4->741.8MB | peak: 741.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 741.8->741.8MB | peak: 741.8MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 741.8->766.2MB | peak: 786.2MB
[PROFILE] compute_H_b_1_MPS: 58.8ms | mem: 557.4->726.2MB | peak: 786.2MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 726.2->726.2MB | peak: 726.2MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 726.2->726.2MB | peak: 726.2MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 726.2->746.2MB | peak: 766.2MB
[PROFILE] env_0_MPS: 1.5ms | mem: 746.2->753.8MB | peak: 770.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 753.8->753.8MB | peak: 753.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 753.8->753.8MB | peak: 753.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 753.8->754.4MB | peak: 754.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 754.4->754.4MB | peak: 754.4MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 754.4->755.0MB | peak: 755.5MB
[PROFILE] env_0_MPS: 0.9ms | mem: 755.0->762.6MB | peak: 779.2MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 762.6->762.6MB | peak: 762.7MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 762.6->762.7MB | peak: 762.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 762.7->763.2MB | peak: 763.2MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 763.2->763.2MB | peak: 763.2MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 763.2->763.8MB | peak: 764.3MB
[PROFILE] env_0_MPS: 1.3ms | mem: 763.8->771.5MB | peak: 788.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 771.5->771.5MB | peak: 771.5MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 771.5->771.5MB | peak: 771.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 771.5->772.0MB | peak: 772.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 772.0->772.0MB | peak: 772.0MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 772.0->772.6MB | peak: 773.2MB
[PROFILE] env_0_MPS: 1.1ms | mem: 772.5->780.1MB | peak: 796.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 780.1->780.1MB | peak: 780.1MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 780.1->780.2MB | peak: 780.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 780.2->780.7MB | peak: 780.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 780.7->780.7MB | peak: 780.7MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 780.7->781.3MB | peak: 781.8MB
[PROFILE] env_0_MPS: 1.1ms | mem: 781.2->788.8MB | peak: 805.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 788.8->788.8MB | peak: 788.8MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 788.8->788.8MB | peak: 788.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 788.8->789.3MB | peak: 789.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 789.3->789.3MB | peak: 789.3MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 789.3->790.0MB | peak: 790.5MB
[PROFILE] env_0_MPS: 1.5ms | mem: 789.9->795.8MB | peak: 807.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 795.8->795.8MB | peak: 795.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 795.8->795.8MB | peak: 795.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 795.8->796.1MB | peak: 796.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 796.1->796.1MB | peak: 796.1MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 796.1->796.6MB | peak: 797.0MB
[PROFILE] compute_H_b_0_MPS: 34.9ms | mem: 746.2->796.4MB | peak: 797.0MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 796.4->796.4MB | peak: 796.4MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 796.4->796.4MB | peak: 796.4MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 796.4->796.5MB | peak: 796.6MB
[PROFILE] env_1_MPS: 1.5ms | mem: 796.5->809.8MB | peak: 816.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 809.8->809.8MB | peak: 809.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 809.8->809.9MB | peak: 809.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 809.9->816.1MB | peak: 816.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 816.1->816.1MB | peak: 816.1MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 816.1->842.2MB | peak: 862.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 842.2->856.1MB | peak: 862.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 856.1->856.1MB | peak: 856.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 856.1->856.1MB | peak: 856.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 856.1->862.3MB | peak: 862.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 862.3->862.3MB | peak: 862.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 862.3->888.5MB | peak: 908.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 888.5->902.3MB | peak: 908.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 902.3->902.3MB | peak: 902.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 902.3->902.3MB | peak: 902.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 902.3->908.5MB | peak: 908.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 908.5->908.5MB | peak: 908.5MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 908.5->934.7MB | peak: 954.7MB
[PROFILE] env_1_MPS: 2.2ms | mem: 914.7->928.0MB | peak: 934.2MB
[PROFILE] forward_1_MPS: 0.4ms | mem: 928.0->928.1MB | peak: 928.1MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 928.1->928.1MB | peak: 928.1MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 928.1->934.3MB | peak: 934.3MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 934.3->934.3MB | peak: 934.3MB
[PROFILE] hess_contract_1_MPS: 2.7ms | mem: 934.3->960.4MB | peak: 980.4MB
[PROFILE] env_1_MPS: 0.1ms | mem: 940.4->954.3MB | peak: 960.5MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 954.3->954.3MB | peak: 954.3MB
[PROFILE] loss_derivs_1_MPS: 2.8ms | mem: 954.3->954.3MB | peak: 954.3MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 954.3->960.5MB | peak: 960.5MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 960.5->960.5MB | peak: 960.5MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 960.5->986.7MB | peak: 1006.7MB
[PROFILE] env_1_MPS: 0.1ms | mem: 966.7->976.5MB | peak: 980.9MB
[PROFILE] forward_1_MPS: 0.4ms | mem: 976.5->976.5MB | peak: 976.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 976.5->976.5MB | peak: 976.5MB
[PROFILE] grad_contract_1_MPS: 0.6ms | mem: 976.5->980.9MB | peak: 980.9MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 980.9->980.9MB | peak: 980.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 980.9->1005.3MB | peak: 1025.3MB
[PROFILE] compute_H_b_1_MPS: 59.4ms | mem: 796.5->965.3MB | peak: 1025.3MB
[PROFILE] fuse_1_MPS: 0.0ms | mem: 965.3->965.3MB | peak: 965.3MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 965.3->965.3MB | peak: 965.3MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 965.3->985.3MB | peak: 1005.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 985.3->999.4MB | peak: 1005.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 999.4->999.4MB | peak: 999.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 999.4->999.4MB | peak: 999.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 999.4->1005.6MB | peak: 1005.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1005.6->1005.6MB | peak: 1005.6MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 1005.6->1031.8MB | peak: 1051.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1031.8->1045.2MB | peak: 1051.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1045.2->1045.2MB | peak: 1045.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1045.2->1045.2MB | peak: 1045.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1045.2->1051.4MB | peak: 1051.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1051.4->1051.4MB | peak: 1051.4MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 1051.4->1077.6MB | peak: 1097.6MB
[PROFILE] env_2_MPS: 1.0ms | mem: 1077.6->1091.1MB | peak: 1097.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1091.1->1091.1MB | peak: 1091.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 1091.1->1091.1MB | peak: 1091.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1091.1->1097.3MB | peak: 1097.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1097.3->1097.3MB | peak: 1097.3MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 1097.3->1123.5MB | peak: 1143.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1103.4->1116.9MB | peak: 1123.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1116.9->1116.9MB | peak: 1116.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 1116.9->1116.9MB | peak: 1116.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1116.9->1123.1MB | peak: 1123.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1123.1->1123.1MB | peak: 1123.1MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 1123.1->1149.3MB | peak: 1169.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1129.3->1142.7MB | peak: 1148.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1142.7->1142.7MB | peak: 1142.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1142.7->1142.7MB | peak: 1142.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1142.7->1148.9MB | peak: 1148.9MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 1148.9->1148.9MB | peak: 1148.9MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 1148.9->1175.1MB | peak: 1195.1MB
[PROFILE] env_2_MPS: 1.0ms | mem: 1155.1->1164.7MB | peak: 1169.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1164.7->1164.7MB | peak: 1164.7MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 1164.7->1164.7MB | peak: 1164.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1164.7->1169.1MB | peak: 1169.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1169.1->1169.1MB | peak: 1169.1MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 1169.1->1193.5MB | peak: 1213.5MB
[PROFILE] compute_H_b_2_MPS: 36.6ms | mem: 985.3->1153.4MB | peak: 1213.5MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 1153.4->1153.4MB | peak: 1153.4MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 1153.4->1153.4MB | peak: 1153.4MB
[PROFILE] solve_2_MPS: 7.1ms | mem: 1153.5->1173.5MB | peak: 1193.5MB
[PROFILE] env_3_MPS: 1.4ms | mem: 1173.5->1176.5MB | peak: 1193.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 1176.5->1177.0MB | peak: 1177.0MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 1177.0->1177.0MB | peak: 1177.0MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 1177.0->1177.5MB | peak: 1177.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 1177.5->1177.5MB | peak: 1177.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 1177.5->1178.7MB | peak: 1179.2MB
[PROFILE] env_3_MPS: 1.0ms | mem: 1178.2->1181.2MB | peak: 1198.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 1181.2->1181.7MB | peak: 1181.7MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 1181.7->1181.7MB | peak: 1181.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 1181.7->1182.3MB | peak: 1182.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 1182.3->1182.3MB | peak: 1182.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 1182.3->1183.4MB | peak: 1183.9MB
[PROFILE] env_3_MPS: 1.2ms | mem: 1182.9->1185.9MB | peak: 1202.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 1185.9->1186.4MB | peak: 1186.4MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 1186.4->1186.5MB | peak: 1186.5MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 1186.5->1187.0MB | peak: 1187.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 1187.0->1187.0MB | peak: 1187.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 1187.0->1188.1MB | peak: 1188.6MB
[PROFILE] env_3_MPS: 1.2ms | mem: 1187.5->1190.5MB | peak: 1207.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 1190.5->1191.0MB | peak: 1191.0MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 1191.0->1191.0MB | peak: 1191.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 1191.0->1191.6MB | peak: 1191.6MB
[PROFILE] hess_tn_build_3_MPS: 0.5ms | mem: 1191.6->1191.6MB | peak: 1191.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 1191.6->1192.7MB | peak: 1193.2MB
[PROFILE] env_3_MPS: 1.2ms | mem: 1192.1->1195.1MB | peak: 1212.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 1195.1->1195.6MB | peak: 1195.6MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 1195.6->1195.6MB | peak: 1195.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 1195.6->1196.1MB | peak: 1196.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 1196.1->1196.1MB | peak: 1196.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 1196.1->1197.3MB | peak: 1197.8MB
[PROFILE] env_3_MPS: 1.0ms | mem: 1196.6->1199.2MB | peak: 1211.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 1199.2->1199.6MB | peak: 1199.6MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 1199.6->1199.6MB | peak: 1199.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 1199.6->1200.0MB | peak: 1200.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 1200.0->1200.0MB | peak: 1200.0MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 1200.0->1200.8MB | peak: 1201.2MB
[PROFILE] compute_H_b_3_MPS: 35.9ms | mem: 1173.5->1200.2MB | peak: 1201.2MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 1200.2->1200.2MB | peak: 1200.2MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 1200.2->1200.2MB | peak: 1200.2MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 1200.2->1200.4MB | peak: 1200.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1200.4->1213.8MB | peak: 1220.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1213.8->1213.8MB | peak: 1213.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1213.8->1213.8MB | peak: 1213.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1213.8->1220.0MB | peak: 1220.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1220.0->1220.0MB | peak: 1220.0MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 1220.0->1246.2MB | peak: 1266.2MB
[PROFILE] env_2_MPS: 2.2ms | mem: 1246.2->1259.6MB | peak: 1265.8MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 1259.6->1259.6MB | peak: 1259.6MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 1259.6->1259.6MB | peak: 1259.7MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 1259.6->1265.8MB | peak: 1265.9MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 1265.8->1265.8MB | peak: 1265.8MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 1265.8->1292.0MB | peak: 1312.0MB
[PROFILE] env_2_MPS: 0.1ms | mem: 1292.0->1305.5MB | peak: 1312.2MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 1305.5->1305.5MB | peak: 1305.5MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 1305.5->1305.5MB | peak: 1305.5MB
[PROFILE] grad_contract_2_MPS: 0.4ms | mem: 1305.5->1311.7MB | peak: 1311.7MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 1311.7->1311.7MB | peak: 1311.7MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 1311.7->1337.9MB | peak: 1357.9MB
[PROFILE] env_2_MPS: 0.1ms | mem: 1317.9->1331.3MB | peak: 1338.0MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 1331.3->1331.3MB | peak: 1331.3MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 1331.3->1331.3MB | peak: 1331.3MB
[PROFILE] grad_contract_2_MPS: 0.4ms | mem: 1331.3->1337.5MB | peak: 1337.5MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 1337.5->1337.5MB | peak: 1337.5MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 1337.5->1363.7MB | peak: 1383.7MB
[PROFILE] env_2_MPS: 1.1ms | mem: 1343.7->1357.1MB | peak: 1363.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1357.1->1357.1MB | peak: 1357.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1357.1->1357.1MB | peak: 1357.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1357.1->1363.3MB | peak: 1363.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1363.3->1363.3MB | peak: 1363.3MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 1363.3->1389.5MB | peak: 1409.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1369.5->1379.1MB | peak: 1383.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1379.1->1379.1MB | peak: 1379.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 1379.1->1379.1MB | peak: 1379.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1379.1->1383.5MB | peak: 1383.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1383.5->1383.5MB | peak: 1383.5MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 1383.5->1407.9MB | peak: 1427.9MB
[PROFILE] compute_H_b_2_MPS: 57.3ms | mem: 1200.4->1367.9MB | peak: 1427.9MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 1367.9->1367.9MB | peak: 1367.9MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 1367.9->1367.9MB | peak: 1367.9MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 1367.9->1387.9MB | peak: 1407.9MB
[PROFILE] env_1_MPS: 1.1ms | mem: 1387.9->1401.2MB | peak: 1407.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1401.2->1401.2MB | peak: 1401.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 1401.2->1401.2MB | peak: 1401.2MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 1401.2->1407.4MB | peak: 1407.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1407.4->1407.4MB | peak: 1407.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 1407.4->1433.6MB | peak: 1453.6MB
[PROFILE] env_1_MPS: 1.2ms | mem: 1433.6->1447.5MB | peak: 1453.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1447.5->1447.5MB | peak: 1447.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 1447.5->1447.5MB | peak: 1447.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1447.5->1453.7MB | peak: 1453.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1453.7->1453.7MB | peak: 1453.7MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 1453.7->1479.9MB | peak: 1499.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 1479.9->1493.7MB | peak: 1499.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1493.7->1493.7MB | peak: 1493.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 1493.7->1493.7MB | peak: 1493.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1493.7->1499.9MB | peak: 1499.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1499.9->1499.9MB | peak: 1499.9MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 1499.9->1526.1MB | peak: 1546.1MB
[PROFILE] env_1_MPS: 1.2ms | mem: 1506.1->1519.4MB | peak: 1525.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1519.4->1519.4MB | peak: 1519.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 1519.4->1519.4MB | peak: 1519.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1519.4->1525.6MB | peak: 1525.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1525.6->1525.6MB | peak: 1525.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 1525.6->1551.8MB | peak: 1571.8MB
[PROFILE] env_1_MPS: 1.0ms | mem: 1531.8->1545.7MB | peak: 1551.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1545.7->1545.7MB | peak: 1545.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 1545.7->1545.7MB | peak: 1545.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1545.7->1551.9MB | peak: 1551.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1551.9->1551.9MB | peak: 1551.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 1551.9->1578.1MB | peak: 1598.1MB
[PROFILE] env_1_MPS: 1.7ms | mem: 1558.0->1567.5MB | peak: 1571.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1567.5->1567.5MB | peak: 1567.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 1567.5->1567.5MB | peak: 1567.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1567.5->1571.9MB | peak: 1571.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1571.9->1571.9MB | peak: 1571.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 1571.9->1596.3MB | peak: 1616.3MB
[PROFILE] compute_H_b_1_MPS: 36.1ms | mem: 1387.9->1556.3MB | peak: 1616.3MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 1556.3->1556.3MB | peak: 1556.3MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 1556.3->1556.3MB | peak: 1556.3MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 1556.3->1576.3MB | peak: 1596.3MB
[PROFILE] env_0_MPS: 0.9ms | mem: 1576.3->1583.9MB | peak: 1600.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 1583.9->1583.9MB | peak: 1583.9MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 1583.9->1583.9MB | peak: 1584.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 1583.9->1584.5MB | peak: 1584.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 1584.5->1584.5MB | peak: 1584.5MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 1584.5->1585.1MB | peak: 1585.6MB
[PROFILE] env_0_MPS: 1.1ms | mem: 1585.1->1592.7MB | peak: 1609.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 1592.7->1592.8MB | peak: 1592.8MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 1592.8->1592.8MB | peak: 1592.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 1592.8->1593.3MB | peak: 1593.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 1593.3->1593.3MB | peak: 1593.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 1593.3->1593.9MB | peak: 1594.4MB
[PROFILE] env_0_MPS: 1.1ms | mem: 1593.9->1601.6MB | peak: 1618.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 1601.6->1601.6MB | peak: 1601.6MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 1601.6->1601.6MB | peak: 1601.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 1601.6->1602.1MB | peak: 1602.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 1602.1->1602.1MB | peak: 1602.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 1602.1->1602.7MB | peak: 1603.3MB
[PROFILE] env_0_MPS: 1.0ms | mem: 1602.6->1610.2MB | peak: 1626.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 1610.2->1610.2MB | peak: 1610.3MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 1610.2->1610.3MB | peak: 1610.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 1610.3->1610.8MB | peak: 1610.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 1610.8->1610.8MB | peak: 1610.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 1610.8->1611.4MB | peak: 1611.9MB
[PROFILE] env_0_MPS: 0.9ms | mem: 1611.3->1618.9MB | peak: 1635.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 1618.9->1618.9MB | peak: 1618.9MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 1618.9->1618.9MB | peak: 1618.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 1618.9->1619.5MB | peak: 1619.5MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 1619.5->1619.5MB | peak: 1619.5MB
[PROFILE] hess_contract_0_MPS: 0.4ms | mem: 1619.5->1620.1MB | peak: 1620.6MB
[PROFILE] env_0_MPS: 0.1ms | mem: 1620.0->1625.8MB | peak: 1637.9MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 1625.8->1625.8MB | peak: 1625.8MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 1625.8->1625.8MB | peak: 1625.8MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 1625.8->1626.2MB | peak: 1626.2MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 1626.2->1626.2MB | peak: 1626.2MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 1626.2->1626.7MB | peak: 1627.0MB
[PROFILE] compute_H_b_0_MPS: 45.2ms | mem: 1576.3->1626.4MB | peak: 1627.0MB
[PROFILE] fuse_0_MPS: 0.0ms | mem: 1626.4->1626.4MB | peak: 1626.4MB
[PROFILE] to_dense_0_MPS: 0.0ms | mem: 1626.4->1626.4MB | peak: 1626.4MB
[PROFILE] solve_0_MPS: 2.6ms | mem: 1626.4->1626.5MB | peak: 1626.7MB
[PROFILE] env_1_MPS: 1.0ms | mem: 1626.5->1639.9MB | peak: 1646.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1639.9->1639.9MB | peak: 1639.9MB
[PROFILE] loss_derivs_1_MPS: 1.3ms | mem: 1639.9->1639.9MB | peak: 1639.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1639.9->1646.1MB | peak: 1646.1MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 1646.1->1646.1MB | peak: 1646.1MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 1646.1->1672.3MB | peak: 1692.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 1672.3->1685.6MB | peak: 1691.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1685.6->1685.6MB | peak: 1685.6MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 1685.6->1685.6MB | peak: 1685.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1685.6->1691.8MB | peak: 1691.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1691.8->1691.8MB | peak: 1691.8MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 1691.8->1718.0MB | peak: 1738.0MB
[PROFILE] env_1_MPS: 1.1ms | mem: 1718.0->1731.9MB | peak: 1738.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1731.9->1731.9MB | peak: 1731.9MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 1731.9->1731.9MB | peak: 1731.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1731.9->1738.1MB | peak: 1738.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1738.1->1738.1MB | peak: 1738.1MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 1738.1->1764.3MB | peak: 1784.3MB
[PROFILE] env_1_MPS: 1.3ms | mem: 1744.2->1758.1MB | peak: 1764.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1758.1->1758.1MB | peak: 1758.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 1758.1->1758.1MB | peak: 1758.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1758.1->1764.3MB | peak: 1764.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1764.3->1764.3MB | peak: 1764.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 1764.3->1790.5MB | peak: 1810.5MB
[PROFILE] env_1_MPS: 1.6ms | mem: 1770.5->1783.8MB | peak: 1790.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 1783.8->1783.8MB | peak: 1783.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 1783.8->1783.8MB | peak: 1783.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1783.8->1790.0MB | peak: 1790.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1790.0->1790.0MB | peak: 1790.0MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 1790.0->1816.2MB | peak: 1836.2MB
[PROFILE] env_1_MPS: 1.0ms | mem: 1796.2->1806.0MB | peak: 1810.4MB
[PROFILE] forward_1_MPS: 0.8ms | mem: 1806.0->1806.0MB | peak: 1806.0MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 1806.0->1806.0MB | peak: 1806.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 1806.0->1810.4MB | peak: 1810.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 1810.4->1810.4MB | peak: 1810.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 1810.4->1834.8MB | peak: 1854.8MB
[PROFILE] compute_H_b_1_MPS: 37.8ms | mem: 1626.5->1794.8MB | peak: 1854.8MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 1794.8->1794.8MB | peak: 1794.8MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 1794.8->1794.8MB | peak: 1794.8MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 1794.8->1814.8MB | peak: 1834.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1814.8->1828.3MB | peak: 1834.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1828.3->1828.3MB | peak: 1828.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1828.3->1828.3MB | peak: 1828.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1828.3->1834.5MB | peak: 1834.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1834.5->1834.5MB | peak: 1834.5MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 1834.5->1860.6MB | peak: 1880.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1860.6->1874.1MB | peak: 1880.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1874.1->1874.1MB | peak: 1874.1MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 1874.1->1874.1MB | peak: 1874.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1874.1->1880.3MB | peak: 1880.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1880.3->1880.3MB | peak: 1880.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 1880.3->1906.5MB | peak: 1926.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1906.5->1919.9MB | peak: 1926.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1919.9->1919.9MB | peak: 1919.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 1919.9->1919.9MB | peak: 1920.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1919.9->1926.1MB | peak: 1926.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1926.1->1926.1MB | peak: 1926.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 1926.1->1952.3MB | peak: 1972.3MB
[PROFILE] env_2_MPS: 1.6ms | mem: 1932.3->1945.8MB | peak: 1952.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1945.8->1945.8MB | peak: 1945.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1945.8->1945.8MB | peak: 1945.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1945.8->1952.0MB | peak: 1952.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1952.0->1952.0MB | peak: 1952.0MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 1952.0->1978.2MB | peak: 1998.2MB
[PROFILE] env_2_MPS: 1.0ms | mem: 1958.2->1971.6MB | peak: 1977.8MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 1971.6->1971.6MB | peak: 1971.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 1971.6->1971.6MB | peak: 1971.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1971.6->1977.8MB | peak: 1977.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1977.8->1977.8MB | peak: 1977.8MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 1977.8->2004.0MB | peak: 2024.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 1984.0->1993.5MB | peak: 1998.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 1993.5->1993.6MB | peak: 1993.6MB
[PROFILE] loss_derivs_2_MPS: 1.1ms | mem: 1993.6->1993.6MB | peak: 1993.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 1993.6->1998.0MB | peak: 1998.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 1998.0->1998.0MB | peak: 1998.0MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 1998.0->2022.3MB | peak: 2042.3MB
[PROFILE] compute_H_b_2_MPS: 36.6ms | mem: 1814.8->1982.3MB | peak: 2042.3MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 1982.3->1982.3MB | peak: 1982.3MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 1982.3->1982.3MB | peak: 1982.3MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 1982.3->2002.4MB | peak: 2022.4MB
[PROFILE] env_3_MPS: 1.1ms | mem: 2002.3->2005.4MB | peak: 2022.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2005.4->2005.9MB | peak: 2005.9MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 2005.9->2005.9MB | peak: 2005.9MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2005.9->2006.4MB | peak: 2006.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 2006.4->2006.4MB | peak: 2006.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 2006.4->2007.6MB | peak: 2008.1MB
[PROFILE] env_3_MPS: 1.1ms | mem: 2007.1->2010.1MB | peak: 2027.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2010.1->2010.6MB | peak: 2010.6MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 2010.6->2010.6MB | peak: 2010.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2010.6->2011.1MB | peak: 2011.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 2011.1->2011.1MB | peak: 2011.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 2011.1->2012.3MB | peak: 2012.8MB
[PROFILE] env_3_MPS: 1.2ms | mem: 2011.8->2014.8MB | peak: 2031.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2014.8->2015.3MB | peak: 2015.3MB
[PROFILE] loss_derivs_3_MPS: 0.8ms | mem: 2015.3->2015.3MB | peak: 2015.3MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 2015.3->2015.8MB | peak: 2015.8MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 2015.8->2015.8MB | peak: 2015.8MB
[PROFILE] hess_contract_3_MPS: 1.8ms | mem: 2015.8->2017.0MB | peak: 2017.5MB
[PROFILE] env_3_MPS: 1.9ms | mem: 2016.4->2019.4MB | peak: 2036.3MB
[PROFILE] forward_3_MPS: 0.0ms | mem: 2019.4->2019.9MB | peak: 2019.9MB
[PROFILE] loss_derivs_3_MPS: 0.0ms | mem: 2019.9->2019.9MB | peak: 2019.9MB
[PROFILE] grad_contract_3_MPS: 0.5ms | mem: 2019.9->2020.4MB | peak: 2020.4MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 2020.4->2020.4MB | peak: 2020.4MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 2020.4->2021.6MB | peak: 2022.1MB
[PROFILE] env_3_MPS: 0.5ms | mem: 2020.9->2024.0MB | peak: 2040.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2024.0->2024.5MB | peak: 2024.5MB
[PROFILE] loss_derivs_3_MPS: 0.0ms | mem: 2024.5->2024.5MB | peak: 2024.5MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 2024.5->2025.0MB | peak: 2025.0MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 2025.0->2025.0MB | peak: 2025.0MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 2025.0->2026.2MB | peak: 2026.7MB
[PROFILE] env_3_MPS: 0.1ms | mem: 2025.5->2028.1MB | peak: 2040.1MB
[PROFILE] forward_3_MPS: 0.4ms | mem: 2028.1->2028.5MB | peak: 2028.5MB
[PROFILE] loss_derivs_3_MPS: 0.4ms | mem: 2028.5->2028.5MB | peak: 2028.5MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2028.5->2028.9MB | peak: 2028.9MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 2028.9->2028.9MB | peak: 2028.9MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 2028.9->2029.7MB | peak: 2030.1MB
[PROFILE] compute_H_b_3_MPS: 56.2ms | mem: 2002.3->2029.1MB | peak: 2030.1MB
[PROFILE] fuse_3_MPS: 0.0ms | mem: 2029.1->2029.1MB | peak: 2029.1MB
[PROFILE] to_dense_3_MPS: 0.0ms | mem: 2029.1->2029.1MB | peak: 2029.1MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 2029.1->2029.2MB | peak: 2029.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2029.2->2042.7MB | peak: 2048.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2042.7->2042.7MB | peak: 2042.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 2042.7->2042.7MB | peak: 2042.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2042.7->2048.9MB | peak: 2048.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2048.9->2048.9MB | peak: 2048.9MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 2048.9->2075.1MB | peak: 2095.1MB
[PROFILE] env_2_MPS: 1.3ms | mem: 2075.1->2088.5MB | peak: 2095.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2088.5->2088.5MB | peak: 2088.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 2088.5->2088.5MB | peak: 2088.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2088.5->2094.7MB | peak: 2094.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2094.7->2094.7MB | peak: 2094.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2094.7->2120.9MB | peak: 2140.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2120.9->2134.3MB | peak: 2141.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2134.3->2134.4MB | peak: 2134.4MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 2134.4->2134.4MB | peak: 2134.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2134.4->2140.6MB | peak: 2140.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2140.6->2140.6MB | peak: 2140.6MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 2140.6->2166.7MB | peak: 2186.7MB
[PROFILE] env_2_MPS: 1.1ms | mem: 2146.7->2160.2MB | peak: 2166.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2160.2->2160.2MB | peak: 2160.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2160.2->2160.2MB | peak: 2160.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2160.2->2166.4MB | peak: 2166.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2166.4->2166.4MB | peak: 2166.4MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 2166.4->2192.6MB | peak: 2212.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2172.6->2186.0MB | peak: 2192.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2186.0->2186.0MB | peak: 2186.0MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2186.0->2186.0MB | peak: 2186.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2186.0->2192.2MB | peak: 2192.2MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 2192.2->2192.2MB | peak: 2192.2MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 2192.2->2218.4MB | peak: 2238.4MB
[PROFILE] env_2_MPS: 1.1ms | mem: 2198.4->2208.0MB | peak: 2212.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2208.0->2208.0MB | peak: 2208.0MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2208.0->2208.0MB | peak: 2208.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2208.0->2212.4MB | peak: 2212.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2212.4->2212.4MB | peak: 2212.4MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 2212.4->2236.8MB | peak: 2256.8MB
[PROFILE] compute_H_b_2_MPS: 36.7ms | mem: 2029.2->2196.7MB | peak: 2256.8MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 2196.7->2196.7MB | peak: 2196.7MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 2196.7->2196.7MB | peak: 2196.7MB
[PROFILE] solve_2_MPS: 1.6ms | mem: 2196.7->2216.8MB | peak: 2236.8MB
[PROFILE] env_1_MPS: 1.3ms | mem: 2216.8->2230.1MB | peak: 2236.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2230.1->2230.1MB | peak: 2230.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2230.1->2230.1MB | peak: 2230.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2230.1->2236.3MB | peak: 2236.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2236.3->2236.3MB | peak: 2236.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 2236.3->2262.5MB | peak: 2282.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 2262.5->2276.3MB | peak: 2282.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2276.3->2276.3MB | peak: 2276.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 2276.3->2276.3MB | peak: 2276.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2276.3->2282.5MB | peak: 2282.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2282.5->2282.5MB | peak: 2282.5MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 2282.5->2308.7MB | peak: 2328.7MB
[PROFILE] env_1_MPS: 1.1ms | mem: 2308.7->2322.6MB | peak: 2328.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2322.6->2322.6MB | peak: 2322.6MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2322.6->2322.6MB | peak: 2322.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2322.6->2328.8MB | peak: 2328.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2328.8->2328.8MB | peak: 2328.8MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 2328.8->2355.0MB | peak: 2375.0MB
[PROFILE] env_1_MPS: 1.3ms | mem: 2335.0->2348.3MB | peak: 2354.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2348.3->2348.3MB | peak: 2348.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 2348.3->2348.3MB | peak: 2348.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2348.3->2354.5MB | peak: 2354.5MB
[PROFILE] hess_tn_build_1_MPS: 0.5ms | mem: 2354.5->2354.5MB | peak: 2354.5MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 2354.5->2380.7MB | peak: 2400.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 2360.7->2374.5MB | peak: 2380.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2374.5->2374.5MB | peak: 2374.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 2374.5->2374.5MB | peak: 2374.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2374.5->2380.7MB | peak: 2380.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2380.7->2380.7MB | peak: 2380.7MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 2380.7->2406.9MB | peak: 2426.9MB
[PROFILE] env_1_MPS: 1.1ms | mem: 2386.9->2396.7MB | peak: 2401.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2396.7->2396.7MB | peak: 2396.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 2396.7->2396.7MB | peak: 2396.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2396.7->2401.1MB | peak: 2401.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2401.1->2401.1MB | peak: 2401.1MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 2401.1->2425.5MB | peak: 2445.5MB
[PROFILE] compute_H_b_1_MPS: 37.2ms | mem: 2216.8->2385.5MB | peak: 2445.5MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 2385.5->2385.5MB | peak: 2385.5MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 2385.5->2385.5MB | peak: 2385.5MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 2385.5->2405.5MB | peak: 2425.5MB
[PROFILE] env_0_MPS: 3.0ms | mem: 2405.5->2413.2MB | peak: 2429.7MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 2413.2->2413.2MB | peak: 2413.2MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 2413.2->2413.2MB | peak: 2413.2MB
[PROFILE] grad_contract_0_MPS: 2.5ms | mem: 2413.2->2413.7MB | peak: 2413.7MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 2413.7->2413.7MB | peak: 2413.7MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 2413.7->2414.4MB | peak: 2414.9MB
[PROFILE] env_0_MPS: 0.2ms | mem: 2414.4->2422.0MB | peak: 2438.5MB
[PROFILE] forward_0_MPS: 0.4ms | mem: 2422.0->2422.0MB | peak: 2422.0MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 2422.0->2422.0MB | peak: 2422.0MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 2422.0->2422.5MB | peak: 2422.5MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 2422.5->2422.5MB | peak: 2422.5MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 2422.5->2423.2MB | peak: 2423.7MB
[PROFILE] env_0_MPS: 0.2ms | mem: 2423.2->2430.8MB | peak: 2447.3MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 2430.8->2430.8MB | peak: 2430.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 2430.8->2430.8MB | peak: 2430.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 2430.8->2431.3MB | peak: 2431.3MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 2431.3->2431.3MB | peak: 2431.3MB
[PROFILE] hess_contract_0_MPS: 0.7ms | mem: 2431.3->2432.0MB | peak: 2432.5MB
[PROFILE] env_0_MPS: 0.9ms | mem: 2431.8->2439.5MB | peak: 2456.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 2439.5->2439.5MB | peak: 2439.5MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 2439.5->2439.5MB | peak: 2439.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 2439.5->2440.0MB | peak: 2440.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 2440.0->2440.0MB | peak: 2440.0MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 2440.0->2440.7MB | peak: 2441.2MB
[PROFILE] env_0_MPS: 1.1ms | mem: 2440.5->2448.2MB | peak: 2464.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 2448.2->2448.2MB | peak: 2448.2MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 2448.2->2448.2MB | peak: 2448.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 2448.2->2448.7MB | peak: 2448.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 2448.7->2448.7MB | peak: 2448.7MB
[PROFILE] hess_contract_0_MPS: 0.8ms | mem: 2448.7->2449.3MB | peak: 2449.9MB
[PROFILE] env_0_MPS: 1.0ms | mem: 2449.2->2455.1MB | peak: 2467.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 2455.1->2455.1MB | peak: 2455.1MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 2455.1->2455.1MB | peak: 2455.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 2455.1->2455.5MB | peak: 2455.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 2455.5->2455.5MB | peak: 2455.5MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 2455.5->2456.0MB | peak: 2456.3MB
[PROFILE] compute_H_b_0_MPS: 54.0ms | mem: 2405.5->2455.7MB | peak: 2456.3MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 2455.7->2455.7MB | peak: 2455.7MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 2455.7->2455.7MB | peak: 2455.7MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 2455.7->2455.9MB | peak: 2456.0MB
[PROFILE] env_1_MPS: 1.0ms | mem: 2455.9->2469.2MB | peak: 2475.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2469.2->2469.2MB | peak: 2469.2MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2469.2->2469.2MB | peak: 2469.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2469.2->2475.4MB | peak: 2475.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2475.4->2475.4MB | peak: 2475.4MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 2475.4->2501.6MB | peak: 2521.6MB
[PROFILE] env_1_MPS: 1.3ms | mem: 2501.6->2515.4MB | peak: 2521.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2515.4->2515.4MB | peak: 2515.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2515.4->2515.4MB | peak: 2515.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2515.4->2521.6MB | peak: 2521.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2521.6->2521.6MB | peak: 2521.6MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 2521.6->2547.8MB | peak: 2567.8MB
[PROFILE] env_1_MPS: 1.2ms | mem: 2547.8->2561.7MB | peak: 2567.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2561.7->2561.7MB | peak: 2561.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2561.7->2561.7MB | peak: 2561.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2561.7->2567.9MB | peak: 2567.9MB
[PROFILE] hess_tn_build_1_MPS: 0.5ms | mem: 2567.9->2567.9MB | peak: 2567.9MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 2567.9->2594.1MB | peak: 2614.1MB
[PROFILE] env_1_MPS: 1.2ms | mem: 2574.1->2587.4MB | peak: 2593.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2587.4->2587.4MB | peak: 2587.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 2587.4->2587.4MB | peak: 2587.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2587.4->2593.6MB | peak: 2593.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2593.6->2593.6MB | peak: 2593.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 2593.6->2619.8MB | peak: 2639.8MB
[PROFILE] env_1_MPS: 1.0ms | mem: 2599.8->2613.6MB | peak: 2619.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2613.6->2613.6MB | peak: 2613.6MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2613.6->2613.6MB | peak: 2613.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2613.6->2619.8MB | peak: 2619.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2619.8->2619.8MB | peak: 2619.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 2619.8->2646.0MB | peak: 2666.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 2626.0->2635.8MB | peak: 2640.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 2635.8->2635.8MB | peak: 2635.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 2635.8->2635.8MB | peak: 2635.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 2635.8->2640.2MB | peak: 2640.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 2640.2->2640.2MB | peak: 2640.2MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 2640.2->2664.6MB | peak: 2684.6MB
[PROFILE] compute_H_b_1_MPS: 36.5ms | mem: 2455.9->2624.6MB | peak: 2684.6MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 2624.6->2624.6MB | peak: 2624.6MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 2624.6->2624.6MB | peak: 2624.6MB
[PROFILE] solve_1_MPS: 1.6ms | mem: 2624.6->2644.6MB | peak: 2664.6MB
[PROFILE] env_2_MPS: 1.3ms | mem: 2644.6->2658.7MB | peak: 2664.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2658.7->2658.7MB | peak: 2658.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 2658.7->2658.7MB | peak: 2658.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2658.7->2664.9MB | peak: 2664.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2664.9->2664.9MB | peak: 2664.9MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 2664.9->2691.1MB | peak: 2711.1MB
[PROFILE] env_2_MPS: 1.3ms | mem: 2691.1->2704.6MB | peak: 2710.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2704.6->2704.6MB | peak: 2704.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2704.6->2704.6MB | peak: 2704.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2704.6->2710.8MB | peak: 2710.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2710.8->2710.8MB | peak: 2710.8MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 2710.8->2737.0MB | peak: 2757.0MB
[PROFILE] env_2_MPS: 1.1ms | mem: 2737.0->2750.4MB | peak: 2757.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2750.4->2750.4MB | peak: 2750.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 2750.4->2750.4MB | peak: 2750.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2750.4->2756.6MB | peak: 2756.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2756.6->2756.6MB | peak: 2756.6MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2756.6->2782.8MB | peak: 2802.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2762.8->2776.2MB | peak: 2782.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2776.2->2776.2MB | peak: 2776.2MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 2776.2->2776.2MB | peak: 2776.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2776.2->2782.4MB | peak: 2782.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2782.4->2782.4MB | peak: 2782.4MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2782.4->2808.6MB | peak: 2828.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2788.6->2802.1MB | peak: 2808.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2802.1->2802.1MB | peak: 2802.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2802.1->2802.1MB | peak: 2802.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2802.1->2808.3MB | peak: 2808.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2808.3->2808.3MB | peak: 2808.3MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 2808.3->2834.5MB | peak: 2854.5MB
[PROFILE] env_2_MPS: 1.5ms | mem: 2814.5->2824.0MB | peak: 2828.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2824.0->2824.0MB | peak: 2824.0MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 2824.0->2824.0MB | peak: 2824.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2824.0->2828.4MB | peak: 2828.4MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 2828.4->2828.4MB | peak: 2828.4MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 2828.4->2852.8MB | peak: 2872.8MB
[PROFILE] compute_H_b_2_MPS: 40.2ms | mem: 2644.6->2812.8MB | peak: 2872.8MB
[PROFILE] fuse_2_MPS: 0.0ms | mem: 2812.8->2812.8MB | peak: 2812.8MB
[PROFILE] to_dense_2_MPS: 0.0ms | mem: 2812.8->2812.8MB | peak: 2812.8MB
[PROFILE] solve_2_MPS: 3.3ms | mem: 2812.8->2832.8MB | peak: 2852.8MB
[PROFILE] env_3_MPS: 0.2ms | mem: 2832.8->2835.8MB | peak: 2852.8MB
[PROFILE] forward_3_MPS: 0.0ms | mem: 2835.8->2836.4MB | peak: 2836.4MB
[PROFILE] loss_derivs_3_MPS: 2.5ms | mem: 2836.4->2836.4MB | peak: 2836.4MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 2836.4->2836.9MB | peak: 2836.9MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 2836.9->2836.9MB | peak: 2836.9MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 2836.9->2838.0MB | peak: 2838.6MB
[PROFILE] env_3_MPS: 0.8ms | mem: 2837.5->2840.6MB | peak: 2857.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2840.6->2841.1MB | peak: 2841.1MB
[PROFILE] loss_derivs_3_MPS: 1.0ms | mem: 2841.1->2841.1MB | peak: 2841.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2841.1->2841.6MB | peak: 2841.6MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 2841.6->2841.6MB | peak: 2841.6MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 2841.6->2842.8MB | peak: 2843.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 2842.2->2845.3MB | peak: 2862.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2845.3->2845.8MB | peak: 2845.8MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 2845.8->2845.8MB | peak: 2845.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2845.8->2846.3MB | peak: 2846.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 2846.3->2846.3MB | peak: 2846.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 2846.3->2847.5MB | peak: 2848.0MB
[PROFILE] env_3_MPS: 1.2ms | mem: 2846.8->2849.8MB | peak: 2866.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2849.8->2850.4MB | peak: 2850.4MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 2850.4->2850.4MB | peak: 2850.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2850.4->2850.9MB | peak: 2850.9MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 2850.9->2850.9MB | peak: 2850.9MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 2850.9->2852.1MB | peak: 2852.6MB
[PROFILE] env_3_MPS: 1.6ms | mem: 2851.4->2854.4MB | peak: 2871.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 2854.4->2854.9MB | peak: 2855.0MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 2854.9->2855.0MB | peak: 2855.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2855.0->2855.5MB | peak: 2855.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 2855.5->2855.5MB | peak: 2855.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 2855.5->2856.6MB | peak: 2857.2MB
[PROFILE] env_3_MPS: 1.0ms | mem: 2856.0->2858.6MB | peak: 2871.0MB
[PROFILE] forward_3_MPS: 0.7ms | mem: 2858.6->2859.0MB | peak: 2859.0MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 2859.0->2859.0MB | peak: 2859.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 2859.0->2859.3MB | peak: 2859.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 2859.3->2859.3MB | peak: 2859.3MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 2859.3->2860.2MB | peak: 2860.6MB
[PROFILE] compute_H_b_3_MPS: 44.8ms | mem: 2832.8->2859.6MB | peak: 2860.6MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 2859.6->2859.6MB | peak: 2859.6MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 2859.6->2859.6MB | peak: 2859.6MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 2859.6->2859.7MB | peak: 2859.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2859.7->2873.1MB | peak: 2879.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2873.1->2873.1MB | peak: 2873.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 2873.1->2873.1MB | peak: 2873.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2873.1->2879.3MB | peak: 2879.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2879.3->2879.3MB | peak: 2879.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2879.3->2905.5MB | peak: 2925.5MB
[PROFILE] env_2_MPS: 1.3ms | mem: 2905.5->2919.0MB | peak: 2925.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2919.0->2919.0MB | peak: 2919.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 2919.0->2919.0MB | peak: 2919.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2919.0->2925.2MB | peak: 2925.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2925.2->2925.2MB | peak: 2925.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2925.2->2951.4MB | peak: 2971.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 2951.4->2964.8MB | peak: 2971.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2964.8->2964.8MB | peak: 2964.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2964.8->2964.8MB | peak: 2964.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2964.8->2971.0MB | peak: 2971.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2971.0->2971.0MB | peak: 2971.0MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2971.0->2997.2MB | peak: 3017.2MB
[PROFILE] env_2_MPS: 1.4ms | mem: 2977.2->2990.6MB | peak: 2997.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 2990.6->2990.7MB | peak: 2990.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 2990.7->2990.7MB | peak: 2990.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 2990.7->2996.9MB | peak: 2996.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 2996.9->2996.9MB | peak: 2996.9MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 2996.9->3023.0MB | peak: 3043.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3003.0->3016.5MB | peak: 3022.7MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 3016.5->3016.5MB | peak: 3016.5MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 3016.5->3016.5MB | peak: 3016.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3016.5->3022.7MB | peak: 3022.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3022.7->3022.7MB | peak: 3022.7MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 3022.7->3048.9MB | peak: 3068.9MB
[PROFILE] env_2_MPS: 1.1ms | mem: 3028.9->3038.4MB | peak: 3043.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3038.4->3038.4MB | peak: 3038.4MB
[PROFILE] loss_derivs_2_MPS: 1.0ms | mem: 3038.4->3038.4MB | peak: 3038.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3038.4->3042.8MB | peak: 3042.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3042.8->3042.8MB | peak: 3042.8MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 3042.8->3067.2MB | peak: 3087.2MB
[PROFILE] compute_H_b_2_MPS: 36.6ms | mem: 2859.7->3027.2MB | peak: 3087.2MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 3027.2->3027.2MB | peak: 3027.2MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 3027.2->3027.2MB | peak: 3027.2MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 3027.2->3047.2MB | peak: 3067.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3047.2->3060.6MB | peak: 3066.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3060.6->3060.6MB | peak: 3060.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 3060.6->3060.6MB | peak: 3060.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3060.6->3066.8MB | peak: 3066.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3066.8->3066.8MB | peak: 3066.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 3066.8->3093.0MB | peak: 3113.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3093.0->3106.8MB | peak: 3113.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3106.8->3106.8MB | peak: 3106.8MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 3106.8->3106.8MB | peak: 3106.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3106.8->3113.0MB | peak: 3113.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3113.0->3113.0MB | peak: 3113.0MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 3113.0->3139.2MB | peak: 3159.2MB
[PROFILE] env_1_MPS: 1.3ms | mem: 3139.2->3153.1MB | peak: 3159.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3153.1->3153.1MB | peak: 3153.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 3153.1->3153.1MB | peak: 3153.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3153.1->3159.3MB | peak: 3159.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3159.3->3159.3MB | peak: 3159.3MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 3159.3->3185.5MB | peak: 3205.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3165.4->3178.8MB | peak: 3185.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3178.8->3178.8MB | peak: 3178.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 3178.8->3178.8MB | peak: 3178.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3178.8->3185.0MB | peak: 3185.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3185.0->3185.0MB | peak: 3185.0MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 3185.0->3211.2MB | peak: 3231.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3191.2->3205.0MB | peak: 3211.2MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 3205.0->3205.0MB | peak: 3205.0MB
[PROFILE] loss_derivs_1_MPS: 0.4ms | mem: 3205.0->3205.0MB | peak: 3205.0MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 3205.0->3211.2MB | peak: 3211.2MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 3211.2->3211.2MB | peak: 3211.2MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 3211.2->3237.4MB | peak: 3257.4MB
[PROFILE] env_1_MPS: 0.1ms | mem: 3217.4->3226.8MB | peak: 3231.2MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 3226.8->3226.8MB | peak: 3226.9MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 3226.8->3226.9MB | peak: 3226.9MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 3226.9->3231.3MB | peak: 3231.3MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 3231.3->3231.3MB | peak: 3231.3MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 3231.3->3255.6MB | peak: 3275.6MB
[PROFILE] compute_H_b_1_MPS: 50.1ms | mem: 3047.2->3215.6MB | peak: 3275.6MB
[PROFILE] fuse_1_MPS: 0.0ms | mem: 3215.6->3215.6MB | peak: 3215.6MB
[PROFILE] to_dense_1_MPS: 0.0ms | mem: 3215.6->3215.6MB | peak: 3215.6MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 3215.6->3235.7MB | peak: 3255.7MB
[PROFILE] env_0_MPS: 0.9ms | mem: 3235.6->3243.3MB | peak: 3259.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 3243.3->3243.3MB | peak: 3243.3MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 3243.3->3243.3MB | peak: 3243.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 3243.3->3243.8MB | peak: 3243.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 3243.8->3243.8MB | peak: 3243.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 3243.8->3244.5MB | peak: 3245.0MB
[PROFILE] env_0_MPS: 1.3ms | mem: 3244.5->3252.1MB | peak: 3268.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 3252.1->3252.1MB | peak: 3252.1MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 3252.1->3252.1MB | peak: 3252.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 3252.1->3252.6MB | peak: 3252.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 3252.6->3252.6MB | peak: 3252.6MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 3252.6->3253.3MB | peak: 3253.8MB
[PROFILE] env_0_MPS: 1.1ms | mem: 3253.3->3260.9MB | peak: 3277.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 3260.9->3260.9MB | peak: 3260.9MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 3260.9->3260.9MB | peak: 3260.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 3260.9->3261.4MB | peak: 3261.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 3261.4->3261.4MB | peak: 3261.4MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 3261.4->3262.1MB | peak: 3262.6MB
[PROFILE] env_0_MPS: 1.2ms | mem: 3261.9->3269.6MB | peak: 3286.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 3269.6->3269.6MB | peak: 3269.6MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 3269.6->3269.6MB | peak: 3269.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 3269.6->3270.1MB | peak: 3270.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 3270.1->3270.1MB | peak: 3270.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 3270.1->3270.8MB | peak: 3271.3MB
[PROFILE] env_0_MPS: 1.0ms | mem: 3270.6->3278.3MB | peak: 3294.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 3278.3->3278.3MB | peak: 3278.3MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 3278.3->3278.3MB | peak: 3278.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 3278.3->3278.8MB | peak: 3278.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 3278.8->3278.8MB | peak: 3278.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 3278.8->3279.4MB | peak: 3280.0MB
[PROFILE] env_0_MPS: 1.0ms | mem: 3279.3->3285.4MB | peak: 3297.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 3285.4->3285.4MB | peak: 3285.4MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 3285.4->3285.4MB | peak: 3285.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 3285.4->3285.8MB | peak: 3285.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 3285.8->3285.8MB | peak: 3285.8MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 3285.8->3286.3MB | peak: 3286.6MB
[PROFILE] compute_H_b_0_MPS: 34.4ms | mem: 3235.6->3286.0MB | peak: 3286.6MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 3286.0->3286.0MB | peak: 3286.0MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 3286.0->3286.0MB | peak: 3286.0MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 3286.0->3286.1MB | peak: 3286.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3286.1->3299.5MB | peak: 3305.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3299.5->3299.5MB | peak: 3299.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 3299.5->3299.5MB | peak: 3299.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3299.5->3305.7MB | peak: 3305.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3305.7->3305.7MB | peak: 3305.7MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 3305.7->3331.9MB | peak: 3351.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3331.9->3345.7MB | peak: 3351.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3345.7->3345.7MB | peak: 3345.7MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 3345.7->3345.7MB | peak: 3345.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3345.7->3351.9MB | peak: 3351.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3351.9->3351.9MB | peak: 3351.9MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 3351.9->3378.1MB | peak: 3398.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 3378.1->3391.4MB | peak: 3397.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3391.4->3391.4MB | peak: 3391.4MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 3391.4->3391.4MB | peak: 3391.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3391.4->3397.6MB | peak: 3397.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3397.6->3397.6MB | peak: 3397.6MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 3397.6->3423.8MB | peak: 3443.8MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3403.8->3417.7MB | peak: 3423.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3417.7->3417.7MB | peak: 3417.7MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 3417.7->3417.7MB | peak: 3417.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3417.7->3423.9MB | peak: 3423.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3423.9->3423.9MB | peak: 3423.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 3423.9->3450.1MB | peak: 3470.1MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3430.1->3443.9MB | peak: 3450.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3443.9->3443.9MB | peak: 3443.9MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 3443.9->3443.9MB | peak: 3443.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3443.9->3450.1MB | peak: 3450.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3450.1->3450.1MB | peak: 3450.1MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 3450.1->3476.3MB | peak: 3496.3MB
[PROFILE] env_1_MPS: 1.1ms | mem: 3456.3->3466.1MB | peak: 3470.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3466.1->3466.1MB | peak: 3466.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 3466.1->3466.1MB | peak: 3466.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3466.1->3470.5MB | peak: 3470.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3470.5->3470.5MB | peak: 3470.5MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 3470.5->3495.6MB | peak: 3515.6MB
[PROFILE] compute_H_b_1_MPS: 37.2ms | mem: 3286.1->3455.5MB | peak: 3515.6MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 3455.5->3455.5MB | peak: 3455.5MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 3455.5->3455.5MB | peak: 3455.5MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 3455.5->3475.6MB | peak: 3495.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3475.6->3489.0MB | peak: 3495.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3489.0->3489.0MB | peak: 3489.0MB
[PROFILE] loss_derivs_2_MPS: 1.0ms | mem: 3489.0->3489.0MB | peak: 3489.0MB
[PROFILE] grad_contract_2_MPS: 1.7ms | mem: 3489.0->3495.2MB | peak: 3495.2MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 3495.2->3495.2MB | peak: 3495.2MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 3495.2->3521.4MB | peak: 3541.4MB
[PROFILE] env_2_MPS: 0.1ms | mem: 3521.4->3535.4MB | peak: 3541.5MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 3535.4->3535.4MB | peak: 3535.4MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 3535.4->3535.4MB | peak: 3535.4MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 3535.4->3541.6MB | peak: 3541.6MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 3541.6->3541.6MB | peak: 3541.6MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 3541.6->3567.8MB | peak: 3587.8MB
[PROFILE] env_2_MPS: 2.5ms | mem: 3567.8->3581.2MB | peak: 3587.4MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 3581.2->3581.2MB | peak: 3581.2MB
[PROFILE] loss_derivs_2_MPS: 2.5ms | mem: 3581.2->3581.2MB | peak: 3581.2MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 3581.2->3587.4MB | peak: 3587.4MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 3587.4->3587.4MB | peak: 3587.4MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 3587.4->3613.6MB | peak: 3633.6MB
[PROFILE] env_2_MPS: 0.9ms | mem: 3593.6->3607.5MB | peak: 3613.7MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 3607.5->3607.6MB | peak: 3607.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 3607.6->3607.6MB | peak: 3607.6MB
[PROFILE] grad_contract_2_MPS: 0.4ms | mem: 3607.6->3613.8MB | peak: 3613.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3613.8->3613.8MB | peak: 3613.8MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 3613.8->3639.9MB | peak: 3659.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3619.9->3633.9MB | peak: 3640.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3633.9->3633.9MB | peak: 3633.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 3633.9->3633.9MB | peak: 3633.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3633.9->3640.1MB | peak: 3640.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3640.1->3640.1MB | peak: 3640.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 3640.1->3666.3MB | peak: 3686.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3646.3->3655.8MB | peak: 3660.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3655.8->3655.8MB | peak: 3655.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 3655.8->3655.9MB | peak: 3655.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3655.9->3660.3MB | peak: 3660.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3660.3->3660.3MB | peak: 3660.3MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 3660.3->3684.6MB | peak: 3704.6MB
[PROFILE] compute_H_b_2_MPS: 58.5ms | mem: 3475.6->3644.6MB | peak: 3704.6MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 3644.6->3644.6MB | peak: 3644.6MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 3644.6->3644.6MB | peak: 3644.6MB
[PROFILE] solve_2_MPS: 1.6ms | mem: 3644.6->3664.7MB | peak: 3684.7MB
[PROFILE] env_3_MPS: 1.0ms | mem: 3664.6->3667.7MB | peak: 3684.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 3667.7->3668.2MB | peak: 3668.2MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 3668.2->3668.2MB | peak: 3668.2MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 3668.2->3668.7MB | peak: 3668.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 3668.7->3668.7MB | peak: 3668.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 3668.7->3669.9MB | peak: 3670.4MB
[PROFILE] env_3_MPS: 1.0ms | mem: 3669.4->3672.4MB | peak: 3689.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 3672.4->3672.9MB | peak: 3672.9MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 3672.9->3672.9MB | peak: 3672.9MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 3672.9->3673.4MB | peak: 3673.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 3673.4->3673.4MB | peak: 3673.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 3673.4->3674.6MB | peak: 3675.1MB
[PROFILE] env_3_MPS: 1.0ms | mem: 3674.1->3677.1MB | peak: 3694.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 3677.1->3677.6MB | peak: 3677.6MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 3677.6->3677.6MB | peak: 3677.6MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 3677.6->3678.1MB | peak: 3678.1MB
[PROFILE] hess_tn_build_3_MPS: 0.5ms | mem: 3678.1->3678.1MB | peak: 3678.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 3678.1->3679.3MB | peak: 3679.8MB
[PROFILE] env_3_MPS: 1.0ms | mem: 3678.7->3681.7MB | peak: 3698.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 3681.7->3682.2MB | peak: 3682.2MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 3682.2->3682.2MB | peak: 3682.2MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 3682.2->3682.7MB | peak: 3682.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 3682.7->3682.7MB | peak: 3682.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 3682.7->3683.9MB | peak: 3684.4MB
[PROFILE] env_3_MPS: 1.2ms | mem: 3683.2->3686.3MB | peak: 3703.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 3686.3->3686.8MB | peak: 3686.8MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 3686.8->3686.8MB | peak: 3686.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 3686.8->3687.3MB | peak: 3687.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 3687.3->3687.3MB | peak: 3687.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 3687.3->3688.5MB | peak: 3689.0MB
[PROFILE] env_3_MPS: 1.0ms | mem: 3687.8->3690.4MB | peak: 3702.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 3690.4->3690.8MB | peak: 3690.8MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 3690.8->3690.8MB | peak: 3690.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 3690.8->3691.2MB | peak: 3691.2MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 3691.2->3691.2MB | peak: 3691.2MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 3691.2->3692.0MB | peak: 3692.4MB
[PROFILE] compute_H_b_3_MPS: 35.5ms | mem: 3664.6->3691.4MB | peak: 3692.4MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 3691.4->3691.4MB | peak: 3691.4MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 3691.4->3691.4MB | peak: 3691.4MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 3691.4->3691.5MB | peak: 3691.7MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3691.5->3705.0MB | peak: 3711.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3705.0->3705.0MB | peak: 3705.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 3705.0->3705.0MB | peak: 3705.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3705.0->3711.2MB | peak: 3711.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3711.2->3711.2MB | peak: 3711.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 3711.2->3737.4MB | peak: 3757.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3737.4->3751.3MB | peak: 3757.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3751.3->3751.3MB | peak: 3751.3MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 3751.3->3751.3MB | peak: 3751.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3751.3->3757.5MB | peak: 3757.5MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 3757.5->3757.5MB | peak: 3757.5MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 3757.5->3783.7MB | peak: 3803.7MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3783.7->3797.2MB | peak: 3803.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3797.2->3797.2MB | peak: 3797.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 3797.2->3797.2MB | peak: 3797.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3797.2->3803.4MB | peak: 3803.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3803.4->3803.4MB | peak: 3803.4MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 3803.4->3829.6MB | peak: 3849.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 3809.5->3823.5MB | peak: 3829.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3823.5->3823.5MB | peak: 3823.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 3823.5->3823.5MB | peak: 3823.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3823.5->3829.7MB | peak: 3829.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3829.7->3829.7MB | peak: 3829.7MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 3829.7->3855.9MB | peak: 3875.9MB
[PROFILE] env_2_MPS: 1.0ms | mem: 3835.9->3849.9MB | peak: 3856.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3849.9->3849.9MB | peak: 3849.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 3849.9->3849.9MB | peak: 3849.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3849.9->3856.1MB | peak: 3856.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3856.1->3856.1MB | peak: 3856.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 3856.1->3882.3MB | peak: 3902.3MB
[PROFILE] env_2_MPS: 1.6ms | mem: 3862.2->3871.8MB | peak: 3876.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 3871.8->3871.8MB | peak: 3871.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 3871.8->3871.8MB | peak: 3871.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 3871.8->3876.2MB | peak: 3876.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 3876.2->3876.2MB | peak: 3876.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 3876.2->3900.6MB | peak: 3920.6MB
[PROFILE] compute_H_b_2_MPS: 37.3ms | mem: 3691.5->3860.6MB | peak: 3920.6MB
[PROFILE] fuse_2_MPS: 0.0ms | mem: 3860.6->3860.6MB | peak: 3860.6MB
[PROFILE] to_dense_2_MPS: 0.0ms | mem: 3860.6->3860.6MB | peak: 3860.6MB
[PROFILE] solve_2_MPS: 3.8ms | mem: 3860.6->3880.6MB | peak: 3900.6MB
[PROFILE] env_1_MPS: 0.1ms | mem: 3880.6->3893.9MB | peak: 3900.1MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 3893.9->3893.9MB | peak: 3893.9MB
[PROFILE] loss_derivs_1_MPS: 0.4ms | mem: 3893.9->3893.9MB | peak: 3894.0MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 3893.9->3900.1MB | peak: 3900.2MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 3900.1->3900.1MB | peak: 3900.1MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 3900.1->3926.3MB | peak: 3946.3MB
[PROFILE] env_1_MPS: 0.1ms | mem: 3926.3->3940.2MB | peak: 3946.4MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 3940.2->3940.2MB | peak: 3940.2MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 3940.2->3940.2MB | peak: 3940.2MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 3940.2->3946.4MB | peak: 3946.4MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 3946.4->3946.4MB | peak: 3946.4MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 3946.4->3972.6MB | peak: 3992.6MB
[PROFILE] env_1_MPS: 0.5ms | mem: 3972.6->3985.9MB | peak: 3992.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 3985.9->3985.9MB | peak: 3985.9MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 3985.9->3985.9MB | peak: 3985.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 3985.9->3992.1MB | peak: 3992.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 3992.1->3992.1MB | peak: 3992.1MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 3992.1->4018.3MB | peak: 4038.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 3998.3->4012.1MB | peak: 4018.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4012.1->4012.1MB | peak: 4012.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4012.1->4012.2MB | peak: 4012.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4012.2->4018.4MB | peak: 4018.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4018.4->4018.4MB | peak: 4018.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 4018.4->4044.5MB | peak: 4064.5MB
[PROFILE] env_1_MPS: 1.6ms | mem: 4024.5->4038.4MB | peak: 4044.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4038.4->4038.4MB | peak: 4038.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 4038.4->4038.4MB | peak: 4038.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4038.4->4044.6MB | peak: 4044.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4044.6->4044.6MB | peak: 4044.6MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 4044.6->4070.8MB | peak: 4090.8MB
[PROFILE] env_1_MPS: 1.1ms | mem: 4050.8->4060.2MB | peak: 4064.6MB
[PROFILE] forward_1_MPS: 0.7ms | mem: 4060.2->4060.2MB | peak: 4060.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4060.2->4060.2MB | peak: 4060.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4060.2->4064.6MB | peak: 4064.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4064.6->4064.6MB | peak: 4064.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 4064.6->4089.0MB | peak: 4109.0MB
[PROFILE] compute_H_b_1_MPS: 49.0ms | mem: 3880.6->4049.0MB | peak: 4109.0MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 4049.0->4049.0MB | peak: 4049.0MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 4049.0->4049.0MB | peak: 4049.0MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 4049.0->4069.0MB | peak: 4089.0MB
[PROFILE] env_0_MPS: 0.9ms | mem: 4069.0->4076.5MB | peak: 4093.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4076.5->4076.5MB | peak: 4076.5MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 4076.5->4076.5MB | peak: 4076.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4076.5->4077.0MB | peak: 4077.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4077.0->4077.0MB | peak: 4077.0MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 4077.0->4077.7MB | peak: 4078.2MB
[PROFILE] env_0_MPS: 1.1ms | mem: 4077.7->4085.3MB | peak: 4101.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4085.3->4085.3MB | peak: 4085.3MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 4085.3->4085.3MB | peak: 4085.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4085.3->4085.9MB | peak: 4085.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4085.9->4085.9MB | peak: 4085.9MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 4085.9->4086.5MB | peak: 4087.0MB
[PROFILE] env_0_MPS: 1.0ms | mem: 4086.5->4094.1MB | peak: 4110.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4094.1->4094.1MB | peak: 4094.2MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 4094.1->4094.2MB | peak: 4094.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4094.2->4094.7MB | peak: 4094.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4094.7->4094.7MB | peak: 4094.7MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 4094.7->4095.3MB | peak: 4095.8MB
[PROFILE] env_0_MPS: 1.3ms | mem: 4095.2->4102.8MB | peak: 4119.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4102.8->4102.8MB | peak: 4102.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 4102.8->4102.9MB | peak: 4102.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4102.9->4103.4MB | peak: 4103.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4103.4->4103.4MB | peak: 4103.4MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 4103.4->4104.0MB | peak: 4104.5MB
[PROFILE] env_0_MPS: 1.1ms | mem: 4103.9->4111.5MB | peak: 4128.1MB
[PROFILE] forward_0_MPS: 0.7ms | mem: 4111.5->4111.5MB | peak: 4111.5MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 4111.5->4111.5MB | peak: 4111.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4111.5->4112.0MB | peak: 4112.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4112.0->4112.0MB | peak: 4112.0MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 4112.0->4112.7MB | peak: 4113.2MB
[PROFILE] env_0_MPS: 1.0ms | mem: 4112.6->4118.4MB | peak: 4130.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4118.4->4118.4MB | peak: 4118.4MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 4118.4->4118.4MB | peak: 4118.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4118.4->4118.8MB | peak: 4118.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4118.8->4118.8MB | peak: 4118.8MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 4118.8->4119.3MB | peak: 4119.6MB
[PROFILE] compute_H_b_0_MPS: 34.3ms | mem: 4069.0->4119.0MB | peak: 4119.6MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 4119.0->4119.0MB | peak: 4119.0MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 4119.0->4119.0MB | peak: 4119.0MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 4119.0->4119.1MB | peak: 4119.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4119.1->4132.5MB | peak: 4138.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4132.5->4132.5MB | peak: 4132.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4132.5->4132.5MB | peak: 4132.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4132.5->4138.7MB | peak: 4138.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4138.7->4138.7MB | peak: 4138.7MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 4138.7->4164.9MB | peak: 4184.9MB
[PROFILE] env_1_MPS: 1.6ms | mem: 4164.9->4178.7MB | peak: 4184.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4178.7->4178.7MB | peak: 4178.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 4178.7->4178.7MB | peak: 4178.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4178.7->4184.9MB | peak: 4184.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4184.9->4184.9MB | peak: 4184.9MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 4184.9->4211.1MB | peak: 4231.1MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4211.1->4224.4MB | peak: 4230.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4224.4->4224.5MB | peak: 4224.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4224.5->4224.5MB | peak: 4224.5MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 4224.5->4230.7MB | peak: 4230.7MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 4230.7->4230.7MB | peak: 4230.7MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 4230.7->4256.8MB | peak: 4276.8MB
[PROFILE] env_1_MPS: 2.2ms | mem: 4236.8->4250.7MB | peak: 4256.9MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 4250.7->4250.7MB | peak: 4250.7MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 4250.7->4250.7MB | peak: 4250.7MB
[PROFILE] grad_contract_1_MPS: 2.5ms | mem: 4250.7->4256.9MB | peak: 4256.9MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 4256.9->4256.9MB | peak: 4256.9MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 4256.9->4283.1MB | peak: 4303.1MB
[PROFILE] env_1_MPS: 2.5ms | mem: 4263.1->4276.9MB | peak: 4283.1MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 4276.9->4276.9MB | peak: 4276.9MB
[PROFILE] loss_derivs_1_MPS: 2.5ms | mem: 4276.9->4276.9MB | peak: 4276.9MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 4276.9->4283.1MB | peak: 4283.1MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 4283.1->4283.1MB | peak: 4283.1MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 4283.1->4309.3MB | peak: 4329.3MB
[PROFILE] env_1_MPS: 1.0ms | mem: 4289.3->4298.8MB | peak: 4303.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4298.8->4298.8MB | peak: 4298.8MB
[PROFILE] loss_derivs_1_MPS: 1.2ms | mem: 4298.8->4298.8MB | peak: 4298.8MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 4298.8->4303.2MB | peak: 4303.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4303.2->4303.2MB | peak: 4303.2MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 4303.2->4328.2MB | peak: 4348.2MB
[PROFILE] compute_H_b_1_MPS: 59.3ms | mem: 4119.1->4288.2MB | peak: 4348.2MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 4288.2->4288.2MB | peak: 4288.2MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 4288.2->4288.2MB | peak: 4288.2MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 4288.2->4308.2MB | peak: 4328.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 4308.2->4321.6MB | peak: 4327.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4321.6->4321.7MB | peak: 4321.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 4321.7->4321.7MB | peak: 4321.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4321.7->4327.9MB | peak: 4327.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4327.9->4327.9MB | peak: 4327.9MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 4327.9->4354.0MB | peak: 4374.0MB
[PROFILE] env_2_MPS: 1.1ms | mem: 4354.0->4368.0MB | peak: 4374.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4368.0->4368.0MB | peak: 4368.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 4368.0->4368.0MB | peak: 4368.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4368.0->4374.2MB | peak: 4374.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4374.2->4374.2MB | peak: 4374.2MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 4374.2->4400.4MB | peak: 4420.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 4400.4->4413.8MB | peak: 4420.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4413.8->4413.8MB | peak: 4413.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 4413.8->4413.9MB | peak: 4413.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4413.9->4420.1MB | peak: 4420.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4420.1->4420.1MB | peak: 4420.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 4420.1->4446.2MB | peak: 4466.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 4426.2->4440.2MB | peak: 4446.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4440.2->4440.2MB | peak: 4440.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 4440.2->4440.2MB | peak: 4440.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4440.2->4446.4MB | peak: 4446.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4446.4->4446.4MB | peak: 4446.4MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 4446.4->4472.6MB | peak: 4492.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 4452.6->4466.5MB | peak: 4472.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4466.5->4466.5MB | peak: 4466.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 4466.5->4466.5MB | peak: 4466.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4466.5->4472.7MB | peak: 4472.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4472.7->4472.7MB | peak: 4472.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 4472.7->4498.9MB | peak: 4518.9MB
[PROFILE] env_2_MPS: 1.1ms | mem: 4478.9->4488.5MB | peak: 4493.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4488.5->4488.5MB | peak: 4488.5MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 4488.5->4488.5MB | peak: 4488.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4488.5->4492.9MB | peak: 4492.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4492.9->4492.9MB | peak: 4492.9MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 4492.9->4517.3MB | peak: 4537.3MB
[PROFILE] compute_H_b_2_MPS: 37.3ms | mem: 4308.2->4477.3MB | peak: 4537.3MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 4477.3->4477.3MB | peak: 4477.3MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 4477.3->4477.3MB | peak: 4477.3MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 4477.3->4497.3MB | peak: 4517.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 4497.3->4500.3MB | peak: 4517.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 4500.3->4500.8MB | peak: 4500.8MB
[PROFILE] loss_derivs_3_MPS: 1.1ms | mem: 4500.8->4500.8MB | peak: 4500.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 4500.8->4501.4MB | peak: 4501.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 4501.4->4501.4MB | peak: 4501.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 4501.4->4502.5MB | peak: 4503.0MB
[PROFILE] env_3_MPS: 1.2ms | mem: 4502.0->4505.0MB | peak: 4522.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 4505.0->4505.5MB | peak: 4505.5MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 4505.5->4505.6MB | peak: 4505.6MB
[PROFILE] grad_contract_3_MPS: 0.7ms | mem: 4505.6->4506.1MB | peak: 4506.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 4506.1->4506.1MB | peak: 4506.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 4506.1->4507.2MB | peak: 4507.7MB
[PROFILE] env_3_MPS: 1.2ms | mem: 4506.7->4509.7MB | peak: 4526.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 4509.7->4510.3MB | peak: 4510.3MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 4510.3->4510.3MB | peak: 4510.3MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 4510.3->4510.8MB | peak: 4510.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 4510.8->4510.8MB | peak: 4510.8MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 4510.8->4511.9MB | peak: 4512.5MB
[PROFILE] env_3_MPS: 1.2ms | mem: 4511.3->4514.3MB | peak: 4531.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 4514.3->4514.8MB | peak: 4514.8MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 4514.8->4514.8MB | peak: 4514.9MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 4514.8->4515.4MB | peak: 4515.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 4515.4->4515.4MB | peak: 4515.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 4515.4->4516.5MB | peak: 4517.0MB
[PROFILE] env_3_MPS: 1.2ms | mem: 4515.9->4518.9MB | peak: 4535.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 4518.9->4519.4MB | peak: 4519.4MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 4519.4->4519.4MB | peak: 4519.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 4519.4->4519.9MB | peak: 4519.9MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 4519.9->4519.9MB | peak: 4519.9MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 4519.9->4521.1MB | peak: 4521.6MB
[PROFILE] env_3_MPS: 1.0ms | mem: 4520.5->4523.1MB | peak: 4535.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 4523.1->4523.4MB | peak: 4523.4MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 4523.4->4523.4MB | peak: 4523.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 4523.4->4523.8MB | peak: 4523.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 4523.8->4523.8MB | peak: 4523.8MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 4523.8->4524.7MB | peak: 4525.0MB
[PROFILE] compute_H_b_3_MPS: 35.9ms | mem: 4497.3->4524.0MB | peak: 4525.0MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 4524.0->4524.0MB | peak: 4524.0MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 4524.0->4524.0MB | peak: 4524.0MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 4524.0->4524.2MB | peak: 4524.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 4524.2->4537.6MB | peak: 4543.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4537.6->4537.6MB | peak: 4537.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 4537.6->4537.6MB | peak: 4537.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4537.6->4543.8MB | peak: 4543.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4543.8->4543.8MB | peak: 4543.8MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 4543.8->4570.0MB | peak: 4590.0MB
[PROFILE] env_2_MPS: 1.4ms | mem: 4570.0->4584.0MB | peak: 4590.2MB
[PROFILE] forward_2_MPS: 1.8ms | mem: 4584.0->4584.0MB | peak: 4584.0MB
[PROFILE] loss_derivs_2_MPS: 2.8ms | mem: 4584.0->4584.0MB | peak: 4584.0MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 4584.0->4590.2MB | peak: 4590.2MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 4590.2->4590.2MB | peak: 4590.2MB
[PROFILE] hess_contract_2_MPS: 2.7ms | mem: 4590.2->4616.4MB | peak: 4636.4MB
[PROFILE] env_2_MPS: 0.1ms | mem: 4616.4->4629.8MB | peak: 4636.0MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 4629.8->4629.8MB | peak: 4629.8MB
[PROFILE] loss_derivs_2_MPS: 2.8ms | mem: 4629.8->4629.8MB | peak: 4629.8MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 4629.8->4636.0MB | peak: 4636.0MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 4636.0->4636.0MB | peak: 4636.0MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 4636.0->4662.2MB | peak: 4682.2MB
[PROFILE] env_2_MPS: 0.1ms | mem: 4642.2->4656.2MB | peak: 4662.3MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 4656.2->4656.2MB | peak: 4656.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 4656.2->4656.2MB | peak: 4656.2MB
[PROFILE] grad_contract_2_MPS: 0.5ms | mem: 4656.2->4662.4MB | peak: 4662.4MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 4662.4->4662.4MB | peak: 4662.4MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 4662.4->4688.6MB | peak: 4708.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 4668.5->4682.5MB | peak: 4688.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4682.5->4682.5MB | peak: 4682.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 4682.5->4682.5MB | peak: 4682.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4682.5->4688.7MB | peak: 4688.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4688.7->4688.7MB | peak: 4688.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 4688.7->4714.9MB | peak: 4734.9MB
[PROFILE] env_2_MPS: 1.4ms | mem: 4694.9->4704.5MB | peak: 4709.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 4704.5->4704.5MB | peak: 4704.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 4704.5->4704.5MB | peak: 4704.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 4704.5->4708.9MB | peak: 4708.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 4708.9->4708.9MB | peak: 4708.9MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 4708.9->4733.2MB | peak: 4753.2MB
[PROFILE] compute_H_b_2_MPS: 60.1ms | mem: 4524.2->4693.2MB | peak: 4753.2MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 4693.2->4693.2MB | peak: 4693.2MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 4693.2->4693.2MB | peak: 4693.2MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 4693.2->4713.3MB | peak: 4733.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4713.2->4726.6MB | peak: 4732.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4726.6->4726.6MB | peak: 4726.6MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 4726.6->4726.6MB | peak: 4726.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4726.6->4732.8MB | peak: 4732.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4732.8->4732.8MB | peak: 4732.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 4732.8->4759.0MB | peak: 4779.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4759.0->4772.8MB | peak: 4779.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4772.8->4772.8MB | peak: 4772.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4772.8->4772.8MB | peak: 4772.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4772.8->4779.0MB | peak: 4779.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4779.0->4779.0MB | peak: 4779.0MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 4779.0->4805.2MB | peak: 4825.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4805.2->4818.6MB | peak: 4824.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4818.6->4818.6MB | peak: 4818.6MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 4818.6->4818.6MB | peak: 4818.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4818.6->4824.8MB | peak: 4824.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4824.8->4824.8MB | peak: 4824.8MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 4824.8->4851.0MB | peak: 4871.0MB
[PROFILE] env_1_MPS: 1.0ms | mem: 4830.9->4844.8MB | peak: 4851.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4844.8->4844.8MB | peak: 4844.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 4844.8->4844.8MB | peak: 4844.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4844.8->4851.0MB | peak: 4851.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4851.0->4851.0MB | peak: 4851.0MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 4851.0->4877.2MB | peak: 4897.2MB
[PROFILE] env_1_MPS: 1.6ms | mem: 4857.2->4871.0MB | peak: 4877.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 4871.0->4871.0MB | peak: 4871.0MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4871.0->4871.0MB | peak: 4871.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4871.0->4877.2MB | peak: 4877.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4877.2->4877.2MB | peak: 4877.2MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 4877.2->4903.4MB | peak: 4923.4MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4883.4->4892.9MB | peak: 4897.3MB
[PROFILE] forward_1_MPS: 0.7ms | mem: 4892.9->4892.9MB | peak: 4892.9MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 4892.9->4892.9MB | peak: 4892.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4892.9->4897.3MB | peak: 4897.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4897.3->4897.3MB | peak: 4897.3MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 4897.3->4921.7MB | peak: 4941.7MB
[PROFILE] compute_H_b_1_MPS: 36.9ms | mem: 4713.2->4881.6MB | peak: 4941.7MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 4881.6->4881.6MB | peak: 4881.6MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 4881.6->4881.6MB | peak: 4881.6MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 4881.6->4901.7MB | peak: 4921.7MB
[PROFILE] env_0_MPS: 0.9ms | mem: 4901.7->4909.1MB | peak: 4925.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4909.1->4909.1MB | peak: 4909.2MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 4909.1->4909.2MB | peak: 4909.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4909.2->4909.7MB | peak: 4909.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4909.7->4909.7MB | peak: 4909.7MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 4909.7->4910.3MB | peak: 4910.8MB
[PROFILE] env_0_MPS: 1.0ms | mem: 4910.3->4918.0MB | peak: 4934.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4918.0->4918.0MB | peak: 4918.0MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 4918.0->4918.0MB | peak: 4918.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4918.0->4918.5MB | peak: 4918.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4918.5->4918.5MB | peak: 4918.5MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 4918.5->4919.1MB | peak: 4919.7MB
[PROFILE] env_0_MPS: 1.1ms | mem: 4919.1->4926.8MB | peak: 4943.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4926.8->4926.8MB | peak: 4926.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 4926.8->4926.8MB | peak: 4926.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4926.8->4927.3MB | peak: 4927.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4927.3->4927.3MB | peak: 4927.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 4927.3->4928.0MB | peak: 4928.5MB
[PROFILE] env_0_MPS: 1.1ms | mem: 4927.8->4935.5MB | peak: 4952.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 4935.5->4935.5MB | peak: 4935.5MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 4935.5->4935.5MB | peak: 4935.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 4935.5->4936.0MB | peak: 4936.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 4936.0->4936.0MB | peak: 4936.0MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 4936.0->4936.6MB | peak: 4937.2MB
[PROFILE] env_0_MPS: 1.2ms | mem: 4936.5->4944.1MB | peak: 4960.7MB
[PROFILE] forward_0_MPS: 1.7ms | mem: 4944.1->4944.2MB | peak: 4944.2MB
[PROFILE] loss_derivs_0_MPS: 2.5ms | mem: 4944.2->4944.2MB | peak: 4944.2MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 4944.2->4944.7MB | peak: 4944.7MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 4944.7->4944.7MB | peak: 4944.7MB
[PROFILE] hess_contract_0_MPS: 2.5ms | mem: 4944.7->4945.3MB | peak: 4945.8MB
[PROFILE] env_0_MPS: 0.1ms | mem: 4945.2->4951.0MB | peak: 4962.8MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 4951.0->4951.0MB | peak: 4951.0MB
[PROFILE] loss_derivs_0_MPS: 2.8ms | mem: 4951.0->4951.0MB | peak: 4951.0MB
[PROFILE] grad_contract_0_MPS: 0.5ms | mem: 4951.0->4951.4MB | peak: 4951.4MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 4951.4->4951.4MB | peak: 4951.4MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 4951.4->4951.9MB | peak: 4952.3MB
[PROFILE] compute_H_b_0_MPS: 56.0ms | mem: 4901.7->4951.6MB | peak: 4952.3MB
[PROFILE] fuse_0_MPS: 0.0ms | mem: 4951.6->4951.6MB | peak: 4951.6MB
[PROFILE] to_dense_0_MPS: 0.0ms | mem: 4951.6->4951.6MB | peak: 4951.6MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 4951.6->4951.8MB | peak: 4951.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 4951.8->4965.1MB | peak: 4971.3MB
[PROFILE] forward_1_MPS: 0.4ms | mem: 4965.1->4965.1MB | peak: 4965.1MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 4965.1->4965.1MB | peak: 4965.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 4965.1->4971.3MB | peak: 4971.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 4971.3->4971.3MB | peak: 4971.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 4971.3->4997.5MB | peak: 5017.5MB
[PROFILE] env_1_MPS: 1.1ms | mem: 4997.5->5011.3MB | peak: 5017.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5011.3->5011.3MB | peak: 5011.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5011.3->5011.4MB | peak: 5011.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5011.4->5017.6MB | peak: 5017.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5017.6->5017.6MB | peak: 5017.6MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 5017.6->5043.7MB | peak: 5063.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5043.7->5057.1MB | peak: 5063.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5057.1->5057.1MB | peak: 5057.1MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 5057.1->5057.1MB | peak: 5057.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5057.1->5063.3MB | peak: 5063.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5063.3->5063.3MB | peak: 5063.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5063.3->5089.5MB | peak: 5109.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5069.5->5083.3MB | peak: 5089.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5083.3->5083.3MB | peak: 5083.3MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5083.3->5083.3MB | peak: 5083.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5083.3->5089.5MB | peak: 5089.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5089.5->5089.5MB | peak: 5089.5MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 5089.5->5115.7MB | peak: 5135.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5095.7->5109.5MB | peak: 5115.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5109.5->5109.5MB | peak: 5109.6MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5109.5->5109.6MB | peak: 5109.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5109.6->5115.8MB | peak: 5115.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5115.8->5115.8MB | peak: 5115.8MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5115.8->5141.9MB | peak: 5161.9MB
[PROFILE] env_1_MPS: 1.1ms | mem: 5121.9->5131.4MB | peak: 5135.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5131.4->5131.4MB | peak: 5131.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5131.4->5131.4MB | peak: 5131.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5131.4->5135.8MB | peak: 5135.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5135.8->5135.8MB | peak: 5135.8MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 5135.8->5160.8MB | peak: 5180.8MB
[PROFILE] compute_H_b_1_MPS: 37.7ms | mem: 4951.8->5120.8MB | peak: 5180.8MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 5120.8->5120.8MB | peak: 5120.8MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 5120.8->5120.8MB | peak: 5120.8MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 5120.8->5140.8MB | peak: 5160.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5140.8->5154.3MB | peak: 5160.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5154.3->5154.3MB | peak: 5154.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 5154.3->5154.3MB | peak: 5154.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5154.3->5160.5MB | peak: 5160.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5160.5->5160.5MB | peak: 5160.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 5160.5->5186.7MB | peak: 5206.7MB
[PROFILE] env_2_MPS: 1.3ms | mem: 5186.7->5200.6MB | peak: 5206.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5200.6->5200.6MB | peak: 5200.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 5200.6->5200.6MB | peak: 5200.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5200.6->5206.8MB | peak: 5206.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5206.8->5206.8MB | peak: 5206.8MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 5206.8->5233.0MB | peak: 5253.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5233.0->5246.5MB | peak: 5252.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5246.5->5246.5MB | peak: 5246.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 5246.5->5246.5MB | peak: 5246.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5246.5->5252.7MB | peak: 5252.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5252.7->5252.7MB | peak: 5252.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 5252.7->5278.9MB | peak: 5298.9MB
[PROFILE] env_2_MPS: 1.1ms | mem: 5258.9->5272.8MB | peak: 5279.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5272.8->5272.8MB | peak: 5272.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 5272.8->5272.8MB | peak: 5272.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5272.8->5279.0MB | peak: 5279.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5279.0->5279.0MB | peak: 5279.0MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 5279.0->5305.2MB | peak: 5325.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5285.2->5299.2MB | peak: 5305.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5299.2->5299.2MB | peak: 5299.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 5299.2->5299.2MB | peak: 5299.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5299.2->5305.4MB | peak: 5305.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5305.4->5305.4MB | peak: 5305.4MB
[PROFILE] hess_contract_2_MPS: 1.1ms | mem: 5305.4->5331.6MB | peak: 5351.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5311.6->5321.1MB | peak: 5325.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5321.1->5321.1MB | peak: 5321.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 5321.1->5321.1MB | peak: 5321.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5321.1->5325.5MB | peak: 5325.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5325.5->5325.5MB | peak: 5325.5MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 5325.5->5349.9MB | peak: 5369.9MB
[PROFILE] compute_H_b_2_MPS: 37.6ms | mem: 5140.8->5309.9MB | peak: 5369.9MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 5309.9->5309.9MB | peak: 5309.9MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 5309.9->5309.9MB | peak: 5309.9MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 5309.9->5329.9MB | peak: 5349.9MB
[PROFILE] env_3_MPS: 1.0ms | mem: 5329.9->5332.9MB | peak: 5349.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 5332.9->5333.5MB | peak: 5333.5MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 5333.5->5333.5MB | peak: 5333.5MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 5333.5->5334.0MB | peak: 5334.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 5334.0->5334.0MB | peak: 5334.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 5334.0->5335.1MB | peak: 5335.7MB
[PROFILE] env_3_MPS: 1.0ms | mem: 5334.6->5337.7MB | peak: 5354.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 5337.7->5338.2MB | peak: 5338.2MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 5338.2->5338.2MB | peak: 5338.2MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 5338.2->5338.7MB | peak: 5338.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 5338.7->5338.7MB | peak: 5338.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 5338.7->5339.9MB | peak: 5340.4MB
[PROFILE] env_3_MPS: 1.3ms | mem: 5339.3->5342.4MB | peak: 5359.3MB
[PROFILE] forward_3_MPS: 1.7ms | mem: 5342.4->5342.9MB | peak: 5342.9MB
[PROFILE] loss_derivs_3_MPS: 0.4ms | mem: 5342.9->5342.9MB | peak: 5342.9MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 5342.9->5343.4MB | peak: 5343.4MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 5343.4->5343.4MB | peak: 5343.4MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 5343.4->5344.6MB | peak: 5345.1MB
[PROFILE] env_3_MPS: 0.2ms | mem: 5343.9->5346.9MB | peak: 5363.9MB
[PROFILE] forward_3_MPS: 0.0ms | mem: 5346.9->5347.5MB | peak: 5347.5MB
[PROFILE] loss_derivs_3_MPS: 0.0ms | mem: 5347.5->5347.5MB | peak: 5347.5MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 5347.5->5348.0MB | peak: 5348.0MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 5348.0->5348.0MB | peak: 5348.0MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 5348.0->5349.2MB | peak: 5349.7MB
[PROFILE] env_3_MPS: 3.1ms | mem: 5348.5->5351.5MB | peak: 5368.5MB
[PROFILE] forward_3_MPS: 0.0ms | mem: 5351.5->5352.0MB | peak: 5352.1MB
[PROFILE] loss_derivs_3_MPS: 0.0ms | mem: 5352.0->5352.1MB | peak: 5352.1MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 5352.1->5352.6MB | peak: 5352.6MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 5352.6->5352.6MB | peak: 5352.6MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 5352.6->5353.7MB | peak: 5354.3MB
[PROFILE] env_3_MPS: 1.0ms | mem: 5353.1->5355.7MB | peak: 5368.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 5355.7->5356.1MB | peak: 5356.1MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 5356.1->5356.1MB | peak: 5356.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 5356.1->5356.4MB | peak: 5356.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 5356.4->5356.4MB | peak: 5356.4MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 5356.4->5357.3MB | peak: 5357.7MB
[PROFILE] compute_H_b_3_MPS: 55.9ms | mem: 5329.9->5356.7MB | peak: 5357.7MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 5356.7->5356.7MB | peak: 5356.7MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 5356.7->5356.7MB | peak: 5356.7MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 5356.7->5356.8MB | peak: 5356.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5356.8->5370.2MB | peak: 5376.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5370.2->5370.2MB | peak: 5370.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 5370.2->5370.2MB | peak: 5370.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5370.2->5376.4MB | peak: 5376.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5376.4->5376.4MB | peak: 5376.4MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 5376.4->5402.6MB | peak: 5422.6MB
[PROFILE] env_2_MPS: 1.3ms | mem: 5402.6->5416.6MB | peak: 5422.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5416.6->5416.6MB | peak: 5416.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 5416.6->5416.6MB | peak: 5416.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5416.6->5422.8MB | peak: 5422.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5422.8->5422.8MB | peak: 5422.8MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 5422.8->5449.0MB | peak: 5469.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5449.0->5462.4MB | peak: 5468.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5462.4->5462.4MB | peak: 5462.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 5462.4->5462.4MB | peak: 5462.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5462.4->5468.6MB | peak: 5468.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5468.6->5468.6MB | peak: 5468.6MB
[PROFILE] hess_contract_2_MPS: 1.2ms | mem: 5468.6->5494.8MB | peak: 5514.8MB
[PROFILE] env_2_MPS: 1.0ms | mem: 5474.8->5488.8MB | peak: 5495.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5488.8->5488.8MB | peak: 5488.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 5488.8->5488.8MB | peak: 5488.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5488.8->5495.0MB | peak: 5495.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5495.0->5495.0MB | peak: 5495.0MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 5495.0->5521.2MB | peak: 5541.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 5501.2->5515.1MB | peak: 5521.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5515.1->5515.1MB | peak: 5515.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 5515.1->5515.1MB | peak: 5515.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5515.1->5521.3MB | peak: 5521.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5521.3->5521.3MB | peak: 5521.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 5521.3->5547.5MB | peak: 5567.5MB
[PROFILE] env_2_MPS: 1.1ms | mem: 5527.5->5537.1MB | peak: 5541.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5537.1->5537.1MB | peak: 5537.1MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 5537.1->5537.1MB | peak: 5537.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5537.1->5541.5MB | peak: 5541.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5541.5->5541.5MB | peak: 5541.5MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 5541.5->5565.9MB | peak: 5585.9MB
[PROFILE] compute_H_b_2_MPS: 37.1ms | mem: 5356.8->5525.9MB | peak: 5585.9MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 5525.9->5525.9MB | peak: 5525.9MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 5525.9->5525.9MB | peak: 5525.9MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 5525.9->5545.9MB | peak: 5565.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5545.9->5559.2MB | peak: 5565.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5559.2->5559.2MB | peak: 5559.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 5559.2->5559.2MB | peak: 5559.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5559.2->5565.4MB | peak: 5565.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5565.4->5565.4MB | peak: 5565.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 5565.4->5591.6MB | peak: 5611.6MB
[PROFILE] env_1_MPS: 1.3ms | mem: 5591.6->5605.5MB | peak: 5611.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5605.5->5605.5MB | peak: 5605.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5605.5->5605.5MB | peak: 5605.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5605.5->5611.7MB | peak: 5611.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5611.7->5611.7MB | peak: 5611.7MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 5611.7->5637.9MB | peak: 5657.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5637.9->5651.2MB | peak: 5657.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5651.2->5651.2MB | peak: 5651.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5651.2->5651.2MB | peak: 5651.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5651.2->5657.4MB | peak: 5657.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5657.4->5657.4MB | peak: 5657.4MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5657.4->5683.6MB | peak: 5703.6MB
[PROFILE] env_1_MPS: 1.6ms | mem: 5663.6->5677.4MB | peak: 5683.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5677.4->5677.4MB | peak: 5677.4MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 5677.4->5677.4MB | peak: 5677.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5677.4->5683.6MB | peak: 5683.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5683.6->5683.6MB | peak: 5683.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 5683.6->5709.8MB | peak: 5729.8MB
[PROFILE] env_1_MPS: 1.1ms | mem: 5689.8->5703.6MB | peak: 5709.8MB
[PROFILE] forward_1_MPS: 0.7ms | mem: 5703.6->5703.7MB | peak: 5703.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5703.7->5703.7MB | peak: 5703.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5703.7->5709.9MB | peak: 5709.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5709.9->5709.9MB | peak: 5709.9MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5709.9->5736.0MB | peak: 5756.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5716.0->5725.5MB | peak: 5729.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5725.5->5725.5MB | peak: 5725.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5725.5->5725.5MB | peak: 5725.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5725.5->5729.9MB | peak: 5729.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5729.9->5729.9MB | peak: 5729.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 5729.9->5754.3MB | peak: 5774.3MB
[PROFILE] compute_H_b_1_MPS: 37.1ms | mem: 5545.9->5714.3MB | peak: 5774.3MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 5714.3->5714.3MB | peak: 5714.3MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 5714.3->5714.3MB | peak: 5714.3MB
[PROFILE] solve_1_MPS: 1.7ms | mem: 5714.3->5734.3MB | peak: 5754.3MB
[PROFILE] env_0_MPS: 2.2ms | mem: 5734.3->5741.8MB | peak: 5758.3MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 5741.8->5741.8MB | peak: 5741.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 5741.8->5741.8MB | peak: 5741.8MB
[PROFILE] grad_contract_0_MPS: 1.2ms | mem: 5741.8->5742.3MB | peak: 5742.3MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 5742.3->5742.3MB | peak: 5742.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 5742.3->5743.0MB | peak: 5743.5MB
[PROFILE] env_0_MPS: 1.4ms | mem: 5743.0->5750.6MB | peak: 5767.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 5750.6->5750.6MB | peak: 5750.6MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 5750.6->5750.6MB | peak: 5750.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 5750.6->5751.1MB | peak: 5751.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 5751.1->5751.1MB | peak: 5751.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 5751.1->5751.8MB | peak: 5752.3MB
[PROFILE] env_0_MPS: 1.1ms | mem: 5751.8->5759.4MB | peak: 5776.0MB
[PROFILE] forward_0_MPS: 0.7ms | mem: 5759.4->5759.4MB | peak: 5759.4MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 5759.4->5759.4MB | peak: 5759.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 5759.4->5759.9MB | peak: 5759.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 5759.9->5759.9MB | peak: 5759.9MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 5759.9->5760.6MB | peak: 5761.1MB
[PROFILE] env_0_MPS: 1.1ms | mem: 5760.4->5768.1MB | peak: 5784.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 5768.1->5768.1MB | peak: 5768.1MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 5768.1->5768.1MB | peak: 5768.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 5768.1->5768.6MB | peak: 5768.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 5768.6->5768.6MB | peak: 5768.6MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 5768.6->5769.3MB | peak: 5769.8MB
[PROFILE] env_0_MPS: 1.0ms | mem: 5769.1->5776.8MB | peak: 5793.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 5776.8->5776.8MB | peak: 5776.8MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 5776.8->5776.8MB | peak: 5776.8MB
[PROFILE] grad_contract_0_MPS: 0.7ms | mem: 5776.8->5777.3MB | peak: 5777.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 5777.3->5777.3MB | peak: 5777.3MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 5777.3->5778.0MB | peak: 5778.5MB
[PROFILE] env_0_MPS: 1.0ms | mem: 5777.8->5783.7MB | peak: 5795.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 5783.7->5783.7MB | peak: 5783.7MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 5783.7->5783.7MB | peak: 5783.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 5783.7->5784.0MB | peak: 5784.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 5784.0->5784.0MB | peak: 5784.0MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 5784.0->5784.5MB | peak: 5784.9MB
[PROFILE] compute_H_b_0_MPS: 37.5ms | mem: 5734.3->5784.3MB | peak: 5784.9MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 5784.3->5784.3MB | peak: 5784.3MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 5784.3->5784.3MB | peak: 5784.3MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 5784.3->5784.4MB | peak: 5784.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5784.4->5797.7MB | peak: 5803.9MB
[PROFILE] forward_1_MPS: 0.7ms | mem: 5797.7->5797.7MB | peak: 5797.7MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5797.7->5797.7MB | peak: 5797.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5797.7->5803.9MB | peak: 5804.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5803.9->5803.9MB | peak: 5803.9MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5803.9->5830.1MB | peak: 5850.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 5830.1->5844.0MB | peak: 5850.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5844.0->5844.0MB | peak: 5844.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5844.0->5844.0MB | peak: 5844.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5844.0->5850.2MB | peak: 5850.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5850.2->5850.2MB | peak: 5850.2MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 5850.2->5876.4MB | peak: 5896.4MB
[PROFILE] env_1_MPS: 1.3ms | mem: 5876.4->5889.7MB | peak: 5895.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5889.7->5889.7MB | peak: 5889.7MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5889.7->5889.7MB | peak: 5889.7MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 5889.7->5895.9MB | peak: 5895.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5895.9->5895.9MB | peak: 5895.9MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5895.9->5922.1MB | peak: 5942.1MB
[PROFILE] env_1_MPS: 1.3ms | mem: 5902.1->5915.9MB | peak: 5922.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5915.9->5915.9MB | peak: 5915.9MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5915.9->5915.9MB | peak: 5916.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5915.9->5922.1MB | peak: 5922.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5922.1->5922.1MB | peak: 5922.1MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 5922.1->5948.3MB | peak: 5968.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 5928.3->5942.2MB | peak: 5948.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5942.2->5942.2MB | peak: 5942.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 5942.2->5942.2MB | peak: 5942.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5942.2->5948.4MB | peak: 5948.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5948.4->5948.4MB | peak: 5948.4MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 5948.4->5974.6MB | peak: 5994.6MB
[PROFILE] env_1_MPS: 1.1ms | mem: 5954.6->5964.0MB | peak: 5968.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 5964.0->5964.0MB | peak: 5964.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 5964.0->5964.0MB | peak: 5964.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 5964.0->5968.4MB | peak: 5968.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 5968.4->5968.4MB | peak: 5968.4MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 5968.4->5993.5MB | peak: 6013.5MB
[PROFILE] compute_H_b_1_MPS: 37.6ms | mem: 5784.4->5953.4MB | peak: 6013.5MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 5953.4->5953.4MB | peak: 5953.4MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 5953.4->5953.4MB | peak: 5953.4MB
[PROFILE] solve_1_MPS: 1.7ms | mem: 5953.4->5973.5MB | peak: 5993.5MB
[PROFILE] env_2_MPS: 1.3ms | mem: 5973.5->5986.9MB | peak: 5993.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 5986.9->5986.9MB | peak: 5986.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 5986.9->5986.9MB | peak: 5986.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 5986.9->5993.1MB | peak: 5993.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 5993.1->5993.1MB | peak: 5993.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 5993.1->6019.3MB | peak: 6039.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6019.3->6033.3MB | peak: 6039.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6033.3->6033.3MB | peak: 6033.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 6033.3->6033.3MB | peak: 6033.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6033.3->6039.5MB | peak: 6039.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6039.5->6039.5MB | peak: 6039.5MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 6039.5->6065.7MB | peak: 6085.7MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6065.7->6079.1MB | peak: 6085.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6079.1->6079.1MB | peak: 6079.1MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 6079.1->6079.1MB | peak: 6079.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6079.1->6085.3MB | peak: 6085.3MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 6085.3->6085.3MB | peak: 6085.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6085.3->6111.5MB | peak: 6131.5MB
[PROFILE] env_2_MPS: 2.7ms | mem: 6091.5->6105.4MB | peak: 6111.6MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 6105.4->6105.5MB | peak: 6105.5MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 6105.5->6105.5MB | peak: 6105.5MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 6105.5->6111.7MB | peak: 6111.7MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 6111.7->6111.7MB | peak: 6111.7MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 6111.7->6137.8MB | peak: 6157.8MB
[PROFILE] env_2_MPS: 0.2ms | mem: 6117.8->6131.8MB | peak: 6138.0MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 6131.8->6131.8MB | peak: 6131.8MB
[PROFILE] loss_derivs_2_MPS: 2.9ms | mem: 6131.8->6131.8MB | peak: 6131.8MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 6131.8->6138.0MB | peak: 6138.0MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 6138.0->6138.0MB | peak: 6138.0MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 6138.0->6164.2MB | peak: 6184.2MB
[PROFILE] env_2_MPS: 0.1ms | mem: 6144.2->6153.7MB | peak: 6158.5MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 6153.7->6153.8MB | peak: 6153.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 6153.8->6153.8MB | peak: 6153.8MB
[PROFILE] grad_contract_2_MPS: 1.3ms | mem: 6153.8->6158.2MB | peak: 6158.2MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 6158.2->6158.2MB | peak: 6158.2MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 6158.2->6182.5MB | peak: 6202.5MB
[PROFILE] compute_H_b_2_MPS: 62.9ms | mem: 5973.5->6142.5MB | peak: 6202.5MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 6142.5->6142.5MB | peak: 6142.5MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 6142.5->6142.5MB | peak: 6142.5MB
[PROFILE] solve_2_MPS: 1.7ms | mem: 6142.5->6162.6MB | peak: 6182.6MB
[PROFILE] env_3_MPS: 1.0ms | mem: 6162.5->6165.6MB | peak: 6182.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6165.6->6166.1MB | peak: 6166.1MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 6166.1->6166.1MB | peak: 6166.1MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 6166.1->6166.6MB | peak: 6166.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 6166.6->6166.6MB | peak: 6166.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 6166.6->6167.8MB | peak: 6168.3MB
[PROFILE] env_3_MPS: 1.0ms | mem: 6167.3->6170.3MB | peak: 6187.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6170.3->6170.8MB | peak: 6170.8MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 6170.8->6170.8MB | peak: 6170.8MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 6170.8->6171.3MB | peak: 6171.3MB
[PROFILE] hess_tn_build_3_MPS: 0.5ms | mem: 6171.3->6171.3MB | peak: 6171.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 6171.3->6172.5MB | peak: 6173.0MB
[PROFILE] env_3_MPS: 1.0ms | mem: 6172.0->6175.0MB | peak: 6192.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6175.0->6175.5MB | peak: 6175.5MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 6175.5->6175.5MB | peak: 6175.5MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 6175.5->6176.0MB | peak: 6176.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 6176.0->6176.0MB | peak: 6176.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 6176.0->6177.2MB | peak: 6177.7MB
[PROFILE] env_3_MPS: 1.0ms | mem: 6176.6->6179.6MB | peak: 6196.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6179.6->6180.1MB | peak: 6180.1MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 6180.1->6180.1MB | peak: 6180.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 6180.1->6180.6MB | peak: 6180.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 6180.6->6180.6MB | peak: 6180.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 6180.6->6181.8MB | peak: 6182.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 6181.1->6184.2MB | peak: 6201.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6184.2->6184.7MB | peak: 6184.7MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 6184.7->6184.7MB | peak: 6184.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 6184.7->6185.2MB | peak: 6185.2MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 6185.2->6185.2MB | peak: 6185.2MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 6185.2->6186.4MB | peak: 6186.9MB
[PROFILE] env_3_MPS: 1.0ms | mem: 6185.7->6188.3MB | peak: 6200.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6188.3->6188.7MB | peak: 6188.7MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 6188.7->6188.7MB | peak: 6188.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 6188.7->6189.1MB | peak: 6189.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 6189.1->6189.1MB | peak: 6189.1MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 6189.1->6189.9MB | peak: 6190.3MB
[PROFILE] compute_H_b_3_MPS: 35.7ms | mem: 6162.5->6189.3MB | peak: 6190.3MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 6189.3->6189.3MB | peak: 6189.3MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 6189.3->6189.3MB | peak: 6189.3MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 6189.3->6189.4MB | peak: 6189.6MB
[PROFILE] env_2_MPS: 1.4ms | mem: 6189.4->6202.9MB | peak: 6209.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6202.9->6202.9MB | peak: 6202.9MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 6202.9->6202.9MB | peak: 6202.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6202.9->6209.1MB | peak: 6209.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6209.1->6209.1MB | peak: 6209.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6209.1->6235.3MB | peak: 6255.3MB
[PROFILE] env_2_MPS: 1.1ms | mem: 6235.3->6249.2MB | peak: 6255.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6249.2->6249.2MB | peak: 6249.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6249.2->6249.2MB | peak: 6249.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6249.2->6255.4MB | peak: 6255.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6255.4->6255.4MB | peak: 6255.4MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 6255.4->6281.6MB | peak: 6301.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6281.6->6295.1MB | peak: 6301.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6295.1->6295.1MB | peak: 6295.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6295.1->6295.1MB | peak: 6295.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6295.1->6301.3MB | peak: 6301.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6301.3->6301.3MB | peak: 6301.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6301.3->6327.5MB | peak: 6347.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6307.5->6321.4MB | peak: 6327.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6321.4->6321.4MB | peak: 6321.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 6321.4->6321.4MB | peak: 6321.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6321.4->6327.6MB | peak: 6327.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6327.6->6327.6MB | peak: 6327.6MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 6327.6->6353.8MB | peak: 6373.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6333.8->6347.8MB | peak: 6353.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6347.8->6347.8MB | peak: 6347.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6347.8->6347.8MB | peak: 6347.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6347.8->6354.0MB | peak: 6354.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6354.0->6354.0MB | peak: 6354.0MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6354.0->6380.2MB | peak: 6400.2MB
[PROFILE] env_2_MPS: 1.1ms | mem: 6360.1->6369.7MB | peak: 6374.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6369.7->6369.7MB | peak: 6369.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6369.7->6369.7MB | peak: 6369.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6369.7->6374.1MB | peak: 6374.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6374.1->6374.1MB | peak: 6374.1MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 6374.1->6398.5MB | peak: 6418.5MB
[PROFILE] compute_H_b_2_MPS: 37.3ms | mem: 6189.4->6358.5MB | peak: 6418.5MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 6358.5->6358.5MB | peak: 6358.5MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 6358.5->6358.5MB | peak: 6358.5MB
[PROFILE] solve_2_MPS: 1.7ms | mem: 6358.5->6378.5MB | peak: 6398.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 6378.5->6391.8MB | peak: 6398.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6391.8->6391.8MB | peak: 6391.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 6391.8->6391.8MB | peak: 6391.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 6391.8->6398.0MB | peak: 6398.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6398.0->6398.0MB | peak: 6398.0MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 6398.0->6424.2MB | peak: 6444.2MB
[PROFILE] env_1_MPS: 1.4ms | mem: 6424.2->6438.1MB | peak: 6444.3MB
[PROFILE] forward_1_MPS: 1.9ms | mem: 6438.1->6438.1MB | peak: 6438.1MB
[PROFILE] loss_derivs_1_MPS: 0.4ms | mem: 6438.1->6438.1MB | peak: 6438.1MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 6438.1->6444.3MB | peak: 6444.3MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 6444.3->6444.3MB | peak: 6444.3MB
[PROFILE] hess_contract_1_MPS: 0.3ms | mem: 6444.3->6470.5MB | peak: 6490.5MB
[PROFILE] env_1_MPS: 0.2ms | mem: 6470.5->6483.8MB | peak: 6490.0MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 6483.8->6483.8MB | peak: 6483.8MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 6483.8->6483.8MB | peak: 6483.8MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 6483.8->6490.0MB | peak: 6490.0MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 6490.0->6490.0MB | peak: 6490.0MB
[PROFILE] hess_contract_1_MPS: 0.3ms | mem: 6490.0->6516.2MB | peak: 6536.2MB
[PROFILE] env_1_MPS: 0.2ms | mem: 6496.2->6510.0MB | peak: 6516.2MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 6510.0->6510.0MB | peak: 6510.1MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 6510.0->6510.1MB | peak: 6510.1MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 6510.1->6516.3MB | peak: 6516.3MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 6516.3->6516.3MB | peak: 6516.3MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 6516.3->6542.4MB | peak: 6562.4MB
[PROFILE] env_1_MPS: 1.4ms | mem: 6522.4->6536.3MB | peak: 6542.5MB
[PROFILE] forward_1_MPS: 0.4ms | mem: 6536.3->6536.3MB | peak: 6536.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 6536.3->6536.3MB | peak: 6536.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 6536.3->6542.5MB | peak: 6542.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6542.5->6542.5MB | peak: 6542.5MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 6542.5->6568.7MB | peak: 6588.7MB
[PROFILE] env_1_MPS: 1.1ms | mem: 6548.7->6558.1MB | peak: 6562.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6558.1->6558.1MB | peak: 6558.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 6558.1->6558.1MB | peak: 6558.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 6558.1->6562.5MB | peak: 6562.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6562.5->6562.5MB | peak: 6562.5MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 6562.5->6586.9MB | peak: 6606.9MB
[PROFILE] compute_H_b_1_MPS: 61.3ms | mem: 6378.5->6546.9MB | peak: 6606.9MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 6546.9->6546.9MB | peak: 6546.9MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 6546.9->6546.9MB | peak: 6546.9MB
[PROFILE] solve_1_MPS: 1.7ms | mem: 6546.9->6566.9MB | peak: 6586.9MB
[PROFILE] env_0_MPS: 0.9ms | mem: 6566.9->6574.4MB | peak: 6590.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 6574.4->6574.4MB | peak: 6574.4MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 6574.4->6574.4MB | peak: 6574.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 6574.4->6574.9MB | peak: 6574.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 6574.9->6574.9MB | peak: 6574.9MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 6574.9->6575.6MB | peak: 6576.1MB
[PROFILE] env_0_MPS: 1.2ms | mem: 6575.6->6583.2MB | peak: 6599.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 6583.2->6583.2MB | peak: 6583.2MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 6583.2->6583.2MB | peak: 6583.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 6583.2->6583.7MB | peak: 6583.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 6583.7->6583.7MB | peak: 6583.7MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 6583.7->6584.4MB | peak: 6584.9MB
[PROFILE] env_0_MPS: 1.0ms | mem: 6584.4->6592.0MB | peak: 6608.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 6592.0->6592.0MB | peak: 6592.0MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 6592.0->6592.0MB | peak: 6592.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 6592.0->6592.6MB | peak: 6592.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 6592.6->6592.6MB | peak: 6592.6MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 6592.6->6593.2MB | peak: 6593.7MB
[PROFILE] env_0_MPS: 1.0ms | mem: 6593.1->6600.7MB | peak: 6617.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 6600.7->6600.7MB | peak: 6600.7MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 6600.7->6600.7MB | peak: 6600.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 6600.7->6601.3MB | peak: 6601.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 6601.3->6601.3MB | peak: 6601.3MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 6601.3->6601.9MB | peak: 6602.4MB
[PROFILE] env_0_MPS: 1.1ms | mem: 6601.8->6609.4MB | peak: 6625.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 6609.4->6609.4MB | peak: 6609.4MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 6609.4->6609.4MB | peak: 6609.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 6609.4->6609.9MB | peak: 6609.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 6609.9->6609.9MB | peak: 6609.9MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 6609.9->6610.6MB | peak: 6611.1MB
[PROFILE] env_0_MPS: 1.0ms | mem: 6610.4->6616.3MB | peak: 6628.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 6616.3->6616.3MB | peak: 6616.3MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 6616.3->6616.3MB | peak: 6616.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 6616.3->6616.7MB | peak: 6616.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 6616.7->6616.7MB | peak: 6616.7MB
[PROFILE] hess_contract_0_MPS: 0.7ms | mem: 6616.7->6617.2MB | peak: 6617.5MB
[PROFILE] compute_H_b_0_MPS: 35.0ms | mem: 6566.9->6616.9MB | peak: 6617.5MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 6616.9->6616.9MB | peak: 6616.9MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 6616.9->6616.9MB | peak: 6616.9MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 6616.9->6617.0MB | peak: 6617.2MB
[PROFILE] env_1_MPS: 1.3ms | mem: 6617.0->6630.4MB | peak: 6636.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6630.4->6630.4MB | peak: 6630.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 6630.4->6630.4MB | peak: 6630.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 6630.4->6636.6MB | peak: 6636.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6636.6->6636.6MB | peak: 6636.6MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 6636.6->6662.8MB | peak: 6682.8MB
[PROFILE] env_1_MPS: 1.3ms | mem: 6662.8->6676.6MB | peak: 6682.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6676.6->6676.6MB | peak: 6676.6MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 6676.6->6676.6MB | peak: 6676.6MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 6676.6->6682.8MB | peak: 6682.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6682.8->6682.8MB | peak: 6682.8MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 6682.8->6709.0MB | peak: 6729.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 6709.0->6722.3MB | peak: 6728.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6722.3->6722.3MB | peak: 6722.3MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 6722.3->6722.3MB | peak: 6722.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 6722.3->6728.5MB | peak: 6728.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6728.5->6728.5MB | peak: 6728.5MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 6728.5->6754.7MB | peak: 6774.7MB
[PROFILE] env_1_MPS: 1.1ms | mem: 6734.7->6748.6MB | peak: 6754.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6748.6->6748.6MB | peak: 6748.6MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 6748.6->6748.6MB | peak: 6748.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 6748.6->6754.8MB | peak: 6754.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 6754.8->6754.8MB | peak: 6754.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 6754.8->6781.0MB | peak: 6801.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 6761.0->6774.8MB | peak: 6781.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 6774.8->6774.8MB | peak: 6774.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 6774.8->6774.8MB | peak: 6774.8MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 6774.8->6781.0MB | peak: 6781.0MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 6781.0->6781.0MB | peak: 6781.0MB
[PROFILE] hess_contract_1_MPS: 3.1ms | mem: 6781.0->6807.2MB | peak: 6827.2MB
[PROFILE] env_1_MPS: 0.1ms | mem: 6787.2->6796.6MB | peak: 6801.0MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 6796.6->6796.6MB | peak: 6796.6MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 6796.6->6796.7MB | peak: 6796.7MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 6796.7->6801.1MB | peak: 6801.1MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 6801.1->6801.1MB | peak: 6801.1MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 6801.1->6826.1MB | peak: 6846.1MB
[PROFILE] compute_H_b_1_MPS: 51.6ms | mem: 6617.0->6786.1MB | peak: 6846.1MB
[PROFILE] fuse_1_MPS: 0.0ms | mem: 6786.1->6786.1MB | peak: 6786.1MB
[PROFILE] to_dense_1_MPS: 0.0ms | mem: 6786.1->6786.1MB | peak: 6786.1MB
[PROFILE] solve_1_MPS: 4.0ms | mem: 6786.1->6806.1MB | peak: 6826.1MB
[PROFILE] env_2_MPS: 1.5ms | mem: 6806.1->6819.5MB | peak: 6825.7MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 6819.5->6819.5MB | peak: 6819.5MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6819.5->6819.5MB | peak: 6819.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6819.5->6825.7MB | peak: 6825.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6825.7->6825.7MB | peak: 6825.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6825.7->6851.9MB | peak: 6871.9MB
[PROFILE] env_2_MPS: 1.1ms | mem: 6851.9->6865.9MB | peak: 6872.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6865.9->6865.9MB | peak: 6865.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6865.9->6865.9MB | peak: 6865.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6865.9->6872.1MB | peak: 6872.1MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 6872.1->6872.1MB | peak: 6872.1MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 6872.1->6898.3MB | peak: 6918.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6898.3->6911.7MB | peak: 6917.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6911.7->6911.7MB | peak: 6911.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 6911.7->6911.7MB | peak: 6911.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6911.7->6917.9MB | peak: 6918.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6917.9->6917.9MB | peak: 6917.9MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6917.9->6944.1MB | peak: 6964.1MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6924.1->6938.1MB | peak: 6944.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6938.1->6938.1MB | peak: 6938.1MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 6938.1->6938.1MB | peak: 6938.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6938.1->6944.3MB | peak: 6944.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6944.3->6944.3MB | peak: 6944.3MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 6944.3->6970.5MB | peak: 6990.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 6950.5->6964.4MB | peak: 6970.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6964.4->6964.4MB | peak: 6964.4MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 6964.4->6964.4MB | peak: 6964.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6964.4->6970.6MB | peak: 6970.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6970.6->6970.6MB | peak: 6970.6MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 6970.6->6996.8MB | peak: 7016.8MB
[PROFILE] env_2_MPS: 1.5ms | mem: 6976.8->6986.4MB | peak: 6991.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 6986.4->6986.4MB | peak: 6986.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 6986.4->6986.4MB | peak: 6986.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 6986.4->6990.8MB | peak: 6990.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 6990.8->6990.8MB | peak: 6990.8MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 6990.8->7015.2MB | peak: 7035.2MB
[PROFILE] compute_H_b_2_MPS: 37.9ms | mem: 6806.1->6975.1MB | peak: 7035.2MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 6975.1->6975.1MB | peak: 6975.1MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 6975.1->6975.1MB | peak: 6975.1MB
[PROFILE] solve_2_MPS: 1.7ms | mem: 6975.2->6995.2MB | peak: 7015.2MB
[PROFILE] env_3_MPS: 1.2ms | mem: 6995.2->6998.2MB | peak: 7015.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 6998.2->6998.7MB | peak: 6998.7MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 6998.7->6998.7MB | peak: 6998.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 6998.7->6999.2MB | peak: 6999.2MB
[PROFILE] hess_tn_build_3_MPS: 0.5ms | mem: 6999.2->6999.2MB | peak: 6999.2MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 6999.2->7000.4MB | peak: 7000.9MB
[PROFILE] env_3_MPS: 1.2ms | mem: 6999.9->7002.9MB | peak: 7019.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7002.9->7003.4MB | peak: 7003.4MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 7003.4->7003.4MB | peak: 7003.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 7003.4->7004.0MB | peak: 7004.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7004.0->7004.0MB | peak: 7004.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7004.0->7005.1MB | peak: 7005.6MB
[PROFILE] env_3_MPS: 1.2ms | mem: 7004.6->7007.6MB | peak: 7024.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7007.6->7008.1MB | peak: 7008.1MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 7008.1->7008.2MB | peak: 7008.2MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 7008.2->7008.7MB | peak: 7008.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7008.7->7008.7MB | peak: 7008.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7008.7->7009.8MB | peak: 7010.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 7009.2->7012.2MB | peak: 7029.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7012.2->7012.7MB | peak: 7012.7MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 7012.7->7012.7MB | peak: 7012.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 7012.7->7013.2MB | peak: 7013.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7013.2->7013.2MB | peak: 7013.2MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7013.2->7014.4MB | peak: 7014.9MB
[PROFILE] env_3_MPS: 1.6ms | mem: 7013.8->7016.8MB | peak: 7033.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7016.8->7017.3MB | peak: 7017.3MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 7017.3->7017.3MB | peak: 7017.3MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 7017.3->7017.8MB | peak: 7017.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7017.8->7017.8MB | peak: 7017.8MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7017.8->7019.0MB | peak: 7019.5MB
[PROFILE] env_3_MPS: 1.2ms | mem: 7018.3->7020.9MB | peak: 7033.3MB
[PROFILE] forward_3_MPS: 0.7ms | mem: 7020.9->7021.3MB | peak: 7021.3MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 7021.3->7021.3MB | peak: 7021.3MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 7021.3->7021.7MB | peak: 7021.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7021.7->7021.7MB | peak: 7021.7MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 7021.7->7022.5MB | peak: 7022.9MB
[PROFILE] compute_H_b_3_MPS: 35.8ms | mem: 6995.2->7021.9MB | peak: 7022.9MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 7021.9->7021.9MB | peak: 7021.9MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 7021.9->7021.9MB | peak: 7021.9MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 7021.9->7022.1MB | peak: 7022.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7022.1->7035.5MB | peak: 7041.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7035.5->7035.5MB | peak: 7035.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 7035.5->7035.5MB | peak: 7035.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7035.5->7041.7MB | peak: 7041.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7041.7->7041.7MB | peak: 7041.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 7041.7->7067.9MB | peak: 7087.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7067.9->7081.9MB | peak: 7088.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7081.9->7081.9MB | peak: 7081.9MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 7081.9->7081.9MB | peak: 7081.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7081.9->7088.1MB | peak: 7088.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7088.1->7088.1MB | peak: 7088.1MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 7088.1->7114.2MB | peak: 7134.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7114.2->7127.7MB | peak: 7133.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7127.7->7127.7MB | peak: 7127.7MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 7127.7->7127.7MB | peak: 7127.7MB
[PROFILE] grad_contract_2_MPS: 0.4ms | mem: 7127.7->7133.9MB | peak: 7133.9MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 7133.9->7133.9MB | peak: 7133.9MB
[PROFILE] hess_contract_2_MPS: 0.3ms | mem: 7133.9->7160.1MB | peak: 7180.1MB
[PROFILE] env_2_MPS: 0.2ms | mem: 7140.1->7154.0MB | peak: 7160.2MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 7154.0->7154.0MB | peak: 7154.0MB
[PROFILE] loss_derivs_2_MPS: 0.1ms | mem: 7154.0->7154.0MB | peak: 7154.1MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 7154.0->7160.2MB | peak: 7160.3MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 7160.2->7160.2MB | peak: 7160.2MB
[PROFILE] hess_contract_2_MPS: 3.1ms | mem: 7160.2->7186.4MB | peak: 7206.4MB
[PROFILE] env_2_MPS: 0.2ms | mem: 7166.4->7180.4MB | peak: 7186.6MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 7180.4->7180.4MB | peak: 7180.4MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 7180.4->7180.4MB | peak: 7180.4MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 7180.4->7186.6MB | peak: 7186.6MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 7186.6->7186.6MB | peak: 7186.6MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 7186.6->7212.8MB | peak: 7232.8MB
[PROFILE] env_2_MPS: 0.2ms | mem: 7192.8->7202.3MB | peak: 7207.1MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 7202.3->7202.3MB | peak: 7202.3MB
[PROFILE] loss_derivs_2_MPS: 0.8ms | mem: 7202.3->7202.3MB | peak: 7202.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7202.3->7206.7MB | peak: 7206.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7206.7->7206.7MB | peak: 7206.7MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 7206.7->7231.1MB | peak: 7251.1MB
[PROFILE] compute_H_b_2_MPS: 65.4ms | mem: 7022.1->7191.1MB | peak: 7251.1MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 7191.1->7191.1MB | peak: 7191.1MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 7191.1->7191.1MB | peak: 7191.1MB
[PROFILE] solve_2_MPS: 1.8ms | mem: 7191.1->7211.1MB | peak: 7231.1MB
[PROFILE] env_1_MPS: 1.3ms | mem: 7211.1->7224.5MB | peak: 7230.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7224.5->7224.5MB | peak: 7224.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 7224.5->7224.5MB | peak: 7224.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7224.5->7230.7MB | peak: 7230.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7230.7->7230.7MB | peak: 7230.7MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 7230.7->7256.9MB | peak: 7276.9MB
[PROFILE] env_1_MPS: 1.3ms | mem: 7256.9->7270.7MB | peak: 7276.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7270.7->7270.7MB | peak: 7270.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 7270.7->7270.7MB | peak: 7270.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7270.7->7276.9MB | peak: 7276.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7276.9->7276.9MB | peak: 7276.9MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 7276.9->7303.1MB | peak: 7323.1MB
[PROFILE] env_1_MPS: 1.3ms | mem: 7303.1->7316.4MB | peak: 7322.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7316.4->7316.4MB | peak: 7316.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 7316.4->7316.5MB | peak: 7316.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7316.5->7322.7MB | peak: 7322.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7322.7->7322.7MB | peak: 7322.7MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 7322.7->7348.8MB | peak: 7368.8MB
[PROFILE] env_1_MPS: 1.2ms | mem: 7328.8->7342.7MB | peak: 7348.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7342.7->7342.7MB | peak: 7342.7MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 7342.7->7342.7MB | peak: 7342.7MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 7342.7->7348.9MB | peak: 7348.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7348.9->7348.9MB | peak: 7348.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 7348.9->7375.1MB | peak: 7395.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 7355.1->7368.9MB | peak: 7375.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7368.9->7368.9MB | peak: 7368.9MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 7368.9->7368.9MB | peak: 7368.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7368.9->7375.1MB | peak: 7375.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7375.1->7375.1MB | peak: 7375.1MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 7375.1->7401.3MB | peak: 7421.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 7381.3->7390.7MB | peak: 7395.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7390.7->7390.8MB | peak: 7390.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 7390.8->7390.8MB | peak: 7390.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7390.8->7395.2MB | peak: 7395.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7395.2->7395.2MB | peak: 7395.2MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 7395.2->7419.5MB | peak: 7439.5MB
[PROFILE] compute_H_b_1_MPS: 37.9ms | mem: 7211.1->7379.5MB | peak: 7439.5MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 7379.5->7379.5MB | peak: 7379.5MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 7379.5->7379.5MB | peak: 7379.5MB
[PROFILE] solve_1_MPS: 1.7ms | mem: 7379.5->7399.6MB | peak: 7419.6MB
[PROFILE] env_0_MPS: 1.0ms | mem: 7399.6->7407.0MB | peak: 7423.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 7407.0->7407.0MB | peak: 7407.0MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 7407.0->7407.0MB | peak: 7407.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 7407.0->7407.6MB | peak: 7407.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 7407.6->7407.6MB | peak: 7407.6MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 7407.6->7408.2MB | peak: 7408.7MB
[PROFILE] env_0_MPS: 1.0ms | mem: 7408.2->7415.9MB | peak: 7432.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 7415.9->7415.9MB | peak: 7415.9MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 7415.9->7415.9MB | peak: 7415.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 7415.9->7416.4MB | peak: 7416.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 7416.4->7416.4MB | peak: 7416.4MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 7416.4->7417.0MB | peak: 7417.5MB
[PROFILE] env_0_MPS: 1.1ms | mem: 7417.0->7424.7MB | peak: 7441.2MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 7424.7->7424.7MB | peak: 7424.7MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 7424.7->7424.7MB | peak: 7424.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 7424.7->7425.2MB | peak: 7425.2MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 7425.2->7425.2MB | peak: 7425.2MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 7425.2->7425.8MB | peak: 7426.4MB
[PROFILE] env_0_MPS: 1.2ms | mem: 7425.7->7433.4MB | peak: 7449.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 7433.4->7433.4MB | peak: 7433.4MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 7433.4->7433.4MB | peak: 7433.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 7433.4->7433.9MB | peak: 7433.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 7433.9->7433.9MB | peak: 7433.9MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 7433.9->7434.5MB | peak: 7435.1MB
[PROFILE] env_0_MPS: 1.0ms | mem: 7434.4->7442.0MB | peak: 7458.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 7442.0->7442.0MB | peak: 7442.0MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 7442.0->7442.1MB | peak: 7442.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 7442.1->7442.6MB | peak: 7442.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 7442.6->7442.6MB | peak: 7442.6MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 7442.6->7443.2MB | peak: 7443.7MB
[PROFILE] env_0_MPS: 0.9ms | mem: 7443.1->7448.9MB | peak: 7460.6MB
[PROFILE] forward_0_MPS: 2.0ms | mem: 7448.9->7448.9MB | peak: 7448.9MB
[PROFILE] loss_derivs_0_MPS: 2.9ms | mem: 7448.9->7448.9MB | peak: 7448.9MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 7448.9->7449.3MB | peak: 7449.3MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 7449.3->7449.3MB | peak: 7449.3MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 7449.3->7449.8MB | peak: 7450.2MB
[PROFILE] compute_H_b_0_MPS: 46.7ms | mem: 7399.6->7449.5MB | peak: 7450.2MB
[PROFILE] fuse_0_MPS: 0.0ms | mem: 7449.5->7449.5MB | peak: 7449.5MB
[PROFILE] to_dense_0_MPS: 0.0ms | mem: 7449.5->7449.5MB | peak: 7449.5MB
[PROFILE] solve_0_MPS: 2.7ms | mem: 7449.5->7449.7MB | peak: 7449.8MB
[PROFILE] env_1_MPS: 0.2ms | mem: 7449.7->7463.0MB | peak: 7469.2MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 7463.0->7463.0MB | peak: 7463.0MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 7463.0->7463.0MB | peak: 7463.0MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 7463.0->7469.2MB | peak: 7469.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7469.2->7469.2MB | peak: 7469.2MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 7469.2->7495.4MB | peak: 7515.4MB
[PROFILE] env_1_MPS: 0.5ms | mem: 7495.4->7509.2MB | peak: 7515.4MB
[PROFILE] forward_1_MPS: 0.4ms | mem: 7509.2->7509.2MB | peak: 7509.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 7509.2->7509.3MB | peak: 7509.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7509.3->7515.5MB | peak: 7515.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7515.5->7515.5MB | peak: 7515.5MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 7515.5->7541.6MB | peak: 7561.6MB
[PROFILE] env_1_MPS: 1.1ms | mem: 7541.6->7555.0MB | peak: 7561.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7555.0->7555.0MB | peak: 7555.0MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 7555.0->7555.0MB | peak: 7555.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7555.0->7561.2MB | peak: 7561.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7561.2->7561.2MB | peak: 7561.2MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 7561.2->7587.4MB | peak: 7607.4MB
[PROFILE] env_1_MPS: 1.2ms | mem: 7567.4->7581.2MB | peak: 7587.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7581.2->7581.2MB | peak: 7581.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 7581.2->7581.2MB | peak: 7581.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7581.2->7587.4MB | peak: 7587.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7587.4->7587.4MB | peak: 7587.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 7587.4->7613.6MB | peak: 7633.6MB
[PROFILE] env_1_MPS: 1.2ms | mem: 7593.6->7607.4MB | peak: 7613.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7607.4->7607.4MB | peak: 7607.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 7607.4->7607.4MB | peak: 7607.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7607.4->7613.6MB | peak: 7613.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7613.6->7613.6MB | peak: 7613.6MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 7613.6->7639.8MB | peak: 7659.8MB
[PROFILE] env_1_MPS: 1.0ms | mem: 7619.8->7629.3MB | peak: 7633.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 7629.3->7629.3MB | peak: 7629.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 7629.3->7629.3MB | peak: 7629.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 7629.3->7633.7MB | peak: 7633.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 7633.7->7633.7MB | peak: 7633.7MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 7633.7->7658.7MB | peak: 7678.7MB
[PROFILE] compute_H_b_1_MPS: 42.6ms | mem: 7449.7->7618.7MB | peak: 7678.7MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 7618.7->7618.7MB | peak: 7618.7MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 7618.7->7618.7MB | peak: 7618.7MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 7618.7->7638.7MB | peak: 7658.7MB
[PROFILE] env_2_MPS: 1.3ms | mem: 7638.7->7652.2MB | peak: 7658.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7652.2->7652.2MB | peak: 7652.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 7652.2->7652.2MB | peak: 7652.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7652.2->7658.4MB | peak: 7658.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7658.4->7658.4MB | peak: 7658.4MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 7658.4->7684.6MB | peak: 7704.6MB
[PROFILE] env_2_MPS: 1.3ms | mem: 7684.6->7698.5MB | peak: 7704.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7698.5->7698.5MB | peak: 7698.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 7698.5->7698.5MB | peak: 7698.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7698.5->7704.7MB | peak: 7704.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7704.7->7704.7MB | peak: 7704.7MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 7704.7->7730.9MB | peak: 7750.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7730.9->7744.4MB | peak: 7750.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7744.4->7744.4MB | peak: 7744.4MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 7744.4->7744.4MB | peak: 7744.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7744.4->7750.6MB | peak: 7750.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7750.6->7750.6MB | peak: 7750.6MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 7750.6->7776.8MB | peak: 7796.8MB
[PROFILE] env_2_MPS: 1.1ms | mem: 7756.8->7770.7MB | peak: 7776.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7770.7->7770.7MB | peak: 7770.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 7770.7->7770.7MB | peak: 7770.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7770.7->7776.9MB | peak: 7776.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7776.9->7776.9MB | peak: 7776.9MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 7776.9->7803.1MB | peak: 7823.1MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7783.1->7797.1MB | peak: 7803.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7797.1->7797.1MB | peak: 7797.1MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 7797.1->7797.1MB | peak: 7797.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7797.1->7803.3MB | peak: 7803.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7803.3->7803.3MB | peak: 7803.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 7803.3->7829.5MB | peak: 7849.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7809.4->7819.0MB | peak: 7823.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7819.0->7819.0MB | peak: 7819.0MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 7819.0->7819.0MB | peak: 7819.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7819.0->7823.4MB | peak: 7823.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7823.4->7823.4MB | peak: 7823.4MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 7823.4->7847.8MB | peak: 7867.8MB
[PROFILE] compute_H_b_2_MPS: 37.3ms | mem: 7638.7->7807.8MB | peak: 7867.8MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 7807.8->7807.8MB | peak: 7807.8MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 7807.8->7807.8MB | peak: 7807.8MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 7807.8->7827.8MB | peak: 7847.8MB
[PROFILE] env_3_MPS: 1.0ms | mem: 7827.8->7830.8MB | peak: 7847.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7830.8->7831.3MB | peak: 7831.4MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 7831.3->7831.4MB | peak: 7831.4MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 7831.4->7831.9MB | peak: 7831.9MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7831.9->7831.9MB | peak: 7831.9MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7831.9->7833.0MB | peak: 7833.6MB
[PROFILE] env_3_MPS: 1.0ms | mem: 7832.5->7835.5MB | peak: 7852.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7835.5->7836.1MB | peak: 7836.1MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 7836.1->7836.1MB | peak: 7836.1MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 7836.1->7836.6MB | peak: 7836.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7836.6->7836.6MB | peak: 7836.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7836.6->7837.8MB | peak: 7838.3MB
[PROFILE] env_3_MPS: 1.0ms | mem: 7837.2->7840.3MB | peak: 7857.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7840.3->7840.8MB | peak: 7840.8MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 7840.8->7840.8MB | peak: 7840.8MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 7840.8->7841.3MB | peak: 7841.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 7841.3->7841.3MB | peak: 7841.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 7841.3->7842.5MB | peak: 7843.0MB
[PROFILE] env_3_MPS: 2.6ms | mem: 7841.8->7844.8MB | peak: 7861.8MB
[PROFILE] forward_3_MPS: 0.4ms | mem: 7844.8->7845.4MB | peak: 7845.4MB
[PROFILE] loss_derivs_3_MPS: 0.0ms | mem: 7845.4->7845.4MB | peak: 7845.4MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 7845.4->7845.9MB | peak: 7845.9MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 7845.9->7845.9MB | peak: 7845.9MB
[PROFILE] hess_contract_3_MPS: 2.5ms | mem: 7845.9->7847.1MB | peak: 7847.6MB
[PROFILE] env_3_MPS: 0.2ms | mem: 7846.4->7849.4MB | peak: 7866.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 7849.4->7849.9MB | peak: 7849.9MB
[PROFILE] loss_derivs_3_MPS: 2.8ms | mem: 7849.9->7849.9MB | peak: 7850.0MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 7849.9->7850.5MB | peak: 7850.5MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 7850.5->7850.5MB | peak: 7850.5MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 7850.5->7851.6MB | peak: 7852.1MB
[PROFILE] env_3_MPS: 0.1ms | mem: 7851.0->7853.6MB | peak: 7866.0MB
[PROFILE] forward_3_MPS: 0.4ms | mem: 7853.6->7853.9MB | peak: 7853.9MB
[PROFILE] loss_derivs_3_MPS: 0.4ms | mem: 7853.9->7854.0MB | peak: 7854.0MB
[PROFILE] grad_contract_3_MPS: 0.9ms | mem: 7854.0->7854.3MB | peak: 7854.3MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 7854.3->7854.3MB | peak: 7854.3MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 7854.3->7855.2MB | peak: 7855.6MB
[PROFILE] compute_H_b_3_MPS: 58.2ms | mem: 7827.8->7854.5MB | peak: 7855.6MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 7854.5->7854.5MB | peak: 7854.5MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 7854.5->7854.5MB | peak: 7854.5MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 7854.6->7854.7MB | peak: 7854.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7854.7->7868.1MB | peak: 7874.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7868.1->7868.1MB | peak: 7868.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 7868.1->7868.1MB | peak: 7868.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7868.1->7874.3MB | peak: 7874.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7874.3->7874.3MB | peak: 7874.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 7874.3->7900.5MB | peak: 7920.5MB
[PROFILE] env_2_MPS: 1.6ms | mem: 7900.5->7914.5MB | peak: 7920.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7914.5->7914.5MB | peak: 7914.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 7914.5->7914.5MB | peak: 7914.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7914.5->7920.7MB | peak: 7920.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7920.7->7920.7MB | peak: 7920.7MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 7920.7->7946.9MB | peak: 7966.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7946.9->7960.3MB | peak: 7966.5MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 7960.3->7960.3MB | peak: 7960.3MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 7960.3->7960.3MB | peak: 7960.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7960.3->7966.5MB | peak: 7966.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7966.5->7966.5MB | peak: 7966.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 7966.5->7992.7MB | peak: 8012.7MB
[PROFILE] env_2_MPS: 1.2ms | mem: 7972.7->7986.7MB | peak: 7992.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 7986.7->7986.7MB | peak: 7986.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 7986.7->7986.7MB | peak: 7986.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 7986.7->7992.9MB | peak: 7992.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 7992.9->7992.9MB | peak: 7992.9MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 7992.9->8019.1MB | peak: 8039.1MB
[PROFILE] env_2_MPS: 1.1ms | mem: 7999.1->8013.0MB | peak: 8019.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8013.0->8013.0MB | peak: 8013.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 8013.0->8013.0MB | peak: 8013.0MB
[PROFILE] grad_contract_2_MPS: 0.7ms | mem: 8013.0->8019.2MB | peak: 8019.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8019.2->8019.2MB | peak: 8019.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 8019.2->8045.4MB | peak: 8065.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 8025.4->8035.0MB | peak: 8039.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8035.0->8035.0MB | peak: 8035.0MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 8035.0->8035.0MB | peak: 8035.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8035.0->8039.4MB | peak: 8039.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8039.4->8039.4MB | peak: 8039.4MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 8039.4->8063.8MB | peak: 8083.8MB
[PROFILE] compute_H_b_2_MPS: 37.4ms | mem: 7854.7->8023.7MB | peak: 8083.8MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 8023.7->8023.7MB | peak: 8023.7MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 8023.7->8023.7MB | peak: 8023.7MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 8023.8->8043.8MB | peak: 8063.8MB
[PROFILE] env_1_MPS: 1.2ms | mem: 8043.8->8057.1MB | peak: 8063.3MB
[PROFILE] forward_1_MPS: 0.8ms | mem: 8057.1->8057.1MB | peak: 8057.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 8057.1->8057.1MB | peak: 8057.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8057.1->8063.3MB | peak: 8063.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8063.3->8063.3MB | peak: 8063.3MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 8063.3->8089.5MB | peak: 8109.5MB
[PROFILE] env_1_MPS: 1.1ms | mem: 8089.5->8103.3MB | peak: 8109.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8103.3->8103.3MB | peak: 8103.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 8103.3->8103.4MB | peak: 8103.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8103.4->8109.6MB | peak: 8109.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8109.6->8109.6MB | peak: 8109.6MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 8109.6->8135.7MB | peak: 8155.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 8135.7->8149.1MB | peak: 8155.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8149.1->8149.1MB | peak: 8149.1MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 8149.1->8149.1MB | peak: 8149.1MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 8149.1->8155.3MB | peak: 8155.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8155.3->8155.3MB | peak: 8155.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 8155.3->8181.5MB | peak: 8201.5MB
[PROFILE] env_1_MPS: 1.3ms | mem: 8161.5->8175.3MB | peak: 8181.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8175.3->8175.3MB | peak: 8175.3MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 8175.3->8175.3MB | peak: 8175.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8175.3->8181.5MB | peak: 8181.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8181.5->8181.5MB | peak: 8181.5MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 8181.5->8207.7MB | peak: 8227.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 8187.7->8201.5MB | peak: 8207.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8201.5->8201.5MB | peak: 8201.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 8201.5->8201.6MB | peak: 8201.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8201.6->8207.8MB | peak: 8207.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8207.8->8207.8MB | peak: 8207.8MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 8207.8->8233.9MB | peak: 8253.9MB
[PROFILE] env_1_MPS: 1.0ms | mem: 8213.9->8223.4MB | peak: 8227.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8223.4->8223.4MB | peak: 8223.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 8223.4->8223.4MB | peak: 8223.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8223.4->8227.8MB | peak: 8227.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8227.8->8227.8MB | peak: 8227.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 8227.8->8252.2MB | peak: 8272.2MB
[PROFILE] compute_H_b_1_MPS: 37.5ms | mem: 8043.8->8212.2MB | peak: 8272.2MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 8212.2->8212.2MB | peak: 8212.2MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 8212.2->8212.2MB | peak: 8212.2MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 8212.2->8232.2MB | peak: 8252.2MB
[PROFILE] env_0_MPS: 3.0ms | mem: 8232.2->8239.7MB | peak: 8256.2MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 8239.7->8239.7MB | peak: 8239.7MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 8239.7->8239.7MB | peak: 8239.7MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 8239.7->8240.2MB | peak: 8240.2MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 8240.2->8240.2MB | peak: 8240.2MB
[PROFILE] hess_contract_0_MPS: 0.2ms | mem: 8240.2->8240.8MB | peak: 8241.4MB
[PROFILE] env_0_MPS: 2.0ms | mem: 8240.8->8248.5MB | peak: 8265.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 8248.5->8248.5MB | peak: 8248.5MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 8248.5->8248.5MB | peak: 8248.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 8248.5->8249.0MB | peak: 8249.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 8249.0->8249.0MB | peak: 8249.0MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 8249.0->8249.7MB | peak: 8250.2MB
[PROFILE] env_0_MPS: 1.0ms | mem: 8249.7->8257.3MB | peak: 8273.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 8257.3->8257.3MB | peak: 8257.3MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 8257.3->8257.3MB | peak: 8257.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 8257.3->8257.8MB | peak: 8257.8MB
[PROFILE] hess_tn_build_0_MPS: 0.5ms | mem: 8257.8->8257.8MB | peak: 8257.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 8257.8->8258.5MB | peak: 8259.0MB
[PROFILE] env_0_MPS: 1.0ms | mem: 8258.3->8266.0MB | peak: 8282.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 8266.0->8266.0MB | peak: 8266.0MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 8266.0->8266.0MB | peak: 8266.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 8266.0->8266.5MB | peak: 8266.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 8266.5->8266.5MB | peak: 8266.5MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 8266.5->8267.2MB | peak: 8267.7MB
[PROFILE] env_0_MPS: 1.1ms | mem: 8267.0->8274.7MB | peak: 8291.2MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 8274.7->8274.7MB | peak: 8274.7MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 8274.7->8274.7MB | peak: 8274.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 8274.7->8275.2MB | peak: 8275.2MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 8275.2->8275.2MB | peak: 8275.2MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 8275.2->8275.8MB | peak: 8276.4MB
[PROFILE] env_0_MPS: 0.9ms | mem: 8275.7->8281.5MB | peak: 8293.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 8281.5->8281.6MB | peak: 8281.6MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 8281.6->8281.6MB | peak: 8281.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 8281.6->8281.9MB | peak: 8281.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 8281.9->8281.9MB | peak: 8281.9MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 8281.9->8282.4MB | peak: 8282.8MB
[PROFILE] compute_H_b_0_MPS: 42.1ms | mem: 8232.2->8282.2MB | peak: 8282.8MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 8282.2->8282.2MB | peak: 8282.2MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 8282.2->8282.2MB | peak: 8282.2MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 8282.2->8282.3MB | peak: 8282.4MB
[PROFILE] env_1_MPS: 1.3ms | mem: 8282.3->8295.6MB | peak: 8301.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8295.6->8295.6MB | peak: 8295.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 8295.6->8295.6MB | peak: 8295.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8295.6->8301.8MB | peak: 8301.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8301.8->8301.8MB | peak: 8301.8MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 8301.8->8328.0MB | peak: 8348.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 8328.0->8341.9MB | peak: 8348.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8341.9->8341.9MB | peak: 8341.9MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 8341.9->8341.9MB | peak: 8341.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8341.9->8348.1MB | peak: 8348.1MB
[PROFILE] hess_tn_build_1_MPS: 0.5ms | mem: 8348.1->8348.1MB | peak: 8348.1MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 8348.1->8374.3MB | peak: 8394.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 8374.3->8387.6MB | peak: 8393.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8387.6->8387.6MB | peak: 8387.6MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 8387.6->8387.6MB | peak: 8387.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8387.6->8393.8MB | peak: 8393.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8393.8->8393.8MB | peak: 8393.8MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 8393.8->8420.0MB | peak: 8440.0MB
[PROFILE] env_1_MPS: 1.1ms | mem: 8400.0->8413.8MB | peak: 8420.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8413.8->8413.8MB | peak: 8413.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 8413.8->8413.8MB | peak: 8413.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8413.8->8420.0MB | peak: 8420.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8420.0->8420.0MB | peak: 8420.0MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 8420.0->8446.2MB | peak: 8466.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 8426.2->8440.1MB | peak: 8446.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8440.1->8440.1MB | peak: 8440.1MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 8440.1->8440.1MB | peak: 8440.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8440.1->8446.3MB | peak: 8446.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8446.3->8446.3MB | peak: 8446.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 8446.3->8472.5MB | peak: 8492.5MB
[PROFILE] env_1_MPS: 1.6ms | mem: 8452.5->8461.9MB | peak: 8466.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8461.9->8461.9MB | peak: 8461.9MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 8461.9->8461.9MB | peak: 8461.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8461.9->8466.3MB | peak: 8466.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8466.3->8466.3MB | peak: 8466.3MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 8466.3->8491.4MB | peak: 8511.4MB
[PROFILE] compute_H_b_1_MPS: 37.5ms | mem: 8282.3->8451.3MB | peak: 8511.4MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 8451.3->8451.3MB | peak: 8451.3MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 8451.3->8451.3MB | peak: 8451.3MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 8451.3->8471.4MB | peak: 8491.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 8471.4->8484.8MB | peak: 8491.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8484.8->8484.8MB | peak: 8484.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 8484.8->8484.8MB | peak: 8484.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8484.8->8491.0MB | peak: 8491.0MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 8491.0->8491.0MB | peak: 8491.0MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 8491.0->8517.2MB | peak: 8537.2MB
[PROFILE] env_2_MPS: 1.1ms | mem: 8517.2->8531.2MB | peak: 8537.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8531.2->8531.2MB | peak: 8531.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 8531.2->8531.2MB | peak: 8531.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8531.2->8537.4MB | peak: 8537.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8537.4->8537.4MB | peak: 8537.4MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 8537.4->8563.6MB | peak: 8583.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 8563.6->8577.0MB | peak: 8583.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8577.0->8577.0MB | peak: 8577.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 8577.0->8577.0MB | peak: 8577.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8577.0->8583.2MB | peak: 8583.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8583.2->8583.2MB | peak: 8583.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 8583.2->8609.4MB | peak: 8629.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 8589.4->8603.3MB | peak: 8609.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8603.3->8603.3MB | peak: 8603.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 8603.3->8603.4MB | peak: 8603.4MB
[PROFILE] grad_contract_2_MPS: 1.8ms | mem: 8603.4->8609.6MB | peak: 8609.6MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 8609.6->8609.6MB | peak: 8609.6MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 8609.6->8635.7MB | peak: 8655.7MB
[PROFILE] env_2_MPS: 0.1ms | mem: 8615.7->8629.7MB | peak: 8635.9MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 8629.7->8629.7MB | peak: 8629.7MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 8629.7->8629.7MB | peak: 8629.7MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 8629.7->8635.9MB | peak: 8635.9MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 8635.9->8635.9MB | peak: 8635.9MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 8635.9->8662.1MB | peak: 8682.1MB
[PROFILE] env_2_MPS: 1.9ms | mem: 8642.1->8651.6MB | peak: 8656.4MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 8651.6->8651.6MB | peak: 8651.6MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 8651.6->8651.6MB | peak: 8651.7MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 8651.6->8656.0MB | peak: 8656.1MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 8656.0->8656.0MB | peak: 8656.0MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 8656.0->8680.4MB | peak: 8700.4MB
[PROFILE] compute_H_b_2_MPS: 57.2ms | mem: 8471.4->8640.4MB | peak: 8700.4MB
[PROFILE] fuse_2_MPS: 0.0ms | mem: 8640.4->8640.4MB | peak: 8640.4MB
[PROFILE] to_dense_2_MPS: 0.0ms | mem: 8640.4->8640.4MB | peak: 8640.4MB
[PROFILE] solve_2_MPS: 3.1ms | mem: 8640.4->8660.4MB | peak: 8680.5MB
[PROFILE] env_3_MPS: 1.2ms | mem: 8660.4->8663.5MB | peak: 8680.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 8663.5->8664.0MB | peak: 8664.0MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 8664.0->8664.0MB | peak: 8664.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 8664.0->8664.5MB | peak: 8664.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 8664.5->8664.5MB | peak: 8664.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 8664.5->8665.7MB | peak: 8666.2MB
[PROFILE] env_3_MPS: 1.2ms | mem: 8665.2->8668.2MB | peak: 8685.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 8668.2->8668.7MB | peak: 8668.7MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 8668.7->8668.7MB | peak: 8668.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 8668.7->8669.2MB | peak: 8669.2MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 8669.2->8669.2MB | peak: 8669.2MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 8669.2->8670.4MB | peak: 8670.9MB
[PROFILE] env_3_MPS: 1.2ms | mem: 8669.9->8672.9MB | peak: 8689.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 8672.9->8673.4MB | peak: 8673.4MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 8673.4->8673.4MB | peak: 8673.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 8673.4->8673.9MB | peak: 8673.9MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 8673.9->8673.9MB | peak: 8673.9MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 8673.9->8675.1MB | peak: 8675.6MB
[PROFILE] env_3_MPS: 1.2ms | mem: 8674.4->8677.5MB | peak: 8694.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 8677.5->8678.0MB | peak: 8678.0MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 8678.0->8678.0MB | peak: 8678.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 8678.0->8678.5MB | peak: 8678.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 8678.5->8678.5MB | peak: 8678.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 8678.5->8679.7MB | peak: 8680.2MB
[PROFILE] env_3_MPS: 1.2ms | mem: 8679.0->8682.1MB | peak: 8699.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 8682.1->8682.6MB | peak: 8682.6MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 8682.6->8682.6MB | peak: 8682.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 8682.6->8683.1MB | peak: 8683.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 8683.1->8683.1MB | peak: 8683.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 8683.1->8684.3MB | peak: 8684.8MB
[PROFILE] env_3_MPS: 1.0ms | mem: 8683.6->8686.2MB | peak: 8698.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 8686.2->8686.6MB | peak: 8686.6MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 8686.6->8686.6MB | peak: 8686.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 8686.6->8686.9MB | peak: 8687.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 8686.9->8686.9MB | peak: 8686.9MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 8686.9->8687.8MB | peak: 8688.2MB
[PROFILE] compute_H_b_3_MPS: 36.2ms | mem: 8660.4->8687.2MB | peak: 8688.2MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 8687.2->8687.2MB | peak: 8687.2MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 8687.2->8687.2MB | peak: 8687.2MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 8687.2->8687.3MB | peak: 8687.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 8687.3->8700.8MB | peak: 8706.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8700.8->8700.8MB | peak: 8700.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 8700.8->8700.8MB | peak: 8700.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8700.8->8707.0MB | peak: 8707.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8707.0->8707.0MB | peak: 8707.0MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 8707.0->8733.2MB | peak: 8753.2MB
[PROFILE] env_2_MPS: 1.3ms | mem: 8733.2->8747.1MB | peak: 8753.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8747.1->8747.1MB | peak: 8747.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 8747.1->8747.1MB | peak: 8747.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8747.1->8753.3MB | peak: 8753.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8753.3->8753.3MB | peak: 8753.3MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 8753.3->8779.5MB | peak: 8799.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 8779.5->8793.0MB | peak: 8799.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8793.0->8793.0MB | peak: 8793.0MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 8793.0->8793.0MB | peak: 8793.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8793.0->8799.2MB | peak: 8799.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8799.2->8799.2MB | peak: 8799.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 8799.2->8825.4MB | peak: 8845.4MB
[PROFILE] env_2_MPS: 1.1ms | mem: 8805.3->8819.3MB | peak: 8825.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8819.3->8819.3MB | peak: 8819.3MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 8819.3->8819.3MB | peak: 8819.3MB
[PROFILE] grad_contract_2_MPS: 0.7ms | mem: 8819.3->8825.5MB | peak: 8825.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8825.5->8825.5MB | peak: 8825.5MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 8825.5->8851.7MB | peak: 8871.7MB
[PROFILE] env_2_MPS: 1.3ms | mem: 8831.7->8845.6MB | peak: 8851.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8845.6->8845.7MB | peak: 8845.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 8845.7->8845.7MB | peak: 8845.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8845.7->8851.9MB | peak: 8851.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8851.9->8851.9MB | peak: 8851.9MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 8851.9->8878.0MB | peak: 8898.0MB
[PROFILE] env_2_MPS: 1.1ms | mem: 8858.0->8867.6MB | peak: 8872.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 8867.6->8867.6MB | peak: 8867.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 8867.6->8867.6MB | peak: 8867.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 8867.6->8872.0MB | peak: 8872.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 8872.0->8872.0MB | peak: 8872.0MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 8872.0->8896.4MB | peak: 8916.4MB
[PROFILE] compute_H_b_2_MPS: 37.8ms | mem: 8687.3->8856.4MB | peak: 8916.4MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 8856.4->8856.4MB | peak: 8856.4MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 8856.4->8856.4MB | peak: 8856.4MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 8856.4->8876.4MB | peak: 8896.4MB
[PROFILE] env_1_MPS: 1.3ms | mem: 8876.4->8889.7MB | peak: 8895.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8889.7->8889.7MB | peak: 8889.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 8889.7->8889.7MB | peak: 8889.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8889.7->8895.9MB | peak: 8896.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8895.9->8895.9MB | peak: 8895.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 8895.9->8922.1MB | peak: 8942.1MB
[PROFILE] env_1_MPS: 1.3ms | mem: 8922.1->8936.0MB | peak: 8942.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 8936.0->8936.0MB | peak: 8936.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 8936.0->8936.0MB | peak: 8936.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 8936.0->8942.2MB | peak: 8942.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 8942.2->8942.2MB | peak: 8942.2MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 8942.2->8968.4MB | peak: 8988.4MB
[PROFILE] env_1_MPS: 1.4ms | mem: 8968.4->8981.7MB | peak: 8987.9MB
[PROFILE] forward_1_MPS: 1.7ms | mem: 8981.7->8981.7MB | peak: 8981.7MB
[PROFILE] loss_derivs_1_MPS: 2.0ms | mem: 8981.7->8981.7MB | peak: 8981.7MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 8981.7->8987.9MB | peak: 8987.9MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 8987.9->8987.9MB | peak: 8987.9MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 8987.9->9014.1MB | peak: 9034.1MB
[PROFILE] env_1_MPS: 0.1ms | mem: 8994.1->9007.9MB | peak: 9014.1MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 9007.9->9007.9MB | peak: 9007.9MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 9007.9->9007.9MB | peak: 9008.0MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 9007.9->9014.1MB | peak: 9014.2MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 9014.1->9014.1MB | peak: 9014.1MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 9014.1->9040.3MB | peak: 9060.3MB
[PROFILE] env_1_MPS: 2.6ms | mem: 9020.3->9034.2MB | peak: 9040.4MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 9034.2->9034.2MB | peak: 9034.2MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 9034.2->9034.2MB | peak: 9034.2MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 9034.2->9040.4MB | peak: 9040.4MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 9040.4->9040.4MB | peak: 9040.4MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 9040.4->9066.6MB | peak: 9086.6MB
[PROFILE] env_1_MPS: 1.8ms | mem: 9046.6->9056.0MB | peak: 9060.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9056.0->9056.0MB | peak: 9056.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 9056.0->9056.0MB | peak: 9056.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9056.0->9060.4MB | peak: 9060.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9060.4->9060.4MB | peak: 9060.4MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 9060.4->9084.8MB | peak: 9104.8MB
[PROFILE] compute_H_b_1_MPS: 57.3ms | mem: 8876.4->9044.8MB | peak: 9104.8MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 9044.8->9044.8MB | peak: 9044.8MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 9044.8->9044.8MB | peak: 9044.8MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 9044.8->9064.8MB | peak: 9084.8MB
[PROFILE] env_0_MPS: 0.9ms | mem: 9064.8->9072.3MB | peak: 9088.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9072.3->9072.3MB | peak: 9072.3MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 9072.3->9072.3MB | peak: 9072.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9072.3->9072.8MB | peak: 9072.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9072.8->9072.8MB | peak: 9072.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9072.8->9073.5MB | peak: 9074.0MB
[PROFILE] env_0_MPS: 1.0ms | mem: 9073.5->9081.1MB | peak: 9097.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9081.1->9081.1MB | peak: 9081.1MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 9081.1->9081.1MB | peak: 9081.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9081.1->9081.6MB | peak: 9081.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9081.6->9081.6MB | peak: 9081.6MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9081.6->9082.3MB | peak: 9082.8MB
[PROFILE] env_0_MPS: 1.1ms | mem: 9082.3->9089.9MB | peak: 9106.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9089.9->9089.9MB | peak: 9089.9MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 9089.9->9089.9MB | peak: 9089.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9089.9->9090.5MB | peak: 9090.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9090.5->9090.5MB | peak: 9090.5MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 9090.5->9091.1MB | peak: 9091.6MB
[PROFILE] env_0_MPS: 1.2ms | mem: 9091.0->9098.6MB | peak: 9115.2MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9098.6->9098.6MB | peak: 9098.6MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 9098.6->9098.6MB | peak: 9098.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9098.6->9099.1MB | peak: 9099.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9099.1->9099.1MB | peak: 9099.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9099.1->9099.8MB | peak: 9100.3MB
[PROFILE] env_0_MPS: 1.0ms | mem: 9099.7->9107.3MB | peak: 9123.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9107.3->9107.3MB | peak: 9107.3MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 9107.3->9107.3MB | peak: 9107.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9107.3->9107.8MB | peak: 9107.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9107.8->9107.8MB | peak: 9107.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9107.8->9108.5MB | peak: 9109.0MB
[PROFILE] env_0_MPS: 0.9ms | mem: 9108.3->9114.2MB | peak: 9125.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9114.2->9114.2MB | peak: 9114.2MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 9114.2->9114.2MB | peak: 9114.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9114.2->9114.6MB | peak: 9114.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9114.6->9114.6MB | peak: 9114.6MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 9114.6->9115.1MB | peak: 9115.4MB
[PROFILE] compute_H_b_0_MPS: 34.7ms | mem: 9064.8->9114.8MB | peak: 9115.4MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 9114.8->9114.8MB | peak: 9114.8MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 9114.8->9114.8MB | peak: 9114.8MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 9114.8->9114.9MB | peak: 9115.1MB
[PROFILE] env_1_MPS: 1.3ms | mem: 9114.9->9128.2MB | peak: 9134.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9128.2->9128.3MB | peak: 9128.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 9128.3->9128.3MB | peak: 9128.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9128.3->9134.5MB | peak: 9134.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9134.5->9134.5MB | peak: 9134.5MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 9134.5->9160.6MB | peak: 9180.6MB
[PROFILE] env_1_MPS: 1.1ms | mem: 9160.6->9174.5MB | peak: 9180.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9174.5->9174.5MB | peak: 9174.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 9174.5->9174.5MB | peak: 9174.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9174.5->9180.7MB | peak: 9180.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9180.7->9180.7MB | peak: 9180.7MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 9180.7->9206.9MB | peak: 9226.9MB
[PROFILE] env_1_MPS: 1.3ms | mem: 9206.9->9220.2MB | peak: 9226.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9220.2->9220.2MB | peak: 9220.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 9220.2->9220.2MB | peak: 9220.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9220.2->9226.4MB | peak: 9226.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9226.4->9226.4MB | peak: 9226.4MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 9226.4->9252.6MB | peak: 9272.6MB
[PROFILE] env_1_MPS: 1.3ms | mem: 9232.6->9246.5MB | peak: 9252.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9246.5->9246.5MB | peak: 9246.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 9246.5->9246.5MB | peak: 9246.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9246.5->9252.7MB | peak: 9252.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9252.7->9252.7MB | peak: 9252.7MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 9252.7->9278.9MB | peak: 9298.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 9258.8->9272.7MB | peak: 9278.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9272.7->9272.7MB | peak: 9272.7MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 9272.7->9272.7MB | peak: 9272.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9272.7->9278.9MB | peak: 9278.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9278.9->9278.9MB | peak: 9278.9MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 9278.9->9305.1MB | peak: 9325.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 9285.1->9294.5MB | peak: 9298.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9294.5->9294.5MB | peak: 9294.5MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 9294.5->9294.5MB | peak: 9294.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9294.5->9298.9MB | peak: 9299.0MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 9298.9->9298.9MB | peak: 9298.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 9298.9->9324.0MB | peak: 9344.0MB
[PROFILE] compute_H_b_1_MPS: 38.9ms | mem: 9114.9->9284.0MB | peak: 9344.0MB
[PROFILE] fuse_1_MPS: 0.0ms | mem: 9284.0->9284.0MB | peak: 9284.0MB
[PROFILE] to_dense_1_MPS: 0.0ms | mem: 9284.0->9284.0MB | peak: 9284.0MB
[PROFILE] solve_1_MPS: 3.8ms | mem: 9284.0->9304.0MB | peak: 9324.0MB
[PROFILE] env_2_MPS: 0.1ms | mem: 9304.0->9317.4MB | peak: 9323.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9317.4->9317.4MB | peak: 9317.4MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 9317.4->9317.4MB | peak: 9317.4MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 9317.4->9323.6MB | peak: 9323.6MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 9323.6->9323.6MB | peak: 9323.6MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 9323.6->9349.8MB | peak: 9369.8MB
[PROFILE] env_2_MPS: 0.1ms | mem: 9349.8->9363.8MB | peak: 9370.0MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 9363.8->9363.8MB | peak: 9363.8MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 9363.8->9363.8MB | peak: 9363.8MB
[PROFILE] grad_contract_2_MPS: 0.4ms | mem: 9363.8->9370.0MB | peak: 9370.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9370.0->9370.0MB | peak: 9370.0MB
[PROFILE] hess_contract_2_MPS: 2.1ms | mem: 9370.0->9396.2MB | peak: 9416.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 9396.2->9409.6MB | peak: 9415.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9409.6->9409.6MB | peak: 9409.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 9409.6->9409.6MB | peak: 9409.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9409.6->9415.8MB | peak: 9415.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9415.8->9415.8MB | peak: 9415.8MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 9415.8->9442.0MB | peak: 9462.0MB
[PROFILE] env_2_MPS: 1.4ms | mem: 9422.0->9436.0MB | peak: 9442.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9436.0->9436.0MB | peak: 9436.0MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 9436.0->9436.0MB | peak: 9436.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9436.0->9442.2MB | peak: 9442.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9442.2->9442.2MB | peak: 9442.2MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 9442.2->9468.4MB | peak: 9488.4MB
[PROFILE] env_2_MPS: 1.3ms | mem: 9448.4->9462.3MB | peak: 9468.5MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 9462.3->9462.3MB | peak: 9462.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 9462.3->9462.3MB | peak: 9462.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9462.3->9468.5MB | peak: 9468.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9468.5->9468.5MB | peak: 9468.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 9468.5->9494.7MB | peak: 9514.7MB
[PROFILE] env_2_MPS: 1.2ms | mem: 9474.7->9484.3MB | peak: 9489.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9484.3->9484.3MB | peak: 9484.3MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 9484.3->9484.3MB | peak: 9484.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9484.3->9488.7MB | peak: 9488.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9488.7->9488.7MB | peak: 9488.7MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 9488.7->9513.1MB | peak: 9533.1MB
[PROFILE] compute_H_b_2_MPS: 46.0ms | mem: 9304.0->9473.0MB | peak: 9533.1MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 9473.0->9473.0MB | peak: 9473.0MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 9473.0->9473.0MB | peak: 9473.0MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 9473.1->9493.1MB | peak: 9513.1MB
[PROFILE] env_3_MPS: 1.0ms | mem: 9493.1->9496.1MB | peak: 9513.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 9496.1->9496.6MB | peak: 9496.6MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 9496.6->9496.6MB | peak: 9496.6MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 9496.6->9497.1MB | peak: 9497.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 9497.1->9497.1MB | peak: 9497.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 9497.1->9498.3MB | peak: 9498.8MB
[PROFILE] env_3_MPS: 1.4ms | mem: 9497.8->9500.8MB | peak: 9517.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 9500.8->9501.3MB | peak: 9501.3MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 9501.3->9501.3MB | peak: 9501.3MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 9501.3->9501.8MB | peak: 9501.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 9501.8->9501.8MB | peak: 9501.8MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 9501.8->9503.0MB | peak: 9503.5MB
[PROFILE] env_3_MPS: 1.0ms | mem: 9502.5->9505.5MB | peak: 9522.5MB
[PROFILE] forward_3_MPS: 0.8ms | mem: 9505.5->9506.0MB | peak: 9506.0MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 9506.0->9506.0MB | peak: 9506.1MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 9506.0->9506.6MB | peak: 9506.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 9506.6->9506.6MB | peak: 9506.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 9506.6->9507.7MB | peak: 9508.2MB
[PROFILE] env_3_MPS: 1.0ms | mem: 9507.1->9510.1MB | peak: 9527.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 9510.1->9510.6MB | peak: 9510.6MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 9510.6->9510.6MB | peak: 9510.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 9510.6->9511.1MB | peak: 9511.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 9511.1->9511.1MB | peak: 9511.1MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 9511.1->9512.3MB | peak: 9512.8MB
[PROFILE] env_3_MPS: 1.2ms | mem: 9511.7->9514.7MB | peak: 9531.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 9514.7->9515.2MB | peak: 9515.2MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 9515.2->9515.2MB | peak: 9515.2MB
[PROFILE] grad_contract_3_MPS: 0.7ms | mem: 9515.2->9515.7MB | peak: 9515.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 9515.7->9515.7MB | peak: 9515.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 9515.7->9516.9MB | peak: 9517.4MB
[PROFILE] env_3_MPS: 1.0ms | mem: 9516.2->9518.8MB | peak: 9531.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 9518.8->9519.2MB | peak: 9519.2MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 9519.2->9519.2MB | peak: 9519.2MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 9519.2->9519.6MB | peak: 9519.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 9519.6->9519.6MB | peak: 9519.6MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 9519.6->9520.4MB | peak: 9520.8MB
[PROFILE] compute_H_b_3_MPS: 35.7ms | mem: 9493.1->9519.8MB | peak: 9520.8MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 9519.8->9519.8MB | peak: 9519.8MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 9519.8->9519.8MB | peak: 9519.8MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 9519.8->9519.9MB | peak: 9520.1MB
[PROFILE] env_2_MPS: 1.3ms | mem: 9519.9->9533.4MB | peak: 9539.6MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 9533.4->9533.4MB | peak: 9533.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 9533.4->9533.4MB | peak: 9533.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9533.4->9539.6MB | peak: 9539.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9539.6->9539.6MB | peak: 9539.6MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 9539.6->9565.8MB | peak: 9585.8MB
[PROFILE] env_2_MPS: 1.3ms | mem: 9565.8->9579.7MB | peak: 9585.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9579.7->9579.7MB | peak: 9579.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 9579.7->9579.8MB | peak: 9579.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9579.8->9586.0MB | peak: 9586.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9586.0->9586.0MB | peak: 9586.0MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 9586.0->9612.1MB | peak: 9632.1MB
[PROFILE] env_2_MPS: 1.3ms | mem: 9612.1->9625.6MB | peak: 9631.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9625.6->9625.6MB | peak: 9625.6MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 9625.6->9625.6MB | peak: 9625.6MB
[PROFILE] grad_contract_2_MPS: 0.7ms | mem: 9625.6->9631.8MB | peak: 9631.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9631.8->9631.8MB | peak: 9631.8MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 9631.8->9658.0MB | peak: 9678.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 9638.0->9651.9MB | peak: 9658.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 9651.9->9651.9MB | peak: 9651.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 9651.9->9651.9MB | peak: 9652.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9651.9->9658.1MB | peak: 9658.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 9658.1->9658.1MB | peak: 9658.1MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 9658.1->9684.3MB | peak: 9704.3MB
[PROFILE] env_2_MPS: 1.3ms | mem: 9664.3->9678.3MB | peak: 9684.5MB
[PROFILE] forward_2_MPS: 1.7ms | mem: 9678.3->9678.3MB | peak: 9678.3MB
[PROFILE] loss_derivs_2_MPS: 2.8ms | mem: 9678.3->9678.3MB | peak: 9678.3MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 9678.3->9684.5MB | peak: 9684.5MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 9684.5->9684.5MB | peak: 9684.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 9684.5->9710.7MB | peak: 9730.7MB
[PROFILE] env_2_MPS: 0.1ms | mem: 9690.7->9700.2MB | peak: 9705.0MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 9700.2->9700.2MB | peak: 9700.2MB
[PROFILE] loss_derivs_2_MPS: 0.3ms | mem: 9700.2->9700.2MB | peak: 9700.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 9700.2->9704.6MB | peak: 9704.7MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 9704.6->9704.6MB | peak: 9704.6MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 9704.6->9729.0MB | peak: 9749.0MB
[PROFILE] compute_H_b_2_MPS: 53.5ms | mem: 9519.9->9689.0MB | peak: 9749.0MB
[PROFILE] fuse_2_MPS: 0.0ms | mem: 9689.0->9689.0MB | peak: 9689.0MB
[PROFILE] to_dense_2_MPS: 0.0ms | mem: 9689.0->9689.0MB | peak: 9689.0MB
[PROFILE] solve_2_MPS: 1.7ms | mem: 9689.0->9709.0MB | peak: 9729.0MB
[PROFILE] env_1_MPS: 1.6ms | mem: 9709.0->9722.4MB | peak: 9728.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9722.4->9722.4MB | peak: 9722.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 9722.4->9722.4MB | peak: 9722.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9722.4->9728.6MB | peak: 9728.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9728.6->9728.6MB | peak: 9728.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 9728.6->9754.8MB | peak: 9774.8MB
[PROFILE] env_1_MPS: 1.3ms | mem: 9754.8->9768.6MB | peak: 9774.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9768.6->9768.6MB | peak: 9768.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 9768.6->9768.6MB | peak: 9768.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9768.6->9774.8MB | peak: 9774.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9774.8->9774.8MB | peak: 9774.8MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 9774.8->9801.0MB | peak: 9821.0MB
[PROFILE] env_1_MPS: 1.3ms | mem: 9801.0->9814.3MB | peak: 9820.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9814.3->9814.3MB | peak: 9814.3MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 9814.3->9814.3MB | peak: 9814.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9814.3->9820.5MB | peak: 9820.6MB
[PROFILE] hess_tn_build_1_MPS: 0.6ms | mem: 9820.5->9820.5MB | peak: 9820.5MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 9820.5->9846.7MB | peak: 9866.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 9826.7->9840.6MB | peak: 9846.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9840.6->9840.6MB | peak: 9840.6MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 9840.6->9840.6MB | peak: 9840.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9840.6->9846.8MB | peak: 9846.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9846.8->9846.8MB | peak: 9846.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 9846.8->9873.0MB | peak: 9893.0MB
[PROFILE] env_1_MPS: 1.0ms | mem: 9853.0->9866.8MB | peak: 9873.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9866.8->9866.8MB | peak: 9866.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 9866.8->9866.8MB | peak: 9866.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9866.8->9873.0MB | peak: 9873.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9873.0->9873.0MB | peak: 9873.0MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 9873.0->9899.2MB | peak: 9919.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 9879.2->9888.6MB | peak: 9893.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9888.6->9888.6MB | peak: 9888.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 9888.6->9888.7MB | peak: 9888.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9888.7->9893.1MB | peak: 9893.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 9893.1->9893.1MB | peak: 9893.1MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 9893.1->9917.4MB | peak: 9937.4MB
[PROFILE] compute_H_b_1_MPS: 38.1ms | mem: 9709.0->9877.4MB | peak: 9937.4MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 9877.4->9877.4MB | peak: 9877.4MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 9877.4->9877.4MB | peak: 9877.4MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 9877.4->9897.5MB | peak: 9917.5MB
[PROFILE] env_0_MPS: 0.9ms | mem: 9897.4->9904.9MB | peak: 9921.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9904.9->9904.9MB | peak: 9904.9MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 9904.9->9904.9MB | peak: 9904.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9904.9->9905.5MB | peak: 9905.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9905.5->9905.5MB | peak: 9905.5MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9905.5->9906.1MB | peak: 9906.6MB
[PROFILE] env_0_MPS: 1.1ms | mem: 9906.1->9913.7MB | peak: 9930.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9913.7->9913.7MB | peak: 9913.7MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 9913.7->9913.7MB | peak: 9913.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9913.7->9914.3MB | peak: 9914.3MB
[PROFILE] hess_tn_build_0_MPS: 0.5ms | mem: 9914.3->9914.3MB | peak: 9914.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 9914.3->9914.9MB | peak: 9915.4MB
[PROFILE] env_0_MPS: 1.2ms | mem: 9914.9->9922.6MB | peak: 9939.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9922.6->9922.6MB | peak: 9922.6MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 9922.6->9922.6MB | peak: 9922.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9922.6->9923.1MB | peak: 9923.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9923.1->9923.1MB | peak: 9923.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9923.1->9923.7MB | peak: 9924.2MB
[PROFILE] env_0_MPS: 1.0ms | mem: 9923.6->9931.2MB | peak: 9947.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9931.2->9931.2MB | peak: 9931.3MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 9931.2->9931.3MB | peak: 9931.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9931.3->9931.8MB | peak: 9931.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9931.8->9931.8MB | peak: 9931.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9931.8->9932.4MB | peak: 9932.9MB
[PROFILE] env_0_MPS: 0.9ms | mem: 9932.3->9939.9MB | peak: 9956.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9939.9->9939.9MB | peak: 9939.9MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 9939.9->9939.9MB | peak: 9940.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9939.9->9940.5MB | peak: 9940.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9940.5->9940.5MB | peak: 9940.5MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 9940.5->9941.1MB | peak: 9941.6MB
[PROFILE] env_0_MPS: 1.0ms | mem: 9941.0->9946.8MB | peak: 9958.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 9946.8->9946.8MB | peak: 9946.8MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 9946.8->9946.8MB | peak: 9946.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 9946.8->9947.2MB | peak: 9947.2MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 9947.2->9947.2MB | peak: 9947.2MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 9947.2->9947.7MB | peak: 9948.0MB
[PROFILE] compute_H_b_0_MPS: 34.5ms | mem: 9897.4->9947.4MB | peak: 9948.0MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 9947.4->9947.4MB | peak: 9947.4MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 9947.4->9947.4MB | peak: 9947.4MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 9947.4->9947.5MB | peak: 9947.7MB
[PROFILE] env_1_MPS: 1.3ms | mem: 9947.5->9960.9MB | peak: 9967.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 9960.9->9960.9MB | peak: 9960.9MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 9960.9->9960.9MB | peak: 9960.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 9960.9->9967.1MB | peak: 9967.1MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 9967.1->9967.1MB | peak: 9967.1MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 9967.1->9993.3MB | peak: 10013.3MB
[PROFILE] env_1_MPS: 2.1ms | mem: 9993.3->10007.1MB | peak: 10013.3MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 10007.1->10007.1MB | peak: 10007.1MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 10007.1->10007.1MB | peak: 10007.1MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 10007.1->10013.3MB | peak: 10013.3MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 10013.3->10013.3MB | peak: 10013.3MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 10013.3->10039.5MB | peak: 10059.5MB
[PROFILE] env_1_MPS: 0.1ms | mem: 10039.5->10052.9MB | peak: 10059.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10052.9->10052.9MB | peak: 10052.9MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 10052.9->10052.9MB | peak: 10052.9MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 10052.9->10059.1MB | peak: 10059.1MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 10059.1->10059.1MB | peak: 10059.1MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 10059.1->10085.3MB | peak: 10105.3MB
[PROFILE] env_1_MPS: 0.1ms | mem: 10065.2->10079.1MB | peak: 10085.3MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 10079.1->10079.1MB | peak: 10079.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 10079.1->10079.1MB | peak: 10079.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10079.1->10085.3MB | peak: 10085.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10085.3->10085.3MB | peak: 10085.3MB
[PROFILE] hess_contract_1_MPS: 1.3ms | mem: 10085.3->10111.5MB | peak: 10131.5MB
[PROFILE] env_1_MPS: 1.1ms | mem: 10091.5->10105.3MB | peak: 10111.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10105.3->10105.3MB | peak: 10105.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 10105.3->10105.3MB | peak: 10105.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10105.3->10111.5MB | peak: 10111.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10111.5->10111.5MB | peak: 10111.5MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 10111.5->10137.7MB | peak: 10157.7MB
[PROFILE] env_1_MPS: 1.1ms | mem: 10117.7->10127.2MB | peak: 10131.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10127.2->10127.2MB | peak: 10127.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 10127.2->10127.2MB | peak: 10127.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10127.2->10131.6MB | peak: 10131.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10131.6->10131.6MB | peak: 10131.6MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 10131.6->10156.6MB | peak: 10176.6MB
[PROFILE] compute_H_b_1_MPS: 55.8ms | mem: 9947.5->10116.6MB | peak: 10176.6MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 10116.6->10116.6MB | peak: 10116.6MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 10116.6->10116.6MB | peak: 10116.6MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 10116.6->10136.6MB | peak: 10156.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 10136.6->10150.1MB | peak: 10156.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10150.1->10150.1MB | peak: 10150.1MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 10150.1->10150.1MB | peak: 10150.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10150.1->10156.3MB | peak: 10156.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10156.3->10156.3MB | peak: 10156.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 10156.3->10182.5MB | peak: 10202.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 10182.5->10196.4MB | peak: 10202.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10196.4->10196.4MB | peak: 10196.4MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 10196.4->10196.4MB | peak: 10196.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10196.4->10202.6MB | peak: 10202.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10202.6->10202.6MB | peak: 10202.6MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 10202.6->10228.8MB | peak: 10248.8MB
[PROFILE] env_2_MPS: 1.3ms | mem: 10228.8->10242.3MB | peak: 10248.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10242.3->10242.3MB | peak: 10242.3MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 10242.3->10242.3MB | peak: 10242.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10242.3->10248.5MB | peak: 10248.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10248.5->10248.5MB | peak: 10248.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 10248.5->10274.7MB | peak: 10294.7MB
[PROFILE] env_2_MPS: 1.2ms | mem: 10254.6->10268.6MB | peak: 10274.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10268.6->10268.6MB | peak: 10268.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 10268.6->10268.6MB | peak: 10268.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10268.6->10274.8MB | peak: 10274.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10274.8->10274.8MB | peak: 10274.8MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 10274.8->10301.0MB | peak: 10321.0MB
[PROFILE] env_2_MPS: 1.1ms | mem: 10281.0->10294.9MB | peak: 10301.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10294.9->10294.9MB | peak: 10295.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 10294.9->10295.0MB | peak: 10295.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10295.0->10301.2MB | peak: 10301.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10301.2->10301.2MB | peak: 10301.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 10301.2->10327.3MB | peak: 10347.3MB
[PROFILE] env_2_MPS: 1.3ms | mem: 10307.3->10316.9MB | peak: 10321.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10316.9->10316.9MB | peak: 10316.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 10316.9->10316.9MB | peak: 10316.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10316.9->10321.3MB | peak: 10321.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10321.3->10321.3MB | peak: 10321.3MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 10321.3->10345.7MB | peak: 10365.7MB
[PROFILE] compute_H_b_2_MPS: 37.2ms | mem: 10136.6->10305.7MB | peak: 10365.7MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 10305.7->10305.7MB | peak: 10305.7MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 10305.7->10305.7MB | peak: 10305.7MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 10305.7->10325.7MB | peak: 10345.7MB
[PROFILE] env_3_MPS: 1.2ms | mem: 10325.7->10328.7MB | peak: 10345.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 10328.7->10329.2MB | peak: 10329.2MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 10329.2->10329.2MB | peak: 10329.3MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 10329.2->10329.8MB | peak: 10329.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 10329.8->10329.8MB | peak: 10329.8MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 10329.8->10330.9MB | peak: 10331.4MB
[PROFILE] env_3_MPS: 1.2ms | mem: 10330.4->10333.4MB | peak: 10350.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 10333.4->10334.0MB | peak: 10334.0MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 10334.0->10334.0MB | peak: 10334.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 10334.0->10334.5MB | peak: 10334.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 10334.5->10334.5MB | peak: 10334.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 10334.5->10335.6MB | peak: 10336.2MB
[PROFILE] env_3_MPS: 1.2ms | mem: 10335.1->10338.1MB | peak: 10355.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 10338.1->10338.7MB | peak: 10338.7MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 10338.7->10338.7MB | peak: 10338.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 10338.7->10339.2MB | peak: 10339.2MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 10339.2->10339.2MB | peak: 10339.2MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 10339.2->10340.4MB | peak: 10340.9MB
[PROFILE] env_3_MPS: 1.2ms | mem: 10339.7->10342.7MB | peak: 10359.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 10342.7->10343.2MB | peak: 10343.2MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 10343.2->10343.3MB | peak: 10343.3MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 10343.3->10343.8MB | peak: 10343.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 10343.8->10343.8MB | peak: 10343.8MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 10343.8->10344.9MB | peak: 10345.5MB
[PROFILE] env_3_MPS: 1.2ms | mem: 10344.3->10347.3MB | peak: 10364.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 10347.3->10347.8MB | peak: 10347.8MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 10347.8->10347.8MB | peak: 10347.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 10347.8->10348.4MB | peak: 10348.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 10348.4->10348.4MB | peak: 10348.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 10348.4->10349.5MB | peak: 10350.0MB
[PROFILE] env_3_MPS: 1.0ms | mem: 10348.9->10351.5MB | peak: 10363.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 10351.5->10351.8MB | peak: 10351.8MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 10351.8->10351.8MB | peak: 10351.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 10351.8->10352.2MB | peak: 10352.2MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 10352.2->10352.2MB | peak: 10352.2MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 10352.2->10353.1MB | peak: 10353.4MB
[PROFILE] compute_H_b_3_MPS: 36.5ms | mem: 10325.7->10352.4MB | peak: 10353.4MB
[PROFILE] fuse_3_MPS: 0.0ms | mem: 10352.4->10352.4MB | peak: 10352.4MB
[PROFILE] to_dense_3_MPS: 0.0ms | mem: 10352.4->10352.4MB | peak: 10352.4MB
[PROFILE] solve_3_MPS: 1.9ms | mem: 10352.4->10352.6MB | peak: 10352.7MB
[PROFILE] env_2_MPS: 3.1ms | mem: 10352.6->10366.0MB | peak: 10372.2MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 10366.0->10366.0MB | peak: 10366.0MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 10366.0->10366.0MB | peak: 10366.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10366.0->10372.2MB | peak: 10372.2MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 10372.2->10372.2MB | peak: 10372.2MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 10372.2->10398.4MB | peak: 10418.4MB
[PROFILE] env_2_MPS: 2.6ms | mem: 10398.4->10412.4MB | peak: 10418.6MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 10412.4->10412.4MB | peak: 10412.4MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 10412.4->10412.4MB | peak: 10412.4MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 10412.4->10418.6MB | peak: 10418.6MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 10418.6->10418.6MB | peak: 10418.6MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 10418.6->10444.8MB | peak: 10464.8MB
[PROFILE] env_2_MPS: 1.6ms | mem: 10444.8->10458.2MB | peak: 10464.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10458.2->10458.2MB | peak: 10458.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 10458.2->10458.2MB | peak: 10458.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10458.2->10464.4MB | peak: 10464.4MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 10464.4->10464.4MB | peak: 10464.4MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 10464.4->10490.6MB | peak: 10510.6MB
[PROFILE] env_2_MPS: 1.1ms | mem: 10470.6->10484.6MB | peak: 10490.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10484.6->10484.6MB | peak: 10484.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 10484.6->10484.6MB | peak: 10484.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10484.6->10490.8MB | peak: 10490.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10490.8->10490.8MB | peak: 10490.8MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 10490.8->10517.0MB | peak: 10537.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 10496.9->10510.9MB | peak: 10517.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10510.9->10510.9MB | peak: 10510.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 10510.9->10510.9MB | peak: 10510.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10510.9->10517.1MB | peak: 10517.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10517.1->10517.1MB | peak: 10517.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 10517.1->10543.3MB | peak: 10563.3MB
[PROFILE] env_2_MPS: 1.1ms | mem: 10523.3->10532.9MB | peak: 10537.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10532.9->10532.9MB | peak: 10532.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 10532.9->10532.9MB | peak: 10532.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10532.9->10537.3MB | peak: 10537.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10537.3->10537.3MB | peak: 10537.3MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 10537.3->10561.7MB | peak: 10581.7MB
[PROFILE] compute_H_b_2_MPS: 51.6ms | mem: 10352.6->10521.6MB | peak: 10581.7MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 10521.6->10521.6MB | peak: 10521.6MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 10521.6->10521.6MB | peak: 10521.6MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 10521.6->10541.7MB | peak: 10561.7MB
[PROFILE] env_1_MPS: 1.3ms | mem: 10541.7->10555.0MB | peak: 10561.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10555.0->10555.0MB | peak: 10555.0MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 10555.0->10555.0MB | peak: 10555.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10555.0->10561.2MB | peak: 10561.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10561.2->10561.2MB | peak: 10561.2MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 10561.2->10587.4MB | peak: 10607.4MB
[PROFILE] env_1_MPS: 1.2ms | mem: 10587.4->10601.2MB | peak: 10607.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10601.2->10601.2MB | peak: 10601.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 10601.2->10601.2MB | peak: 10601.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10601.2->10607.4MB | peak: 10607.5MB
[PROFILE] hess_tn_build_1_MPS: 0.5ms | mem: 10607.4->10607.4MB | peak: 10607.4MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 10607.4->10633.6MB | peak: 10653.6MB
[PROFILE] env_1_MPS: 1.1ms | mem: 10633.6->10647.0MB | peak: 10653.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10647.0->10647.0MB | peak: 10647.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 10647.0->10647.0MB | peak: 10647.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10647.0->10653.2MB | peak: 10653.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10653.2->10653.2MB | peak: 10653.2MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 10653.2->10679.4MB | peak: 10699.4MB
[PROFILE] env_1_MPS: 1.3ms | mem: 10659.3->10673.2MB | peak: 10679.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10673.2->10673.2MB | peak: 10673.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 10673.2->10673.2MB | peak: 10673.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10673.2->10679.4MB | peak: 10679.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10679.4->10679.4MB | peak: 10679.4MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 10679.4->10705.6MB | peak: 10725.6MB
[PROFILE] env_1_MPS: 1.2ms | mem: 10685.6->10699.4MB | peak: 10705.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10699.4->10699.4MB | peak: 10699.4MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 10699.4->10699.4MB | peak: 10699.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10699.4->10705.6MB | peak: 10705.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10705.6->10705.6MB | peak: 10705.6MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 10705.6->10731.8MB | peak: 10751.8MB
[PROFILE] env_1_MPS: 1.4ms | mem: 10711.8->10721.3MB | peak: 10725.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10721.3->10721.3MB | peak: 10721.3MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 10721.3->10721.3MB | peak: 10721.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10721.3->10725.7MB | peak: 10725.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10725.7->10725.7MB | peak: 10725.7MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 10725.7->10750.1MB | peak: 10770.1MB
[PROFILE] compute_H_b_1_MPS: 37.3ms | mem: 10541.7->10710.0MB | peak: 10770.1MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 10710.0->10710.0MB | peak: 10710.0MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 10710.0->10710.0MB | peak: 10710.0MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 10710.1->10730.1MB | peak: 10750.1MB
[PROFILE] env_0_MPS: 0.9ms | mem: 10730.1->10737.6MB | peak: 10754.1MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 10737.6->10737.6MB | peak: 10737.6MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 10737.6->10737.6MB | peak: 10737.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 10737.6->10738.1MB | peak: 10738.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 10738.1->10738.1MB | peak: 10738.1MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 10738.1->10738.7MB | peak: 10739.2MB
[PROFILE] env_0_MPS: 1.0ms | mem: 10738.7->10746.4MB | peak: 10762.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 10746.4->10746.4MB | peak: 10746.4MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 10746.4->10746.4MB | peak: 10746.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 10746.4->10746.9MB | peak: 10746.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 10746.9->10746.9MB | peak: 10746.9MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 10746.9->10747.5MB | peak: 10748.1MB
[PROFILE] env_0_MPS: 1.1ms | mem: 10747.5->10755.2MB | peak: 10771.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 10755.2->10755.2MB | peak: 10755.2MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 10755.2->10755.2MB | peak: 10755.2MB
[PROFILE] grad_contract_0_MPS: 0.4ms | mem: 10755.2->10755.7MB | peak: 10755.7MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 10755.7->10755.7MB | peak: 10755.7MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 10755.7->10756.4MB | peak: 10756.9MB
[PROFILE] env_0_MPS: 0.7ms | mem: 10756.2->10763.9MB | peak: 10780.4MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 10763.9->10763.9MB | peak: 10763.9MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 10763.9->10763.9MB | peak: 10763.9MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 10763.9->10764.4MB | peak: 10764.4MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 10764.4->10764.4MB | peak: 10764.4MB
[PROFILE] hess_contract_0_MPS: 0.4ms | mem: 10764.4->10765.1MB | peak: 10765.6MB
[PROFILE] env_0_MPS: 0.2ms | mem: 10764.9->10772.6MB | peak: 10789.1MB
[PROFILE] forward_0_MPS: 2.4ms | mem: 10772.6->10772.6MB | peak: 10772.6MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 10772.6->10772.6MB | peak: 10772.6MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 10772.6->10773.1MB | peak: 10773.1MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 10773.1->10773.1MB | peak: 10773.1MB
[PROFILE] hess_contract_0_MPS: 0.4ms | mem: 10773.1->10773.7MB | peak: 10774.2MB
[PROFILE] env_0_MPS: 0.8ms | mem: 10773.6->10779.4MB | peak: 10791.2MB
[PROFILE] forward_0_MPS: 0.8ms | mem: 10779.4->10779.4MB | peak: 10779.4MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 10779.4->10779.4MB | peak: 10779.5MB
[PROFILE] grad_contract_0_MPS: 0.4ms | mem: 10779.4->10779.8MB | peak: 10779.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 10779.8->10779.8MB | peak: 10779.8MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 10779.8->10780.3MB | peak: 10780.7MB
[PROFILE] compute_H_b_0_MPS: 53.7ms | mem: 10730.1->10780.0MB | peak: 10780.7MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 10780.0->10780.0MB | peak: 10780.0MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 10780.0->10780.0MB | peak: 10780.0MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 10780.0->10780.2MB | peak: 10780.3MB
[PROFILE] env_1_MPS: 1.1ms | mem: 10780.2->10793.5MB | peak: 10799.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10793.5->10793.5MB | peak: 10793.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 10793.5->10793.5MB | peak: 10793.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10793.5->10799.7MB | peak: 10799.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10799.7->10799.7MB | peak: 10799.7MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 10799.7->10825.9MB | peak: 10845.9MB
[PROFILE] env_1_MPS: 1.3ms | mem: 10825.9->10839.8MB | peak: 10845.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10839.8->10839.8MB | peak: 10839.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 10839.8->10839.8MB | peak: 10839.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10839.8->10846.0MB | peak: 10846.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10846.0->10846.0MB | peak: 10846.0MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 10846.0->10872.2MB | peak: 10892.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 10872.2->10885.5MB | peak: 10891.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10885.5->10885.5MB | peak: 10885.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 10885.5->10885.5MB | peak: 10885.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10885.5->10891.7MB | peak: 10891.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10891.7->10891.7MB | peak: 10891.7MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 10891.7->10917.9MB | peak: 10937.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 10897.9->10911.7MB | peak: 10917.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10911.7->10911.7MB | peak: 10911.7MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 10911.7->10911.7MB | peak: 10911.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10911.7->10917.9MB | peak: 10917.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10917.9->10917.9MB | peak: 10917.9MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 10917.9->10944.1MB | peak: 10964.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 10924.1->10937.9MB | peak: 10944.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10937.9->10938.0MB | peak: 10938.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 10938.0->10938.0MB | peak: 10938.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10938.0->10944.2MB | peak: 10944.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10944.2->10944.2MB | peak: 10944.2MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 10944.2->10970.3MB | peak: 10990.3MB
[PROFILE] env_1_MPS: 1.3ms | mem: 10950.3->10959.8MB | peak: 10964.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 10959.8->10959.8MB | peak: 10959.8MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 10959.8->10959.8MB | peak: 10959.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 10959.8->10964.2MB | peak: 10964.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 10964.2->10964.2MB | peak: 10964.2MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 10964.2->10989.2MB | peak: 11009.2MB
[PROFILE] compute_H_b_1_MPS: 37.4ms | mem: 10780.2->10949.2MB | peak: 11009.2MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 10949.2->10949.2MB | peak: 10949.2MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 10949.2->10949.2MB | peak: 10949.2MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 10949.2->10969.3MB | peak: 10989.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 10969.2->10982.7MB | peak: 10988.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 10982.7->10982.7MB | peak: 10982.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 10982.7->10982.7MB | peak: 10982.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 10982.7->10988.9MB | peak: 10988.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 10988.9->10988.9MB | peak: 10988.9MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 10988.9->11015.1MB | peak: 11035.1MB
[PROFILE] env_2_MPS: 1.2ms | mem: 11015.1->11029.0MB | peak: 11035.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11029.0->11029.0MB | peak: 11029.0MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 11029.0->11029.1MB | peak: 11029.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11029.1->11035.3MB | peak: 11035.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11035.3->11035.3MB | peak: 11035.3MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 11035.3->11061.4MB | peak: 11081.4MB
[PROFILE] env_2_MPS: 1.1ms | mem: 11061.4->11074.9MB | peak: 11081.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11074.9->11074.9MB | peak: 11074.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 11074.9->11074.9MB | peak: 11074.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11074.9->11081.1MB | peak: 11081.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11081.1->11081.1MB | peak: 11081.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 11081.1->11107.3MB | peak: 11127.3MB
[PROFILE] env_2_MPS: 1.3ms | mem: 11087.3->11101.2MB | peak: 11107.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11101.2->11101.2MB | peak: 11101.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 11101.2->11101.2MB | peak: 11101.3MB
[PROFILE] grad_contract_2_MPS: 0.7ms | mem: 11101.2->11107.4MB | peak: 11107.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11107.4->11107.4MB | peak: 11107.4MB
[PROFILE] hess_contract_2_MPS: 0.5ms | mem: 11107.4->11133.6MB | peak: 11153.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 11113.6->11127.6MB | peak: 11133.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11127.6->11127.6MB | peak: 11127.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 11127.6->11127.6MB | peak: 11127.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11127.6->11133.8MB | peak: 11133.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11133.8->11133.8MB | peak: 11133.8MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 11133.8->11160.0MB | peak: 11180.0MB
[PROFILE] env_2_MPS: 1.1ms | mem: 11140.0->11149.5MB | peak: 11154.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11149.5->11149.5MB | peak: 11149.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 11149.5->11149.5MB | peak: 11149.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11149.5->11153.9MB | peak: 11153.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11153.9->11153.9MB | peak: 11153.9MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 11153.9->11178.3MB | peak: 11198.3MB
[PROFILE] compute_H_b_2_MPS: 37.6ms | mem: 10969.2->11138.3MB | peak: 11198.3MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 11138.3->11138.3MB | peak: 11138.3MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 11138.3->11138.3MB | peak: 11138.3MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 11138.3->11158.3MB | peak: 11178.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 11158.3->11161.3MB | peak: 11178.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11161.3->11161.9MB | peak: 11161.9MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 11161.9->11161.9MB | peak: 11161.9MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 11161.9->11162.4MB | peak: 11162.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 11162.4->11162.4MB | peak: 11162.4MB
[PROFILE] hess_contract_3_MPS: 0.7ms | mem: 11162.4->11163.6MB | peak: 11164.1MB
[PROFILE] env_3_MPS: 1.8ms | mem: 11163.0->11166.1MB | peak: 11183.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11166.1->11166.6MB | peak: 11166.6MB
[PROFILE] loss_derivs_3_MPS: 0.0ms | mem: 11166.6->11166.6MB | peak: 11166.6MB
[PROFILE] grad_contract_3_MPS: 2.4ms | mem: 11166.6->11167.1MB | peak: 11167.1MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 11167.1->11167.1MB | peak: 11167.1MB
[PROFILE] hess_contract_3_MPS: 2.5ms | mem: 11167.1->11168.3MB | peak: 11168.8MB
[PROFILE] env_3_MPS: 0.1ms | mem: 11167.8->11170.8MB | peak: 11187.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11170.8->11171.3MB | peak: 11171.3MB
[PROFILE] loss_derivs_3_MPS: 2.8ms | mem: 11171.3->11171.3MB | peak: 11171.3MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 11171.3->11171.8MB | peak: 11171.8MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 11171.8->11171.8MB | peak: 11171.8MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 11171.8->11173.0MB | peak: 11173.5MB
[PROFILE] env_3_MPS: 0.1ms | mem: 11172.3->11175.4MB | peak: 11192.3MB
[PROFILE] forward_3_MPS: 0.4ms | mem: 11175.4->11175.9MB | peak: 11175.9MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 11175.9->11175.9MB | peak: 11175.9MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 11175.9->11176.4MB | peak: 11176.4MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 11176.4->11176.4MB | peak: 11176.4MB
[PROFILE] hess_contract_3_MPS: 0.9ms | mem: 11176.4->11177.6MB | peak: 11178.1MB
[PROFILE] env_3_MPS: 1.0ms | mem: 11176.9->11179.9MB | peak: 11196.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11179.9->11180.5MB | peak: 11180.5MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 11180.5->11180.5MB | peak: 11180.5MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 11180.5->11181.0MB | peak: 11181.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 11181.0->11181.0MB | peak: 11181.0MB
[PROFILE] hess_contract_3_MPS: 1.0ms | mem: 11181.0->11182.1MB | peak: 11182.7MB
[PROFILE] env_3_MPS: 1.0ms | mem: 11181.5->11184.1MB | peak: 11196.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11184.1->11184.5MB | peak: 11184.5MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 11184.5->11184.5MB | peak: 11184.5MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 11184.5->11184.8MB | peak: 11184.8MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 11184.8->11184.8MB | peak: 11184.8MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 11184.8->11185.7MB | peak: 11186.1MB
[PROFILE] compute_H_b_3_MPS: 57.1ms | mem: 11158.3->11185.1MB | peak: 11186.1MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 11185.1->11185.1MB | peak: 11185.1MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 11185.1->11185.1MB | peak: 11185.1MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 11185.1->11185.2MB | peak: 11185.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 11185.2->11198.6MB | peak: 11204.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11198.6->11198.6MB | peak: 11198.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 11198.6->11198.7MB | peak: 11198.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11198.7->11204.9MB | peak: 11204.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11204.9->11204.9MB | peak: 11204.9MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 11204.9->11231.0MB | peak: 11251.0MB
[PROFILE] env_2_MPS: 1.3ms | mem: 11231.0->11245.0MB | peak: 11251.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11245.0->11245.0MB | peak: 11245.0MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 11245.0->11245.0MB | peak: 11245.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11245.0->11251.2MB | peak: 11251.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11251.2->11251.2MB | peak: 11251.2MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 11251.2->11277.4MB | peak: 11297.4MB
[PROFILE] env_2_MPS: 1.2ms | mem: 11277.4->11290.8MB | peak: 11297.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11290.8->11290.8MB | peak: 11290.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 11290.8->11290.9MB | peak: 11290.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11290.9->11297.1MB | peak: 11297.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11297.1->11297.1MB | peak: 11297.1MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 11297.1->11323.2MB | peak: 11343.2MB
[PROFILE] env_2_MPS: 1.1ms | mem: 11303.2->11317.2MB | peak: 11323.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11317.2->11317.2MB | peak: 11317.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 11317.2->11317.2MB | peak: 11317.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11317.2->11323.4MB | peak: 11323.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11323.4->11323.4MB | peak: 11323.4MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 11323.4->11349.6MB | peak: 11369.6MB
[PROFILE] env_2_MPS: 1.2ms | mem: 11329.6->11343.5MB | peak: 11349.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11343.5->11343.5MB | peak: 11343.5MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 11343.5->11343.5MB | peak: 11343.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11343.5->11349.7MB | peak: 11349.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11349.7->11349.7MB | peak: 11349.7MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 11349.7->11375.9MB | peak: 11395.9MB
[PROFILE] env_2_MPS: 1.0ms | mem: 11355.9->11365.5MB | peak: 11370.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11365.5->11365.5MB | peak: 11365.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 11365.5->11365.5MB | peak: 11365.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11365.5->11369.9MB | peak: 11369.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11369.9->11369.9MB | peak: 11369.9MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 11369.9->11394.3MB | peak: 11414.3MB
[PROFILE] compute_H_b_2_MPS: 37.4ms | mem: 11185.2->11354.3MB | peak: 11414.3MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 11354.3->11354.3MB | peak: 11354.3MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 11354.3->11354.3MB | peak: 11354.3MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 11354.3->11374.3MB | peak: 11394.3MB
[PROFILE] env_1_MPS: 1.3ms | mem: 11374.3->11387.6MB | peak: 11393.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11387.6->11387.6MB | peak: 11387.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 11387.6->11387.6MB | peak: 11387.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11387.6->11393.8MB | peak: 11393.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11393.8->11393.8MB | peak: 11393.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 11393.8->11420.0MB | peak: 11440.0MB
[PROFILE] env_1_MPS: 1.3ms | mem: 11420.0->11433.9MB | peak: 11440.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11433.9->11433.9MB | peak: 11433.9MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 11433.9->11433.9MB | peak: 11433.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11433.9->11440.1MB | peak: 11440.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11440.1->11440.1MB | peak: 11440.1MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 11440.1->11466.3MB | peak: 11486.3MB
[PROFILE] env_1_MPS: 1.3ms | mem: 11466.3->11479.6MB | peak: 11485.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11479.6->11479.6MB | peak: 11479.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 11479.6->11479.6MB | peak: 11479.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11479.6->11485.8MB | peak: 11485.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11485.8->11485.8MB | peak: 11485.8MB
[PROFILE] hess_contract_1_MPS: 1.2ms | mem: 11485.8->11512.0MB | peak: 11532.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 11492.0->11505.8MB | peak: 11512.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11505.8->11505.8MB | peak: 11505.8MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 11505.8->11505.8MB | peak: 11505.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11505.8->11512.0MB | peak: 11512.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11512.0->11512.0MB | peak: 11512.0MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 11512.0->11538.2MB | peak: 11558.2MB
[PROFILE] env_1_MPS: 1.0ms | mem: 11518.2->11532.1MB | peak: 11538.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11532.1->11532.1MB | peak: 11532.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 11532.1->11532.1MB | peak: 11532.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11532.1->11538.3MB | peak: 11538.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11538.3->11538.3MB | peak: 11538.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 11538.3->11564.5MB | peak: 11584.5MB
[PROFILE] env_1_MPS: 1.2ms | mem: 11544.4->11553.9MB | peak: 11558.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11553.9->11553.9MB | peak: 11553.9MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 11553.9->11553.9MB | peak: 11553.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11553.9->11558.3MB | peak: 11558.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11558.3->11558.3MB | peak: 11558.3MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 11558.3->11582.7MB | peak: 11602.7MB
[PROFILE] compute_H_b_1_MPS: 37.6ms | mem: 11374.3->11542.7MB | peak: 11602.7MB
[PROFILE] fuse_1_MPS: 0.0ms | mem: 11542.7->11542.7MB | peak: 11542.7MB
[PROFILE] to_dense_1_MPS: 0.0ms | mem: 11542.7->11542.7MB | peak: 11542.7MB
[PROFILE] solve_1_MPS: 3.8ms | mem: 11542.7->11562.7MB | peak: 11582.7MB
[PROFILE] env_0_MPS: 0.9ms | mem: 11562.7->11570.2MB | peak: 11586.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 11570.2->11570.2MB | peak: 11570.2MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 11570.2->11570.2MB | peak: 11570.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 11570.2->11570.7MB | peak: 11570.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11570.7->11570.7MB | peak: 11570.7MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 11570.7->11571.4MB | peak: 11571.9MB
[PROFILE] env_0_MPS: 1.0ms | mem: 11571.4->11579.0MB | peak: 11595.5MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 11579.0->11579.0MB | peak: 11579.0MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 11579.0->11579.0MB | peak: 11579.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 11579.0->11579.5MB | peak: 11579.5MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11579.5->11579.5MB | peak: 11579.5MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 11579.5->11580.2MB | peak: 11580.7MB
[PROFILE] env_0_MPS: 1.1ms | mem: 11580.2->11587.8MB | peak: 11604.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 11587.8->11587.8MB | peak: 11587.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 11587.8->11587.8MB | peak: 11587.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 11587.8->11588.3MB | peak: 11588.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11588.3->11588.3MB | peak: 11588.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 11588.3->11589.0MB | peak: 11589.5MB
[PROFILE] env_0_MPS: 1.5ms | mem: 11588.9->11596.5MB | peak: 11613.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 11596.5->11596.5MB | peak: 11596.5MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 11596.5->11596.5MB | peak: 11596.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 11596.5->11597.0MB | peak: 11597.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11597.0->11597.0MB | peak: 11597.0MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 11597.0->11597.7MB | peak: 11598.2MB
[PROFILE] env_0_MPS: 1.0ms | mem: 11597.5->11605.2MB | peak: 11621.7MB
[PROFILE] forward_0_MPS: 0.7ms | mem: 11605.2->11605.2MB | peak: 11605.2MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 11605.2->11605.2MB | peak: 11605.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 11605.2->11605.7MB | peak: 11605.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11605.7->11605.7MB | peak: 11605.7MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 11605.7->11606.4MB | peak: 11606.9MB
[PROFILE] env_0_MPS: 1.0ms | mem: 11606.2->11612.1MB | peak: 11623.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 11612.1->11612.1MB | peak: 11612.1MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 11612.1->11612.1MB | peak: 11612.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 11612.1->11612.4MB | peak: 11612.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 11612.4->11612.4MB | peak: 11612.4MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 11612.4->11612.9MB | peak: 11613.3MB
[PROFILE] compute_H_b_0_MPS: 34.7ms | mem: 11562.7->11612.7MB | peak: 11613.3MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 11612.7->11612.7MB | peak: 11612.7MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 11612.7->11612.7MB | peak: 11612.7MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 11612.7->11612.8MB | peak: 11612.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 11612.8->11626.1MB | peak: 11632.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11626.1->11626.1MB | peak: 11626.1MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 11626.1->11626.1MB | peak: 11626.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11626.1->11632.3MB | peak: 11632.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11632.3->11632.3MB | peak: 11632.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 11632.3->11658.5MB | peak: 11678.5MB
[PROFILE] env_1_MPS: 1.4ms | mem: 11658.5->11672.4MB | peak: 11678.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11672.4->11672.4MB | peak: 11672.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 11672.4->11672.4MB | peak: 11672.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11672.4->11678.6MB | peak: 11678.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11678.6->11678.6MB | peak: 11678.6MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 11678.6->11704.8MB | peak: 11724.8MB
[PROFILE] env_1_MPS: 1.3ms | mem: 11704.8->11718.1MB | peak: 11724.3MB
[PROFILE] forward_1_MPS: 0.7ms | mem: 11718.1->11718.1MB | peak: 11718.1MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 11718.1->11718.1MB | peak: 11718.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11718.1->11724.3MB | peak: 11724.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11724.3->11724.3MB | peak: 11724.3MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 11724.3->11750.5MB | peak: 11770.5MB
[PROFILE] env_1_MPS: 1.3ms | mem: 11730.5->11744.3MB | peak: 11750.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11744.3->11744.3MB | peak: 11744.4MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 11744.3->11744.4MB | peak: 11744.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11744.4->11750.6MB | peak: 11750.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11750.6->11750.6MB | peak: 11750.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 11750.6->11776.7MB | peak: 11796.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 11756.7->11770.6MB | peak: 11776.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11770.6->11770.6MB | peak: 11770.6MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 11770.6->11770.6MB | peak: 11770.6MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 11770.6->11776.8MB | peak: 11776.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11776.8->11776.8MB | peak: 11776.8MB
[PROFILE] hess_contract_1_MPS: 0.7ms | mem: 11776.8->11803.0MB | peak: 11823.0MB
[PROFILE] env_1_MPS: 1.1ms | mem: 11783.0->11792.4MB | peak: 11796.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 11792.4->11792.4MB | peak: 11792.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 11792.4->11792.4MB | peak: 11792.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 11792.4->11796.8MB | peak: 11796.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 11796.8->11796.8MB | peak: 11796.8MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 11796.8->11821.9MB | peak: 11841.9MB
[PROFILE] compute_H_b_1_MPS: 37.4ms | mem: 11612.8->11781.8MB | peak: 11841.9MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 11781.8->11781.8MB | peak: 11781.8MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 11781.8->11781.8MB | peak: 11781.8MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 11781.9->11801.9MB | peak: 11821.9MB
[PROFILE] env_2_MPS: 1.3ms | mem: 11801.9->11815.3MB | peak: 11821.5MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 11815.3->11815.3MB | peak: 11815.3MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 11815.3->11815.3MB | peak: 11815.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11815.3->11821.5MB | peak: 11821.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11821.5->11821.5MB | peak: 11821.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 11821.5->11847.7MB | peak: 11867.7MB
[PROFILE] env_2_MPS: 1.3ms | mem: 11847.7->11861.7MB | peak: 11867.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11861.7->11861.7MB | peak: 11861.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 11861.7->11861.7MB | peak: 11861.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11861.7->11867.9MB | peak: 11867.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11867.9->11867.9MB | peak: 11867.9MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 11867.9->11894.1MB | peak: 11914.1MB
[PROFILE] env_2_MPS: 0.1ms | mem: 11894.1->11907.5MB | peak: 11913.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11907.5->11907.5MB | peak: 11907.5MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 11907.5->11907.5MB | peak: 11907.5MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 11907.5->11913.7MB | peak: 11913.7MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 11913.7->11913.7MB | peak: 11913.7MB
[PROFILE] hess_contract_2_MPS: 3.1ms | mem: 11913.7->11939.9MB | peak: 11959.9MB
[PROFILE] env_2_MPS: 0.1ms | mem: 11919.9->11933.9MB | peak: 11940.0MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 11933.9->11933.9MB | peak: 11933.9MB
[PROFILE] loss_derivs_2_MPS: 2.0ms | mem: 11933.9->11933.9MB | peak: 11933.9MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 11933.9->11940.1MB | peak: 11940.1MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 11940.1->11940.1MB | peak: 11940.1MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 11940.1->11966.3MB | peak: 11986.3MB
[PROFILE] env_2_MPS: 0.1ms | mem: 11946.2->11960.2MB | peak: 11966.4MB
[PROFILE] forward_2_MPS: 0.4ms | mem: 11960.2->11960.2MB | peak: 11960.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 11960.2->11960.2MB | peak: 11960.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11960.2->11966.4MB | peak: 11966.4MB
[PROFILE] hess_tn_build_2_MPS: 0.4ms | mem: 11966.4->11966.4MB | peak: 11966.4MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 11966.4->11992.6MB | peak: 12012.6MB
[PROFILE] env_2_MPS: 1.0ms | mem: 11972.6->11982.2MB | peak: 11986.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 11982.2->11982.2MB | peak: 11982.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 11982.2->11982.2MB | peak: 11982.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 11982.2->11986.6MB | peak: 11986.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 11986.6->11986.6MB | peak: 11986.6MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 11986.6->12011.0MB | peak: 12031.0MB
[PROFILE] compute_H_b_2_MPS: 58.5ms | mem: 11801.9->11970.9MB | peak: 12031.0MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 11970.9->11970.9MB | peak: 11970.9MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 11970.9->11970.9MB | peak: 11970.9MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 11970.9->11991.0MB | peak: 12011.0MB
[PROFILE] env_3_MPS: 1.0ms | mem: 11991.0->11994.0MB | peak: 12010.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11994.0->11994.5MB | peak: 11994.5MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 11994.5->11994.5MB | peak: 11994.5MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 11994.5->11995.0MB | peak: 11995.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 11995.0->11995.0MB | peak: 11995.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 11995.0->11996.2MB | peak: 11996.7MB
[PROFILE] env_3_MPS: 1.0ms | mem: 11995.7->11998.7MB | peak: 12015.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 11998.7->11999.2MB | peak: 11999.2MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 11999.2->11999.2MB | peak: 11999.2MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 11999.2->11999.7MB | peak: 11999.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 11999.7->11999.7MB | peak: 11999.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 11999.7->12000.9MB | peak: 12001.4MB
[PROFILE] env_3_MPS: 1.0ms | mem: 12000.4->12003.4MB | peak: 12020.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12003.4->12003.9MB | peak: 12003.9MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 12003.9->12003.9MB | peak: 12003.9MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 12003.9->12004.4MB | peak: 12004.4MB
[PROFILE] hess_tn_build_3_MPS: 0.5ms | mem: 12004.4->12004.4MB | peak: 12004.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12004.4->12005.6MB | peak: 12006.1MB
[PROFILE] env_3_MPS: 1.0ms | mem: 12005.0->12008.0MB | peak: 12025.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12008.0->12008.5MB | peak: 12008.5MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 12008.5->12008.5MB | peak: 12008.5MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12008.5->12009.0MB | peak: 12009.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12009.0->12009.0MB | peak: 12009.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12009.0->12010.2MB | peak: 12010.7MB
[PROFILE] env_3_MPS: 1.2ms | mem: 12009.5->12012.6MB | peak: 12029.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12012.6->12013.1MB | peak: 12013.1MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 12013.1->12013.1MB | peak: 12013.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12013.1->12013.6MB | peak: 12013.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12013.6->12013.6MB | peak: 12013.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12013.6->12014.8MB | peak: 12015.3MB
[PROFILE] env_3_MPS: 1.0ms | mem: 12014.1->12016.7MB | peak: 12029.1MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12016.7->12017.1MB | peak: 12017.1MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 12017.1->12017.1MB | peak: 12017.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12017.1->12017.5MB | peak: 12017.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12017.5->12017.5MB | peak: 12017.5MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 12017.5->12018.3MB | peak: 12018.7MB
[PROFILE] compute_H_b_3_MPS: 35.9ms | mem: 11991.0->12017.7MB | peak: 12018.7MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 12017.7->12017.7MB | peak: 12017.7MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 12017.7->12017.7MB | peak: 12017.7MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 12017.7->12017.8MB | peak: 12018.0MB
[PROFILE] env_2_MPS: 1.4ms | mem: 12017.8->12031.3MB | peak: 12037.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12031.3->12031.3MB | peak: 12031.3MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12031.3->12031.3MB | peak: 12031.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12031.3->12037.5MB | peak: 12037.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12037.5->12037.5MB | peak: 12037.5MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 12037.5->12063.7MB | peak: 12083.7MB
[PROFILE] env_2_MPS: 1.1ms | mem: 12063.7->12077.6MB | peak: 12083.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12077.6->12077.6MB | peak: 12077.6MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 12077.6->12077.6MB | peak: 12077.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12077.6->12083.8MB | peak: 12083.9MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 12083.8->12083.8MB | peak: 12083.8MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 12083.8->12110.0MB | peak: 12130.0MB
[PROFILE] env_2_MPS: 1.3ms | mem: 12110.0->12123.5MB | peak: 12129.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12123.5->12123.5MB | peak: 12123.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12123.5->12123.5MB | peak: 12123.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12123.5->12129.7MB | peak: 12129.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12129.7->12129.7MB | peak: 12129.7MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 12129.7->12155.9MB | peak: 12175.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 12135.9->12149.8MB | peak: 12156.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12149.8->12149.8MB | peak: 12149.8MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 12149.8->12149.8MB | peak: 12149.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12149.8->12156.0MB | peak: 12156.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12156.0->12156.0MB | peak: 12156.0MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 12156.0->12182.2MB | peak: 12202.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 12162.2->12176.2MB | peak: 12182.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12176.2->12176.2MB | peak: 12176.2MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 12176.2->12176.2MB | peak: 12176.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12176.2->12182.4MB | peak: 12182.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12182.4->12182.4MB | peak: 12182.4MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 12182.4->12208.6MB | peak: 12228.6MB
[PROFILE] env_2_MPS: 1.1ms | mem: 12188.5->12198.1MB | peak: 12202.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12198.1->12198.1MB | peak: 12198.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12198.1->12198.1MB | peak: 12198.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12198.1->12202.5MB | peak: 12202.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12202.5->12202.5MB | peak: 12202.5MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 12202.5->12226.9MB | peak: 12246.9MB
[PROFILE] compute_H_b_2_MPS: 37.5ms | mem: 12017.8->12186.9MB | peak: 12246.9MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 12186.9->12186.9MB | peak: 12186.9MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 12186.9->12186.9MB | peak: 12186.9MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 12186.9->12206.9MB | peak: 12226.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 12206.9->12220.2MB | peak: 12226.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12220.2->12220.2MB | peak: 12220.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 12220.2->12220.3MB | peak: 12220.3MB
[PROFILE] grad_contract_1_MPS: 1.7ms | mem: 12220.3->12226.5MB | peak: 12226.5MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 12226.5->12226.5MB | peak: 12226.5MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 12226.5->12252.6MB | peak: 12272.6MB
[PROFILE] env_1_MPS: 0.1ms | mem: 12252.6->12266.5MB | peak: 12272.7MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 12266.5->12266.5MB | peak: 12266.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 12266.5->12266.5MB | peak: 12266.5MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 12266.5->12272.7MB | peak: 12272.7MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 12272.7->12272.7MB | peak: 12272.7MB
[PROFILE] hess_contract_1_MPS: 1.9ms | mem: 12272.7->12298.9MB | peak: 12318.9MB
[PROFILE] env_1_MPS: 1.8ms | mem: 12298.9->12312.2MB | peak: 12318.4MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 12312.2->12312.2MB | peak: 12312.2MB
[PROFILE] loss_derivs_1_MPS: 2.5ms | mem: 12312.2->12312.2MB | peak: 12312.2MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 12312.2->12318.4MB | peak: 12318.4MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 12318.4->12318.4MB | peak: 12318.4MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 12318.4->12344.6MB | peak: 12364.6MB
[PROFILE] env_1_MPS: 1.1ms | mem: 12324.6->12338.5MB | peak: 12344.6MB
[PROFILE] forward_1_MPS: 0.5ms | mem: 12338.5->12338.5MB | peak: 12338.5MB
[PROFILE] loss_derivs_1_MPS: 0.8ms | mem: 12338.5->12338.5MB | peak: 12338.5MB
[PROFILE] grad_contract_1_MPS: 0.4ms | mem: 12338.5->12344.7MB | peak: 12344.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 12344.7->12344.7MB | peak: 12344.7MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 12344.7->12370.9MB | peak: 12390.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 12350.8->12364.7MB | peak: 12370.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12364.7->12364.7MB | peak: 12364.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 12364.7->12364.7MB | peak: 12364.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 12364.7->12370.9MB | peak: 12370.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 12370.9->12370.9MB | peak: 12370.9MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 12370.9->12397.1MB | peak: 12417.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 12377.1->12386.5MB | peak: 12390.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12386.5->12386.5MB | peak: 12386.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 12386.5->12386.5MB | peak: 12386.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 12386.5->12390.9MB | peak: 12390.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 12390.9->12390.9MB | peak: 12390.9MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 12390.9->12415.3MB | peak: 12435.3MB
[PROFILE] compute_H_b_1_MPS: 57.1ms | mem: 12206.9->12375.3MB | peak: 12435.3MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 12375.3->12375.3MB | peak: 12375.3MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 12375.3->12375.3MB | peak: 12375.3MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 12375.3->12395.3MB | peak: 12415.3MB
[PROFILE] env_0_MPS: 0.9ms | mem: 12395.3->12402.8MB | peak: 12419.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 12402.8->12402.8MB | peak: 12402.8MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 12402.8->12402.8MB | peak: 12402.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 12402.8->12403.3MB | peak: 12403.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12403.3->12403.3MB | peak: 12403.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 12403.3->12404.0MB | peak: 12404.5MB
[PROFILE] env_0_MPS: 1.1ms | mem: 12404.0->12411.6MB | peak: 12428.2MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 12411.6->12411.6MB | peak: 12411.6MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 12411.6->12411.6MB | peak: 12411.6MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 12411.6->12412.2MB | peak: 12412.2MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12412.2->12412.2MB | peak: 12412.2MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 12412.2->12412.8MB | peak: 12413.3MB
[PROFILE] env_0_MPS: 1.0ms | mem: 12412.8->12420.4MB | peak: 12437.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 12420.4->12420.4MB | peak: 12420.4MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 12420.4->12420.4MB | peak: 12420.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 12420.4->12421.0MB | peak: 12421.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12421.0->12421.0MB | peak: 12421.0MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 12421.0->12421.6MB | peak: 12422.1MB
[PROFILE] env_0_MPS: 1.0ms | mem: 12421.5->12429.1MB | peak: 12445.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 12429.1->12429.1MB | peak: 12429.1MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 12429.1->12429.1MB | peak: 12429.2MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 12429.1->12429.7MB | peak: 12429.7MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12429.7->12429.7MB | peak: 12429.7MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 12429.7->12430.3MB | peak: 12430.8MB
[PROFILE] env_0_MPS: 1.1ms | mem: 12430.2->12437.8MB | peak: 12454.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 12437.8->12437.8MB | peak: 12437.8MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 12437.8->12437.8MB | peak: 12437.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 12437.8->12438.3MB | peak: 12438.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12438.3->12438.3MB | peak: 12438.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 12438.3->12439.0MB | peak: 12439.5MB
[PROFILE] env_0_MPS: 1.0ms | mem: 12438.9->12444.7MB | peak: 12456.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 12444.7->12444.7MB | peak: 12444.7MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 12444.7->12444.7MB | peak: 12444.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 12444.7->12445.1MB | peak: 12445.1MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 12445.1->12445.1MB | peak: 12445.1MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 12445.1->12445.6MB | peak: 12445.9MB
[PROFILE] compute_H_b_0_MPS: 34.6ms | mem: 12395.3->12445.3MB | peak: 12445.9MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 12445.3->12445.3MB | peak: 12445.3MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 12445.3->12445.3MB | peak: 12445.3MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 12445.3->12445.4MB | peak: 12445.6MB
[PROFILE] env_1_MPS: 1.3ms | mem: 12445.4->12458.8MB | peak: 12465.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12458.8->12458.8MB | peak: 12458.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 12458.8->12458.8MB | peak: 12458.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 12458.8->12465.0MB | peak: 12465.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 12465.0->12465.0MB | peak: 12465.0MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 12465.0->12491.2MB | peak: 12511.2MB
[PROFILE] env_1_MPS: 1.3ms | mem: 12491.2->12505.0MB | peak: 12511.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12505.0->12505.0MB | peak: 12505.0MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 12505.0->12505.0MB | peak: 12505.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 12505.0->12511.2MB | peak: 12511.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 12511.2->12511.2MB | peak: 12511.2MB
[PROFILE] hess_contract_1_MPS: 0.9ms | mem: 12511.2->12537.4MB | peak: 12557.4MB
[PROFILE] env_1_MPS: 1.2ms | mem: 12537.4->12550.7MB | peak: 12556.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12550.7->12550.7MB | peak: 12550.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 12550.7->12550.8MB | peak: 12550.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 12550.8->12557.0MB | peak: 12557.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 12557.0->12557.0MB | peak: 12557.0MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 12557.0->12583.1MB | peak: 12603.1MB
[PROFILE] env_1_MPS: 1.1ms | mem: 12563.1->12577.0MB | peak: 12583.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12577.0->12577.0MB | peak: 12577.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 12577.0->12577.0MB | peak: 12577.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 12577.0->12583.2MB | peak: 12583.2MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 12583.2->12583.2MB | peak: 12583.2MB
[PROFILE] hess_contract_1_MPS: 2.2ms | mem: 12583.2->12609.4MB | peak: 12629.4MB
[PROFILE] env_1_MPS: 1.8ms | mem: 12589.4->12603.2MB | peak: 12609.4MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 12603.2->12603.2MB | peak: 12603.2MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 12603.2->12603.2MB | peak: 12603.2MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 12603.2->12609.4MB | peak: 12609.4MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 12609.4->12609.4MB | peak: 12609.4MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 12609.4->12635.6MB | peak: 12655.6MB
[PROFILE] env_1_MPS: 0.1ms | mem: 12615.6->12625.0MB | peak: 12629.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 12625.0->12625.1MB | peak: 12625.1MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 12625.1->12625.1MB | peak: 12625.1MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 12625.1->12629.5MB | peak: 12629.5MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 12629.5->12629.5MB | peak: 12629.5MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 12629.5->12654.5MB | peak: 12674.5MB
[PROFILE] compute_H_b_1_MPS: 53.6ms | mem: 12445.4->12614.5MB | peak: 12674.5MB
[PROFILE] fuse_1_MPS: 0.0ms | mem: 12614.5->12614.5MB | peak: 12614.5MB
[PROFILE] to_dense_1_MPS: 0.0ms | mem: 12614.5->12614.5MB | peak: 12614.5MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 12614.5->12634.5MB | peak: 12654.5MB
[PROFILE] env_2_MPS: 1.1ms | mem: 12634.5->12647.9MB | peak: 12654.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12647.9->12647.9MB | peak: 12647.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 12647.9->12648.0MB | peak: 12648.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12648.0->12654.2MB | peak: 12654.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12654.2->12654.2MB | peak: 12654.2MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 12654.2->12680.3MB | peak: 12700.3MB
[PROFILE] env_2_MPS: 1.1ms | mem: 12680.3->12694.3MB | peak: 12700.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12694.3->12694.3MB | peak: 12694.3MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 12694.3->12694.3MB | peak: 12694.3MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12694.3->12700.5MB | peak: 12700.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12700.5->12700.5MB | peak: 12700.5MB
[PROFILE] hess_contract_2_MPS: 0.9ms | mem: 12700.5->12726.7MB | peak: 12746.7MB
[PROFILE] env_2_MPS: 1.3ms | mem: 12726.7->12740.1MB | peak: 12746.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12740.1->12740.1MB | peak: 12740.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12740.1->12740.1MB | peak: 12740.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12740.1->12746.3MB | peak: 12746.4MB
[PROFILE] hess_tn_build_2_MPS: 0.5ms | mem: 12746.3->12746.3MB | peak: 12746.3MB
[PROFILE] hess_contract_2_MPS: 0.7ms | mem: 12746.3->12772.5MB | peak: 12792.5MB
[PROFILE] env_2_MPS: 1.3ms | mem: 12752.5->12766.5MB | peak: 12772.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12766.5->12766.5MB | peak: 12766.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12766.5->12766.5MB | peak: 12766.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12766.5->12772.7MB | peak: 12772.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12772.7->12772.7MB | peak: 12772.7MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 12772.7->12798.9MB | peak: 12818.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 12778.9->12792.8MB | peak: 12799.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12792.8->12792.8MB | peak: 12792.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 12792.8->12792.8MB | peak: 12792.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12792.8->12799.0MB | peak: 12799.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12799.0->12799.0MB | peak: 12799.0MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 12799.0->12825.2MB | peak: 12845.2MB
[PROFILE] env_2_MPS: 1.0ms | mem: 12805.2->12814.8MB | peak: 12819.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12814.8->12814.8MB | peak: 12814.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12814.8->12814.8MB | peak: 12814.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12814.8->12819.2MB | peak: 12819.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12819.2->12819.2MB | peak: 12819.2MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 12819.2->12843.6MB | peak: 12863.6MB
[PROFILE] compute_H_b_2_MPS: 37.6ms | mem: 12634.5->12803.6MB | peak: 12863.6MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 12803.6->12803.6MB | peak: 12803.6MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 12803.6->12803.6MB | peak: 12803.6MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 12803.6->12823.6MB | peak: 12843.6MB
[PROFILE] env_3_MPS: 1.2ms | mem: 12823.6->12826.6MB | peak: 12843.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12826.6->12827.1MB | peak: 12827.1MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 12827.1->12827.1MB | peak: 12827.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12827.1->12827.6MB | peak: 12827.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12827.6->12827.6MB | peak: 12827.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12827.6->12828.8MB | peak: 12829.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 12828.3->12831.3MB | peak: 12848.3MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12831.3->12831.8MB | peak: 12831.8MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 12831.8->12831.8MB | peak: 12831.9MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12831.8->12832.4MB | peak: 12832.4MB
[PROFILE] hess_tn_build_3_MPS: 0.5ms | mem: 12832.4->12832.4MB | peak: 12832.4MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12832.4->12833.5MB | peak: 12834.0MB
[PROFILE] env_3_MPS: 1.2ms | mem: 12833.0->12836.0MB | peak: 12853.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12836.0->12836.6MB | peak: 12836.6MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 12836.6->12836.6MB | peak: 12836.6MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12836.6->12837.1MB | peak: 12837.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12837.1->12837.1MB | peak: 12837.1MB
[PROFILE] hess_contract_3_MPS: 0.8ms | mem: 12837.1->12838.2MB | peak: 12838.8MB
[PROFILE] env_3_MPS: 1.3ms | mem: 12837.6->12840.6MB | peak: 12857.6MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12840.6->12841.1MB | peak: 12841.1MB
[PROFILE] loss_derivs_3_MPS: 0.8ms | mem: 12841.1->12841.1MB | peak: 12841.2MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12841.1->12841.7MB | peak: 12841.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12841.7->12841.7MB | peak: 12841.7MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12841.7->12842.8MB | peak: 12843.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 12842.2->12845.2MB | peak: 12862.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12845.2->12845.7MB | peak: 12845.7MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 12845.7->12845.7MB | peak: 12845.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12845.7->12846.2MB | peak: 12846.2MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12846.2->12846.2MB | peak: 12846.2MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 12846.2->12847.4MB | peak: 12847.9MB
[PROFILE] env_3_MPS: 1.0ms | mem: 12846.8->12849.3MB | peak: 12861.7MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 12849.3->12849.7MB | peak: 12849.7MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 12849.7->12849.7MB | peak: 12849.7MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 12849.7->12850.1MB | peak: 12850.1MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 12850.1->12850.1MB | peak: 12850.1MB
[PROFILE] hess_contract_3_MPS: 0.4ms | mem: 12850.1->12851.0MB | peak: 12851.3MB
[PROFILE] compute_H_b_3_MPS: 41.7ms | mem: 12823.6->12850.3MB | peak: 12851.3MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 12850.3->12850.3MB | peak: 12850.3MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 12850.3->12850.3MB | peak: 12850.3MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 12850.3->12850.5MB | peak: 12850.6MB
[PROFILE] env_2_MPS: 1.3ms | mem: 12850.5->12863.9MB | peak: 12870.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 12863.9->12863.9MB | peak: 12863.9MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 12863.9->12863.9MB | peak: 12863.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12863.9->12870.1MB | peak: 12870.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 12870.1->12870.1MB | peak: 12870.1MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 12870.1->12896.3MB | peak: 12916.3MB
[PROFILE] env_2_MPS: 1.6ms | mem: 12896.3->12910.3MB | peak: 12916.4MB
[PROFILE] forward_2_MPS: 1.7ms | mem: 12910.3->12910.3MB | peak: 12910.3MB
[PROFILE] loss_derivs_2_MPS: 2.8ms | mem: 12910.3->12910.3MB | peak: 12910.3MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 12910.3->12916.5MB | peak: 12916.5MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 12916.5->12916.5MB | peak: 12916.5MB
[PROFILE] hess_contract_2_MPS: 3.0ms | mem: 12916.5->12942.7MB | peak: 12962.7MB
[PROFILE] env_2_MPS: 0.1ms | mem: 12942.7->12956.1MB | peak: 12962.3MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 12956.1->12956.1MB | peak: 12956.1MB
[PROFILE] loss_derivs_2_MPS: 2.0ms | mem: 12956.1->12956.1MB | peak: 12956.1MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 12956.1->12962.3MB | peak: 12962.3MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 12962.3->12962.3MB | peak: 12962.3MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 12962.3->12988.5MB | peak: 13008.5MB
[PROFILE] env_2_MPS: 0.1ms | mem: 12968.5->12982.4MB | peak: 12988.6MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 12982.4->12982.4MB | peak: 12982.5MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 12982.4->12982.5MB | peak: 12982.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 12982.5->12988.7MB | peak: 12988.7MB
[PROFILE] hess_tn_build_2_MPS: 0.4ms | mem: 12988.7->12988.7MB | peak: 12988.7MB
[PROFILE] hess_contract_2_MPS: 1.1ms | mem: 12988.7->13014.8MB | peak: 13034.8MB
[PROFILE] env_2_MPS: 1.1ms | mem: 12994.8->13008.8MB | peak: 13015.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13008.8->13008.8MB | peak: 13008.8MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 13008.8->13008.8MB | peak: 13008.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13008.8->13015.0MB | peak: 13015.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13015.0->13015.0MB | peak: 13015.0MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13015.0->13041.2MB | peak: 13061.2MB
[PROFILE] env_2_MPS: 1.1ms | mem: 13021.2->13030.7MB | peak: 13035.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13030.7->13030.7MB | peak: 13030.7MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 13030.7->13030.8MB | peak: 13030.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13030.8->13035.2MB | peak: 13035.2MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13035.2->13035.2MB | peak: 13035.2MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 13035.2->13059.5MB | peak: 13079.5MB
[PROFILE] compute_H_b_2_MPS: 59.8ms | mem: 12850.5->13019.5MB | peak: 13079.5MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 13019.5->13019.5MB | peak: 13019.5MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 13019.5->13019.5MB | peak: 13019.5MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 13019.5->13039.6MB | peak: 13059.6MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13039.5->13052.9MB | peak: 13059.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13052.9->13052.9MB | peak: 13052.9MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 13052.9->13052.9MB | peak: 13052.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13052.9->13059.1MB | peak: 13059.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13059.1->13059.1MB | peak: 13059.1MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 13059.1->13085.3MB | peak: 13105.3MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13085.3->13099.1MB | peak: 13105.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13099.1->13099.1MB | peak: 13099.1MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 13099.1->13099.1MB | peak: 13099.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13099.1->13105.3MB | peak: 13105.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13105.3->13105.3MB | peak: 13105.3MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 13105.3->13131.5MB | peak: 13151.5MB
[PROFILE] env_1_MPS: 1.3ms | mem: 13131.5->13144.8MB | peak: 13151.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13144.8->13144.9MB | peak: 13144.9MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 13144.9->13144.9MB | peak: 13144.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13144.9->13151.1MB | peak: 13151.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13151.1->13151.1MB | peak: 13151.1MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 13151.1->13177.2MB | peak: 13197.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13157.2->13171.1MB | peak: 13177.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13171.1->13171.1MB | peak: 13171.1MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 13171.1->13171.1MB | peak: 13171.1MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13171.1->13177.3MB | peak: 13177.3MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13177.3->13177.3MB | peak: 13177.3MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 13177.3->13203.5MB | peak: 13223.5MB
[PROFILE] env_1_MPS: 1.0ms | mem: 13183.5->13197.3MB | peak: 13203.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13197.3->13197.3MB | peak: 13197.3MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 13197.3->13197.3MB | peak: 13197.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13197.3->13203.5MB | peak: 13203.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13203.5->13203.5MB | peak: 13203.5MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 13203.5->13229.7MB | peak: 13249.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13209.7->13219.2MB | peak: 13223.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13219.2->13219.2MB | peak: 13219.2MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 13219.2->13219.2MB | peak: 13219.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13219.2->13223.6MB | peak: 13223.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13223.6->13223.6MB | peak: 13223.6MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 13223.6->13248.0MB | peak: 13268.0MB
[PROFILE] compute_H_b_1_MPS: 37.6ms | mem: 13039.5->13207.9MB | peak: 13268.0MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 13207.9->13207.9MB | peak: 13207.9MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 13207.9->13207.9MB | peak: 13207.9MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 13207.9->13228.0MB | peak: 13248.0MB
[PROFILE] env_0_MPS: 0.9ms | mem: 13228.0->13235.4MB | peak: 13252.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 13235.4->13235.4MB | peak: 13235.4MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 13235.4->13235.4MB | peak: 13235.5MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 13235.4->13236.0MB | peak: 13236.0MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 13236.0->13236.0MB | peak: 13236.0MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 13236.0->13236.6MB | peak: 13237.1MB
[PROFILE] env_0_MPS: 1.0ms | mem: 13236.6->13244.2MB | peak: 13260.8MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 13244.2->13244.3MB | peak: 13244.3MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 13244.3->13244.3MB | peak: 13244.3MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 13244.3->13244.8MB | peak: 13244.8MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 13244.8->13244.8MB | peak: 13244.8MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 13244.8->13245.4MB | peak: 13245.9MB
[PROFILE] env_0_MPS: 1.1ms | mem: 13245.4->13253.1MB | peak: 13269.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 13253.1->13253.1MB | peak: 13253.1MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 13253.1->13253.1MB | peak: 13253.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 13253.1->13253.6MB | peak: 13253.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 13253.6->13253.6MB | peak: 13253.6MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 13253.6->13254.2MB | peak: 13254.8MB
[PROFILE] env_0_MPS: 1.2ms | mem: 13254.1->13261.8MB | peak: 13278.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 13261.8->13261.8MB | peak: 13261.8MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 13261.8->13261.8MB | peak: 13261.8MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 13261.8->13262.3MB | peak: 13262.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 13262.3->13262.3MB | peak: 13262.3MB
[PROFILE] hess_contract_0_MPS: 0.6ms | mem: 13262.3->13262.9MB | peak: 13263.5MB
[PROFILE] env_0_MPS: 0.2ms | mem: 13262.8->13270.4MB | peak: 13287.0MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 13270.4->13270.4MB | peak: 13270.4MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 13270.4->13270.5MB | peak: 13270.5MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 13270.5->13271.0MB | peak: 13271.0MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 13271.0->13271.0MB | peak: 13271.0MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 13271.0->13271.6MB | peak: 13272.1MB
[PROFILE] env_0_MPS: 3.0ms | mem: 13271.5->13277.3MB | peak: 13289.0MB
[PROFILE] forward_0_MPS: 0.0ms | mem: 13277.3->13277.3MB | peak: 13277.3MB
[PROFILE] loss_derivs_0_MPS: 0.0ms | mem: 13277.3->13277.3MB | peak: 13277.3MB
[PROFILE] grad_contract_0_MPS: 0.0ms | mem: 13277.3->13277.7MB | peak: 13277.7MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 13277.7->13277.7MB | peak: 13277.7MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 13277.7->13278.2MB | peak: 13278.6MB
[PROFILE] compute_H_b_0_MPS: 47.6ms | mem: 13228.0->13277.9MB | peak: 13278.6MB
[PROFILE] fuse_0_MPS: 0.0ms | mem: 13277.9->13277.9MB | peak: 13277.9MB
[PROFILE] to_dense_0_MPS: 0.0ms | mem: 13277.9->13277.9MB | peak: 13277.9MB
[PROFILE] solve_0_MPS: 0.6ms | mem: 13277.9->13278.1MB | peak: 13278.2MB
[PROFILE] env_1_MPS: 1.1ms | mem: 13278.1->13291.4MB | peak: 13297.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13291.4->13291.4MB | peak: 13291.4MB
[PROFILE] loss_derivs_1_MPS: 1.1ms | mem: 13291.4->13291.4MB | peak: 13291.4MB
[PROFILE] grad_contract_1_MPS: 0.1ms | mem: 13291.4->13297.6MB | peak: 13297.6MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13297.6->13297.6MB | peak: 13297.6MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 13297.6->13323.8MB | peak: 13343.8MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13323.8->13337.6MB | peak: 13343.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13337.6->13337.6MB | peak: 13337.6MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 13337.6->13337.6MB | peak: 13337.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13337.6->13343.8MB | peak: 13343.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13343.8->13343.8MB | peak: 13343.8MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 13343.8->13370.0MB | peak: 13390.0MB
[PROFILE] env_1_MPS: 1.1ms | mem: 13370.0->13383.4MB | peak: 13389.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13383.4->13383.4MB | peak: 13383.4MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 13383.4->13383.4MB | peak: 13383.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13383.4->13389.6MB | peak: 13389.6MB
[PROFILE] hess_tn_build_1_MPS: 0.5ms | mem: 13389.6->13389.6MB | peak: 13389.6MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 13389.6->13415.8MB | peak: 13435.8MB
[PROFILE] env_1_MPS: 1.3ms | mem: 13395.8->13409.6MB | peak: 13415.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13409.6->13409.6MB | peak: 13409.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 13409.6->13409.6MB | peak: 13409.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13409.6->13415.8MB | peak: 13415.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13415.8->13415.8MB | peak: 13415.8MB
[PROFILE] hess_contract_1_MPS: 0.5ms | mem: 13415.8->13442.0MB | peak: 13462.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13422.0->13435.8MB | peak: 13442.0MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13435.8->13435.8MB | peak: 13435.8MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 13435.8->13435.8MB | peak: 13435.9MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13435.8->13442.0MB | peak: 13442.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13442.0->13442.0MB | peak: 13442.0MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 13442.0->13468.2MB | peak: 13488.2MB
[PROFILE] env_1_MPS: 1.0ms | mem: 13448.2->13457.7MB | peak: 13462.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13457.7->13457.7MB | peak: 13457.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 13457.7->13457.7MB | peak: 13457.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13457.7->13462.1MB | peak: 13462.1MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13462.1->13462.1MB | peak: 13462.1MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 13462.1->13487.1MB | peak: 13507.1MB
[PROFILE] compute_H_b_1_MPS: 38.0ms | mem: 13278.1->13447.1MB | peak: 13507.1MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 13447.1->13447.1MB | peak: 13447.1MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 13447.1->13447.1MB | peak: 13447.1MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 13447.1->13467.1MB | peak: 13487.1MB
[PROFILE] env_2_MPS: 1.2ms | mem: 13467.1->13480.6MB | peak: 13486.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13480.6->13480.6MB | peak: 13480.6MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 13480.6->13480.6MB | peak: 13480.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13480.6->13486.8MB | peak: 13486.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13486.8->13486.8MB | peak: 13486.8MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13486.8->13513.0MB | peak: 13533.0MB
[PROFILE] env_2_MPS: 1.3ms | mem: 13513.0->13526.9MB | peak: 13533.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13526.9->13526.9MB | peak: 13526.9MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 13526.9->13526.9MB | peak: 13526.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13526.9->13533.1MB | peak: 13533.1MB
[PROFILE] hess_tn_build_2_MPS: 0.6ms | mem: 13533.1->13533.1MB | peak: 13533.1MB
[PROFILE] hess_contract_2_MPS: 1.0ms | mem: 13533.1->13559.3MB | peak: 13579.3MB
[PROFILE] env_2_MPS: 1.2ms | mem: 13559.3->13572.8MB | peak: 13579.0MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13572.8->13572.8MB | peak: 13572.8MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 13572.8->13572.8MB | peak: 13572.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13572.8->13579.0MB | peak: 13579.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13579.0->13579.0MB | peak: 13579.0MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13579.0->13605.2MB | peak: 13625.2MB
[PROFILE] env_2_MPS: 1.1ms | mem: 13585.2->13599.1MB | peak: 13605.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13599.1->13599.1MB | peak: 13599.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 13599.1->13599.1MB | peak: 13599.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13599.1->13605.3MB | peak: 13605.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13605.3->13605.3MB | peak: 13605.3MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 13605.3->13631.5MB | peak: 13651.5MB
[PROFILE] env_2_MPS: 1.2ms | mem: 13611.5->13625.5MB | peak: 13631.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13625.5->13625.5MB | peak: 13625.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 13625.5->13625.5MB | peak: 13625.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13625.5->13631.7MB | peak: 13631.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13631.7->13631.7MB | peak: 13631.7MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13631.7->13657.9MB | peak: 13677.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 13637.8->13647.4MB | peak: 13652.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13647.4->13647.4MB | peak: 13647.4MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 13647.4->13647.4MB | peak: 13647.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13647.4->13651.8MB | peak: 13651.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13651.8->13651.8MB | peak: 13651.8MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 13651.8->13676.2MB | peak: 13696.2MB
[PROFILE] compute_H_b_2_MPS: 37.8ms | mem: 13467.1->13636.2MB | peak: 13696.2MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 13636.2->13636.2MB | peak: 13636.2MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 13636.2->13636.2MB | peak: 13636.2MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 13636.2->13656.2MB | peak: 13676.2MB
[PROFILE] env_3_MPS: 1.0ms | mem: 13656.2->13659.2MB | peak: 13676.2MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 13659.2->13659.7MB | peak: 13659.8MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 13659.7->13659.8MB | peak: 13659.8MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 13659.8->13660.3MB | peak: 13660.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 13660.3->13660.3MB | peak: 13660.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 13660.3->13661.4MB | peak: 13662.0MB
[PROFILE] env_3_MPS: 1.0ms | mem: 13660.9->13663.9MB | peak: 13680.9MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 13663.9->13664.5MB | peak: 13664.5MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 13664.5->13664.5MB | peak: 13664.5MB
[PROFILE] grad_contract_3_MPS: 0.4ms | mem: 13664.5->13665.0MB | peak: 13665.0MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 13665.0->13665.0MB | peak: 13665.0MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 13665.0->13666.2MB | peak: 13666.7MB
[PROFILE] env_3_MPS: 1.0ms | mem: 13665.6->13668.7MB | peak: 13685.6MB
[PROFILE] forward_3_MPS: 0.5ms | mem: 13668.7->13669.2MB | peak: 13669.2MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 13669.2->13669.2MB | peak: 13669.2MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 13669.2->13669.7MB | peak: 13669.7MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 13669.7->13669.7MB | peak: 13669.7MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 13669.7->13670.9MB | peak: 13671.4MB
[PROFILE] env_3_MPS: 1.8ms | mem: 13670.2->13673.2MB | peak: 13690.2MB
[PROFILE] forward_3_MPS: 0.0ms | mem: 13673.2->13673.8MB | peak: 13673.8MB
[PROFILE] loss_derivs_3_MPS: 2.5ms | mem: 13673.8->13673.8MB | peak: 13673.8MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 13673.8->13674.3MB | peak: 13674.3MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 13674.3->13674.3MB | peak: 13674.3MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 13674.3->13675.4MB | peak: 13676.0MB
[PROFILE] env_3_MPS: 1.8ms | mem: 13674.8->13677.8MB | peak: 13694.8MB
[PROFILE] forward_3_MPS: 0.0ms | mem: 13677.8->13678.3MB | peak: 13678.3MB
[PROFILE] loss_derivs_3_MPS: 2.5ms | mem: 13678.3->13678.3MB | peak: 13678.4MB
[PROFILE] grad_contract_3_MPS: 0.0ms | mem: 13678.3->13678.9MB | peak: 13678.9MB
[PROFILE] hess_tn_build_3_MPS: 0.0ms | mem: 13678.9->13678.9MB | peak: 13678.9MB
[PROFILE] hess_contract_3_MPS: 0.0ms | mem: 13678.9->13680.0MB | peak: 13680.5MB
[PROFILE] env_3_MPS: 0.8ms | mem: 13679.4->13682.0MB | peak: 13694.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 13682.0->13682.3MB | peak: 13682.3MB
[PROFILE] loss_derivs_3_MPS: 1.2ms | mem: 13682.3->13682.4MB | peak: 13682.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 13682.4->13682.7MB | peak: 13682.7MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 13682.7->13682.7MB | peak: 13682.7MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 13682.7->13683.6MB | peak: 13683.9MB
[PROFILE] compute_H_b_3_MPS: 55.4ms | mem: 13656.2->13682.9MB | peak: 13683.9MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 13682.9->13682.9MB | peak: 13682.9MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 13682.9->13682.9MB | peak: 13682.9MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 13683.0->13683.1MB | peak: 13683.2MB
[PROFILE] env_2_MPS: 1.2ms | mem: 13683.1->13696.5MB | peak: 13702.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13696.5->13696.5MB | peak: 13696.5MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 13696.5->13696.5MB | peak: 13696.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13696.5->13702.7MB | peak: 13702.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13702.7->13702.7MB | peak: 13702.7MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13702.7->13728.9MB | peak: 13748.9MB
[PROFILE] env_2_MPS: 1.7ms | mem: 13728.9->13742.9MB | peak: 13749.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13742.9->13742.9MB | peak: 13742.9MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 13742.9->13742.9MB | peak: 13742.9MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13742.9->13749.1MB | peak: 13749.1MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13749.1->13749.1MB | peak: 13749.1MB
[PROFILE] hess_contract_2_MPS: 1.0ms | mem: 13749.1->13775.3MB | peak: 13795.3MB
[PROFILE] env_2_MPS: 1.3ms | mem: 13775.3->13788.7MB | peak: 13794.9MB
[PROFILE] forward_2_MPS: 0.8ms | mem: 13788.7->13788.7MB | peak: 13788.7MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 13788.7->13788.7MB | peak: 13788.8MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13788.7->13794.9MB | peak: 13795.0MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13794.9->13794.9MB | peak: 13794.9MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13794.9->13821.1MB | peak: 13841.1MB
[PROFILE] env_2_MPS: 1.2ms | mem: 13801.1->13815.1MB | peak: 13821.3MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13815.1->13815.1MB | peak: 13815.1MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 13815.1->13815.1MB | peak: 13815.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13815.1->13821.3MB | peak: 13821.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13821.3->13821.3MB | peak: 13821.3MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 13821.3->13847.5MB | peak: 13867.5MB
[PROFILE] env_2_MPS: 1.1ms | mem: 13827.5->13841.4MB | peak: 13847.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13841.4->13841.4MB | peak: 13841.4MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 13841.4->13841.4MB | peak: 13841.4MB
[PROFILE] grad_contract_2_MPS: 0.7ms | mem: 13841.4->13847.6MB | peak: 13847.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13847.6->13847.6MB | peak: 13847.6MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 13847.6->13873.8MB | peak: 13893.8MB
[PROFILE] env_2_MPS: 1.3ms | mem: 13853.8->13863.4MB | peak: 13868.1MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 13863.4->13863.4MB | peak: 13863.4MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 13863.4->13863.4MB | peak: 13863.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 13863.4->13867.8MB | peak: 13867.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 13867.8->13867.8MB | peak: 13867.8MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 13867.8->13892.2MB | peak: 13912.2MB
[PROFILE] compute_H_b_2_MPS: 37.7ms | mem: 13683.1->13852.1MB | peak: 13912.2MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 13852.1->13852.1MB | peak: 13852.1MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 13852.1->13852.1MB | peak: 13852.1MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 13852.2->13872.2MB | peak: 13892.2MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13872.2->13885.5MB | peak: 13891.7MB
[PROFILE] forward_1_MPS: 0.7ms | mem: 13885.5->13885.5MB | peak: 13885.5MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 13885.5->13885.5MB | peak: 13885.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13885.5->13891.7MB | peak: 13891.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13891.7->13891.7MB | peak: 13891.7MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 13891.7->13917.9MB | peak: 13937.9MB
[PROFILE] env_1_MPS: 1.1ms | mem: 13917.9->13931.7MB | peak: 13937.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13931.7->13931.7MB | peak: 13931.8MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 13931.7->13931.8MB | peak: 13931.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 13931.8->13938.0MB | peak: 13938.0MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13938.0->13938.0MB | peak: 13938.0MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 13938.0->13964.1MB | peak: 13984.1MB
[PROFILE] env_1_MPS: 1.2ms | mem: 13964.1->13977.5MB | peak: 13983.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 13977.5->13977.5MB | peak: 13977.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 13977.5->13977.5MB | peak: 13977.5MB
[PROFILE] grad_contract_1_MPS: 0.7ms | mem: 13977.5->13983.7MB | peak: 13983.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 13983.7->13983.7MB | peak: 13983.7MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 13983.7->14009.9MB | peak: 14029.9MB
[PROFILE] env_1_MPS: 1.3ms | mem: 13989.9->14003.7MB | peak: 14009.9MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14003.7->14003.7MB | peak: 14003.7MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 14003.7->14003.7MB | peak: 14003.7MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14003.7->14009.9MB | peak: 14009.9MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14009.9->14009.9MB | peak: 14009.9MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 14009.9->14036.1MB | peak: 14056.1MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14016.1->14029.9MB | peak: 14036.1MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14029.9->14029.9MB | peak: 14029.9MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14029.9->14030.0MB | peak: 14030.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14030.0->14036.2MB | peak: 14036.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14036.2->14036.2MB | peak: 14036.2MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 14036.2->14062.3MB | peak: 14082.3MB
[PROFILE] env_1_MPS: 1.0ms | mem: 14042.3->14051.8MB | peak: 14056.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14051.8->14051.8MB | peak: 14051.8MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14051.8->14051.8MB | peak: 14051.8MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14051.8->14056.2MB | peak: 14056.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14056.2->14056.2MB | peak: 14056.2MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 14056.2->14080.6MB | peak: 14100.6MB
[PROFILE] compute_H_b_1_MPS: 37.9ms | mem: 13872.2->14040.6MB | peak: 14100.6MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 14040.6->14040.6MB | peak: 14040.6MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 14040.6->14040.6MB | peak: 14040.6MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 14040.6->14060.6MB | peak: 14080.6MB
[PROFILE] env_0_MPS: 2.0ms | mem: 14060.6->14068.1MB | peak: 14084.6MB
[PROFILE] forward_0_MPS: 0.4ms | mem: 14068.1->14068.1MB | peak: 14068.1MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 14068.1->14068.1MB | peak: 14068.1MB
[PROFILE] grad_contract_0_MPS: 0.4ms | mem: 14068.1->14068.6MB | peak: 14068.6MB
[PROFILE] hess_tn_build_0_MPS: 0.0ms | mem: 14068.6->14068.6MB | peak: 14068.6MB
[PROFILE] hess_contract_0_MPS: 0.0ms | mem: 14068.6->14069.2MB | peak: 14069.8MB
[PROFILE] env_0_MPS: 1.0ms | mem: 14069.2->14076.9MB | peak: 14093.4MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 14076.9->14076.9MB | peak: 14076.9MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 14076.9->14076.9MB | peak: 14076.9MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 14076.9->14077.4MB | peak: 14077.4MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 14077.4->14077.4MB | peak: 14077.4MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 14077.4->14078.1MB | peak: 14078.6MB
[PROFILE] env_0_MPS: 1.0ms | mem: 14078.1->14085.7MB | peak: 14102.3MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 14085.7->14085.7MB | peak: 14085.7MB
[PROFILE] loss_derivs_0_MPS: 0.5ms | mem: 14085.7->14085.7MB | peak: 14085.7MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 14085.7->14086.2MB | peak: 14086.2MB
[PROFILE] hess_tn_build_0_MPS: 0.6ms | mem: 14086.2->14086.2MB | peak: 14086.2MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 14086.2->14086.9MB | peak: 14087.4MB
[PROFILE] env_0_MPS: 0.9ms | mem: 14086.7->14094.4MB | peak: 14110.9MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 14094.4->14094.4MB | peak: 14094.4MB
[PROFILE] loss_derivs_0_MPS: 0.7ms | mem: 14094.4->14094.4MB | peak: 14094.4MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 14094.4->14094.9MB | peak: 14094.9MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 14094.9->14094.9MB | peak: 14094.9MB
[PROFILE] hess_contract_0_MPS: 0.5ms | mem: 14094.9->14095.6MB | peak: 14096.1MB
[PROFILE] env_0_MPS: 1.1ms | mem: 14095.4->14103.1MB | peak: 14119.6MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 14103.1->14103.1MB | peak: 14103.1MB
[PROFILE] loss_derivs_0_MPS: 0.6ms | mem: 14103.1->14103.1MB | peak: 14103.1MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 14103.1->14103.6MB | peak: 14103.6MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 14103.6->14103.6MB | peak: 14103.6MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 14103.6->14104.2MB | peak: 14104.8MB
[PROFILE] env_0_MPS: 0.9ms | mem: 14104.1->14109.9MB | peak: 14121.7MB
[PROFILE] forward_0_MPS: 0.3ms | mem: 14109.9->14110.0MB | peak: 14110.0MB
[PROFILE] loss_derivs_0_MPS: 1.0ms | mem: 14110.0->14110.0MB | peak: 14110.0MB
[PROFILE] grad_contract_0_MPS: 0.3ms | mem: 14110.0->14110.3MB | peak: 14110.3MB
[PROFILE] hess_tn_build_0_MPS: 0.1ms | mem: 14110.3->14110.3MB | peak: 14110.3MB
[PROFILE] hess_contract_0_MPS: 0.3ms | mem: 14110.3->14110.8MB | peak: 14111.2MB
[PROFILE] compute_H_b_0_MPS: 36.7ms | mem: 14060.6->14110.6MB | peak: 14111.2MB
[PROFILE] fuse_0_MPS: 0.1ms | mem: 14110.6->14110.6MB | peak: 14110.6MB
[PROFILE] to_dense_0_MPS: 0.1ms | mem: 14110.6->14110.6MB | peak: 14110.6MB
[PROFILE] solve_0_MPS: 0.4ms | mem: 14110.6->14110.7MB | peak: 14110.8MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14110.7->14124.0MB | peak: 14130.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14124.0->14124.0MB | peak: 14124.0MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14124.0->14124.0MB | peak: 14124.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14124.0->14130.2MB | peak: 14130.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14130.2->14130.2MB | peak: 14130.2MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 14130.2->14156.4MB | peak: 14176.4MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14156.4->14170.3MB | peak: 14176.5MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14170.3->14170.3MB | peak: 14170.3MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 14170.3->14170.3MB | peak: 14170.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14170.3->14176.5MB | peak: 14176.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14176.5->14176.5MB | peak: 14176.5MB
[PROFILE] hess_contract_1_MPS: 1.0ms | mem: 14176.5->14202.7MB | peak: 14222.7MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14202.7->14216.0MB | peak: 14222.2MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14216.0->14216.0MB | peak: 14216.0MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 14216.0->14216.0MB | peak: 14216.0MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14216.0->14222.2MB | peak: 14222.2MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14222.2->14222.2MB | peak: 14222.2MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 14222.2->14248.4MB | peak: 14268.4MB
[PROFILE] env_1_MPS: 1.1ms | mem: 14228.4->14242.2MB | peak: 14248.4MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14242.2->14242.2MB | peak: 14242.2MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14242.2->14242.2MB | peak: 14242.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14242.2->14248.4MB | peak: 14248.5MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14248.4->14248.4MB | peak: 14248.4MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 14248.4->14274.6MB | peak: 14294.6MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14254.6->14268.5MB | peak: 14274.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14268.5->14268.5MB | peak: 14268.5MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 14268.5->14268.5MB | peak: 14268.5MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14268.5->14274.7MB | peak: 14274.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14274.7->14274.7MB | peak: 14274.7MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 14274.7->14300.9MB | peak: 14320.9MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14280.9->14290.3MB | peak: 14294.7MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14290.3->14290.3MB | peak: 14290.3MB
[PROFILE] loss_derivs_1_MPS: 0.5ms | mem: 14290.3->14290.3MB | peak: 14290.3MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14290.3->14294.7MB | peak: 14294.7MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14294.7->14294.7MB | peak: 14294.7MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 14294.7->14319.8MB | peak: 14339.8MB
[PROFILE] compute_H_b_1_MPS: 37.3ms | mem: 14110.7->14279.7MB | peak: 14339.8MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 14279.7->14279.7MB | peak: 14279.7MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 14279.7->14279.7MB | peak: 14279.7MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 14279.7->14299.8MB | peak: 14319.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 14299.8->14313.2MB | peak: 14319.4MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14313.2->14313.2MB | peak: 14313.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 14313.2->14313.2MB | peak: 14313.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14313.2->14319.4MB | peak: 14319.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14319.4->14319.4MB | peak: 14319.4MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 14319.4->14345.6MB | peak: 14365.6MB
[PROFILE] env_2_MPS: 1.1ms | mem: 14345.6->14359.6MB | peak: 14365.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14359.6->14359.6MB | peak: 14359.6MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 14359.6->14359.6MB | peak: 14359.6MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14359.6->14365.8MB | peak: 14365.8MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14365.8->14365.8MB | peak: 14365.8MB
[PROFILE] hess_contract_2_MPS: 1.0ms | mem: 14365.8->14392.0MB | peak: 14412.0MB
[PROFILE] env_2_MPS: 1.2ms | mem: 14392.0->14405.4MB | peak: 14411.6MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14405.4->14405.4MB | peak: 14405.4MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 14405.4->14405.4MB | peak: 14405.4MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14405.4->14411.6MB | peak: 14411.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14411.6->14411.6MB | peak: 14411.6MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 14411.6->14437.8MB | peak: 14457.8MB
[PROFILE] env_2_MPS: 3.4ms | mem: 14417.8->14431.7MB | peak: 14437.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14431.7->14431.7MB | peak: 14431.7MB
[PROFILE] loss_derivs_2_MPS: 0.0ms | mem: 14431.7->14431.8MB | peak: 14431.8MB
[PROFILE] grad_contract_2_MPS: 0.0ms | mem: 14431.8->14438.0MB | peak: 14438.0MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 14438.0->14438.0MB | peak: 14438.0MB
[PROFILE] hess_contract_2_MPS: 0.2ms | mem: 14438.0->14464.1MB | peak: 14484.1MB
[PROFILE] env_2_MPS: 0.1ms | mem: 14444.1->14458.1MB | peak: 14464.3MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 14458.1->14458.1MB | peak: 14458.1MB
[PROFILE] loss_derivs_2_MPS: 0.3ms | mem: 14458.1->14458.1MB | peak: 14458.1MB
[PROFILE] grad_contract_2_MPS: 0.4ms | mem: 14458.1->14464.3MB | peak: 14464.3MB
[PROFILE] hess_tn_build_2_MPS: 0.0ms | mem: 14464.3->14464.3MB | peak: 14464.3MB
[PROFILE] hess_contract_2_MPS: 2.7ms | mem: 14464.3->14490.5MB | peak: 14510.5MB
[PROFILE] env_2_MPS: 0.1ms | mem: 14470.5->14480.0MB | peak: 14484.8MB
[PROFILE] forward_2_MPS: 0.0ms | mem: 14480.0->14480.0MB | peak: 14480.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 14480.0->14480.0MB | peak: 14480.1MB
[PROFILE] grad_contract_2_MPS: 0.1ms | mem: 14480.0->14484.4MB | peak: 14484.5MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14484.4->14484.4MB | peak: 14484.4MB
[PROFILE] hess_contract_2_MPS: 1.3ms | mem: 14484.4->14508.8MB | peak: 14528.8MB
[PROFILE] compute_H_b_2_MPS: 58.9ms | mem: 14299.8->14468.8MB | peak: 14528.8MB
[PROFILE] fuse_2_MPS: 0.0ms | mem: 14468.8->14468.8MB | peak: 14468.8MB
[PROFILE] to_dense_2_MPS: 0.0ms | mem: 14468.8->14468.8MB | peak: 14468.8MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 14468.8->14488.8MB | peak: 14508.8MB
[PROFILE] env_3_MPS: 1.2ms | mem: 14488.8->14491.9MB | peak: 14508.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 14491.9->14492.4MB | peak: 14492.4MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 14492.4->14492.4MB | peak: 14492.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 14492.4->14492.9MB | peak: 14492.9MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 14492.9->14492.9MB | peak: 14492.9MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 14492.9->14494.1MB | peak: 14494.6MB
[PROFILE] env_3_MPS: 1.6ms | mem: 14493.6->14496.6MB | peak: 14513.5MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 14496.6->14497.1MB | peak: 14497.1MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 14497.1->14497.1MB | peak: 14497.1MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 14497.1->14497.6MB | peak: 14497.6MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 14497.6->14497.6MB | peak: 14497.6MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 14497.6->14498.8MB | peak: 14499.3MB
[PROFILE] env_3_MPS: 1.2ms | mem: 14498.3->14501.3MB | peak: 14518.3MB
[PROFILE] forward_3_MPS: 0.7ms | mem: 14501.3->14501.8MB | peak: 14501.8MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 14501.8->14501.8MB | peak: 14501.8MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 14501.8->14502.3MB | peak: 14502.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 14502.3->14502.3MB | peak: 14502.3MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 14502.3->14503.5MB | peak: 14504.0MB
[PROFILE] env_3_MPS: 1.2ms | mem: 14502.8->14505.9MB | peak: 14522.8MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 14505.9->14506.4MB | peak: 14506.4MB
[PROFILE] loss_derivs_3_MPS: 0.7ms | mem: 14506.4->14506.4MB | peak: 14506.4MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 14506.4->14506.9MB | peak: 14506.9MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 14506.9->14506.9MB | peak: 14506.9MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 14506.9->14508.1MB | peak: 14508.6MB
[PROFILE] env_3_MPS: 1.2ms | mem: 14507.4->14510.4MB | peak: 14527.4MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 14510.4->14511.0MB | peak: 14511.0MB
[PROFILE] loss_derivs_3_MPS: 0.6ms | mem: 14511.0->14511.0MB | peak: 14511.0MB
[PROFILE] grad_contract_3_MPS: 0.7ms | mem: 14511.0->14511.5MB | peak: 14511.5MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 14511.5->14511.5MB | peak: 14511.5MB
[PROFILE] hess_contract_3_MPS: 0.5ms | mem: 14511.5->14512.7MB | peak: 14513.2MB
[PROFILE] env_3_MPS: 1.0ms | mem: 14512.0->14514.6MB | peak: 14527.0MB
[PROFILE] forward_3_MPS: 0.3ms | mem: 14514.6->14515.0MB | peak: 14515.0MB
[PROFILE] loss_derivs_3_MPS: 0.5ms | mem: 14515.0->14515.0MB | peak: 14515.0MB
[PROFILE] grad_contract_3_MPS: 0.3ms | mem: 14515.0->14515.3MB | peak: 14515.3MB
[PROFILE] hess_tn_build_3_MPS: 0.1ms | mem: 14515.3->14515.3MB | peak: 14515.3MB
[PROFILE] hess_contract_3_MPS: 0.3ms | mem: 14515.3->14516.2MB | peak: 14516.6MB
[PROFILE] compute_H_b_3_MPS: 36.0ms | mem: 14488.8->14515.6MB | peak: 14516.6MB
[PROFILE] fuse_3_MPS: 0.1ms | mem: 14515.6->14515.6MB | peak: 14515.6MB
[PROFILE] to_dense_3_MPS: 0.1ms | mem: 14515.6->14515.6MB | peak: 14515.6MB
[PROFILE] solve_3_MPS: 0.4ms | mem: 14515.6->14515.7MB | peak: 14515.8MB
[PROFILE] env_2_MPS: 1.2ms | mem: 14515.7->14529.2MB | peak: 14535.3MB
[PROFILE] forward_2_MPS: 0.7ms | mem: 14529.2->14529.2MB | peak: 14529.2MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 14529.2->14529.2MB | peak: 14529.2MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14529.2->14535.4MB | peak: 14535.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14535.4->14535.4MB | peak: 14535.4MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 14535.4->14561.6MB | peak: 14581.6MB
[PROFILE] env_2_MPS: 1.3ms | mem: 14561.6->14575.5MB | peak: 14581.7MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14575.5->14575.5MB | peak: 14575.5MB
[PROFILE] loss_derivs_2_MPS: 0.6ms | mem: 14575.5->14575.5MB | peak: 14575.5MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14575.5->14581.7MB | peak: 14581.7MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14581.7->14581.7MB | peak: 14581.7MB
[PROFILE] hess_contract_2_MPS: 1.0ms | mem: 14581.7->14607.9MB | peak: 14627.9MB
[PROFILE] env_2_MPS: 1.2ms | mem: 14607.9->14621.4MB | peak: 14627.5MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14621.4->14621.4MB | peak: 14621.4MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 14621.4->14621.4MB | peak: 14621.4MB
[PROFILE] grad_contract_2_MPS: 0.7ms | mem: 14621.4->14627.6MB | peak: 14627.6MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14627.6->14627.6MB | peak: 14627.6MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 14627.6->14653.8MB | peak: 14673.8MB
[PROFILE] env_2_MPS: 1.1ms | mem: 14633.7->14647.7MB | peak: 14653.9MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14647.7->14647.7MB | peak: 14647.7MB
[PROFILE] loss_derivs_2_MPS: 0.5ms | mem: 14647.7->14647.7MB | peak: 14647.7MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14647.7->14653.9MB | peak: 14653.9MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14653.9->14653.9MB | peak: 14653.9MB
[PROFILE] hess_contract_2_MPS: 0.6ms | mem: 14653.9->14680.1MB | peak: 14700.1MB
[PROFILE] env_2_MPS: 1.2ms | mem: 14660.1->14674.0MB | peak: 14680.2MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14674.0->14674.0MB | peak: 14674.1MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 14674.0->14674.1MB | peak: 14674.1MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14674.1->14680.3MB | peak: 14680.3MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14680.3->14680.3MB | peak: 14680.3MB
[PROFILE] hess_contract_2_MPS: 0.8ms | mem: 14680.3->14706.4MB | peak: 14726.4MB
[PROFILE] env_2_MPS: 1.1ms | mem: 14686.4->14696.0MB | peak: 14700.8MB
[PROFILE] forward_2_MPS: 0.3ms | mem: 14696.0->14696.0MB | peak: 14696.0MB
[PROFILE] loss_derivs_2_MPS: 0.7ms | mem: 14696.0->14696.0MB | peak: 14696.0MB
[PROFILE] grad_contract_2_MPS: 0.3ms | mem: 14696.0->14700.4MB | peak: 14700.4MB
[PROFILE] hess_tn_build_2_MPS: 0.1ms | mem: 14700.4->14700.4MB | peak: 14700.4MB
[PROFILE] hess_contract_2_MPS: 0.4ms | mem: 14700.4->14724.8MB | peak: 14744.8MB
[PROFILE] compute_H_b_2_MPS: 38.2ms | mem: 14515.7->14684.8MB | peak: 14744.8MB
[PROFILE] fuse_2_MPS: 0.1ms | mem: 14684.8->14684.8MB | peak: 14684.8MB
[PROFILE] to_dense_2_MPS: 0.1ms | mem: 14684.8->14684.8MB | peak: 14684.8MB
[PROFILE] solve_2_MPS: 1.5ms | mem: 14684.8->14704.8MB | peak: 14724.8MB
[PROFILE] env_1_MPS: 1.3ms | mem: 14704.8->14718.1MB | peak: 14724.3MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14718.1->14718.1MB | peak: 14718.1MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14718.1->14718.1MB | peak: 14718.2MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14718.1->14724.3MB | peak: 14724.4MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14724.3->14724.3MB | peak: 14724.3MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 14724.3->14750.5MB | peak: 14770.5MB
[PROFILE] env_1_MPS: 1.3ms | mem: 14750.5->14764.4MB | peak: 14770.6MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14764.4->14764.4MB | peak: 14764.4MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14764.4->14764.4MB | peak: 14764.4MB
[PROFILE] grad_contract_1_MPS: 1.7ms | mem: 14764.4->14770.6MB | peak: 14770.6MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 14770.6->14770.6MB | peak: 14770.6MB
[PROFILE] hess_contract_1_MPS: 0.2ms | mem: 14770.6->14796.8MB | peak: 14816.8MB
[PROFILE] env_1_MPS: 0.1ms | mem: 14796.8->14810.1MB | peak: 14816.3MB
[PROFILE] forward_1_MPS: 2.4ms | mem: 14810.1->14810.1MB | peak: 14810.1MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 14810.1->14810.1MB | peak: 14810.1MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 14810.1->14816.3MB | peak: 14816.3MB
[PROFILE] hess_tn_build_1_MPS: 0.4ms | mem: 14816.3->14816.3MB | peak: 14816.3MB
[PROFILE] hess_contract_1_MPS: 3.0ms | mem: 14816.3->14842.5MB | peak: 14862.5MB
[PROFILE] env_1_MPS: 0.1ms | mem: 14822.5->14836.3MB | peak: 14842.5MB
[PROFILE] forward_1_MPS: 0.0ms | mem: 14836.3->14836.3MB | peak: 14836.3MB
[PROFILE] loss_derivs_1_MPS: 0.0ms | mem: 14836.3->14836.3MB | peak: 14836.4MB
[PROFILE] grad_contract_1_MPS: 0.0ms | mem: 14836.3->14842.5MB | peak: 14842.6MB
[PROFILE] hess_tn_build_1_MPS: 0.0ms | mem: 14842.5->14842.5MB | peak: 14842.5MB
[PROFILE] hess_contract_1_MPS: 0.4ms | mem: 14842.5->14868.7MB | peak: 14888.7MB
[PROFILE] env_1_MPS: 1.7ms | mem: 14848.7->14862.6MB | peak: 14868.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14862.6->14862.6MB | peak: 14862.6MB
[PROFILE] loss_derivs_1_MPS: 0.7ms | mem: 14862.6->14862.6MB | peak: 14862.6MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14862.6->14868.8MB | peak: 14868.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14868.8->14868.8MB | peak: 14868.8MB
[PROFILE] hess_contract_1_MPS: 0.8ms | mem: 14868.8->14895.0MB | peak: 14915.0MB
[PROFILE] env_1_MPS: 1.2ms | mem: 14875.0->14884.4MB | peak: 14888.8MB
[PROFILE] forward_1_MPS: 0.3ms | mem: 14884.4->14884.4MB | peak: 14884.4MB
[PROFILE] loss_derivs_1_MPS: 0.6ms | mem: 14884.4->14884.4MB | peak: 14884.4MB
[PROFILE] grad_contract_1_MPS: 0.3ms | mem: 14884.4->14888.8MB | peak: 14888.8MB
[PROFILE] hess_tn_build_1_MPS: 0.1ms | mem: 14888.8->14888.8MB | peak: 14888.8MB
[PROFILE] hess_contract_1_MPS: 0.6ms | mem: 14888.8->14913.2MB | peak: 14933.2MB
[PROFILE] compute_H_b_1_MPS: 58.7ms | mem: 14704.8->14873.2MB | peak: 14933.2MB
[PROFILE] fuse_1_MPS: 0.1ms | mem: 14873.2->14873.2MB | peak: 14873.2MB
[PROFILE] to_dense_1_MPS: 0.1ms | mem: 14873.2->14873.2MB | peak: 14873.2MB
[PROFILE] solve_1_MPS: 1.5ms | mem: 14873.2->14893.2MB | peak: 14913.2MB
  Experiment log saved to: experiment_logs/debug_batch_MMPO2_L4_d12_j1_s42.json
   Train: R=0.5966 | Val: R=0.5330

[4/4] Running: MMPO2TypeI-L4-d12-jit1-seed42
  Experiment log saved to: experiment_logs/debug_batch_MMPO2TypeI_L4_d12_j1_s42.json
   Train: R=0.5898 | Val: R=0.5250

======================================================================
GRID SEARCH COMPLETE
======================================================================
Total experiments: 4
Skipped: 2
Ran: 2
Successful: 2
Failed: 0
Time elapsed: 10.3s (5.1s per run)

Top 5 Runs (by val R):

1. MMPO2-L4-d12-jit1-seed42
   Train R: 0.5966
   Val R: 0.5330
   Params: {'model': 'MMPO2', 'L': 4, 'bond_dim': 12, 'jitter_start': 1.0}

2. MMPO2TypeI-L4-d12-jit1-seed42
   Train R: 0.5898
   Val R: 0.5250
   Params: {'model': 'MMPO2TypeI', 'L': 4, 'bond_dim': 12, 'jitter_start': 1.0}

Results saved to: results/debug_batch
Summary: results/debug_batch/summary.json
Grid search complete. Marked as .complete
======================================================================
